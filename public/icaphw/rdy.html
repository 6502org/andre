<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
<meta name="author" content="Andr&eacute;  Fachat">

<meta name="description" content="RDY-Generation for CMOS 65C02">
<meta name="keywords" content="6502 RDY">
<link rev="made" href="mailto:afachat@gmx.de">
<link rel="stylesheet" title="Default" type="text/css" href="../style2.css"><link rel="alternate stylesheet" title="Advanced" type="text/css" href="../advanced.css">
<title>RDY-Generation for CMOS 65C02</title></head>
<body><div id="mainbox"><a name="top"></a><div id="topsearch"><form method="get" action="http://www.google.com/search" target="_blank"><input alt="search" name="q" size="10" maxlength="255" type="text"><input class="advbutton" value="Search site" type="submit"><div id="srchprov">(by Google)</div><input name="sitesearch" value="www.6502.org/users/andre" type="hidden"></form><div id="topfind"></div></div><div id="menubox">


<div id="menu1">
<div id="twist1" class="twisty"></div>
<div class="hdrtxt"><a href="../index.html">Home&nbsp;&gt;</a></div>
<ul class="nav1">
<li>
<ul class="nav2">
<li class="navhdr"><a href="../index.html">Home</a></li>
<li><a href="../contact.html">Contact</a></li>
<li><a href="../design.html">Web design</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Hardware</span></li>
<li><ul class="nav2" >
<li><a href="../65k/index.html">The 65k Project</a>
</li>
<li><a href="../csa/index.html">CS/A65</a>
</li>
<li><a href="../cbmhw/index.html">CBM mods</a>
</li>
<li><a href="../spi65b/index.html">SPI65B</a>
</li>
<li><a href="../mischw/index.html">Other hardware</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Software</span></li>
<li><ul class="nav2" >
<li><a href="../osa/index.html">GeckOS</a>
</li>
<li><a href="../lib6502/index.html">lib6502 </a>
</li>
<li><a href="../o65/index.html">o65</a>
</li>
<li><a href="../usb65/index.html">usb65</a>
</li>
<li><a href="../xd2031/index.html">XD2031</a>
</li>
<li><a href="../misc/index.html">Misc</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Library</span></li>
<li><ul class="nav2" >
<li><a href="../petindex/index.html">PETindex</a>
</li>
<li><a href="../adv65/index.html">Advanced 6502</a>
</li>
<li><a href="../hwinfo/index.html">ICs and Standards</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Knowledge Bits</span></li>
<li><ul class="nav2" >
<li><a href="../icapos/index.html">Computer/OS Architecture</a>
</li>
<li><a href="../icaphw/index.html">6502 Hardware Bits</a>
</li>
</ul>
<div class="nend2"></div>
</li>
<div class="nend1"></div>
</ul>
</div>
<div id="menu2">
<div id="twist2" class="twisty"></div>
<div class="hdrtxt"><a href="index.html">Hardware Bits&nbsp;&gt;</a></div>
<ul class="nav1">
<li>
<ul class="nav2">
<li class="navhdr"><a href="index.html">Hardware Bits</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Basics</span></li>
<li><ul class="nav2" >
<li><a href="design.html">Hardware design lesson</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Tools</span></li>
<li><ul class="nav2" >
<li><a href="oscope/index.html">Oscilloscope bits</a>
</li>
<li><a href="xilinx.html">Xilinx CPLD tools</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Interfaces</span></li>
<li><ul class="nav2" >
<li><a href="c64ser.html">UART serial interface</a></li>
<li><a href="remote.html">Infrared remote control</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Misc</span></li>
<li><ul class="nav2" >
<li><a href="rdy.html">RDY generation</a></li>
<li><a href="../csa/blitter/works.html">&gt;How a Blitter works</a></li>
<li><a href="../petindex/poke/index.html">&gt;The PET Killer Poke</a></li>
</ul>
<div class="nend2"></div>
</li>
<div class="nend1"></div>
</ul>
</div>
	</div><div id="midcol"><div class="top" id="content"><div id="minmax"></div>

<h1>RDY-Generation for CMOS 65C02</h1><p class="copyright">(C)
2006-2010 Andr&eacute;  Fachat</p> 
<div class="overview"><p>This article describes a generic schematics for the generation of the RDY
line used by the 65C02 processor to hold bus accesses when the device is not
ready.
</p>
<p>You think this is not necessary nowadays, where everything is way
faster than the one or two MHz the 6502 runs at. Well, actually I recently
found a chip that was too slow for my 2&nbsp;MHz 65C02 system, so I
developed this schematics.
</p><p>Please note that the schematics works for a CMOS 65C02 only - not an
NMOS&nbsp;6502. This is due to two facts:
</p><ol>
<li>The NMOS version requires that the RDY signal is asserted during Phi1,
i.e. when Phi2 is low. In this phase the CPU sets up the address and control
lines for the access that is performed at Phi2. This schematics asserts
RDY at Phi2, which works with the CMOS version, that only requires the
RDY 200ns before the end of Phi2.
</li>
<li>The NMOS version does not stop on write cylces. Instead it simply
performs the current and all directly consecutive writes - up to three
in total in a 6502 - and only stops on the next read cylce.
This schematics does not handle the write problem with the NMOS chips,
it simply asserts RDY for all accesses.</li>
</ol>
<div class="sidenote">
2010-01-03: Note that this IC is clocked by the select line and has no
extra Phi2 line. So there is a need to deassert the select line when Phi2
goes low - otherwise the schematics could be much simpler!
</div><p>This schematics describes how I attached the Philips P8584 I2C controller
to a 65C02 system. I found that the chip worked well with the system running
on 1&nbsp;MHz, but not on 2&nbsp;MHz. It only started working when I used
RDY to halt the CPU for a cycle when accessing the chip.
</p>
<p>This schematics creates the RDY signal, but a similar schematics can
be used to create other clocked signals as well.
	</p>
  </div><div id="toc" class="h2"><div class="h2h"><div class="h2t">&nbsp;</div><h2>Table of content</h2></div><div class="h2c"><ul><li><a href="#signals">Signals</a></li><li><a href="#schematics">Schematics</a></li><li><a href="#timing">Timing diagrams</a></li></ul></div></div><div class="h2"><div class="h2h"><div class="h2t">&nbsp;</div><h2><a name="signals">Signals</a></h2></div><div class="h2c"><p>This section describes the signals as used in the schematics.</p>
<ul>
<li>Phi2: The CPU clock signal. When it is high, the CPU has put valid
address and data (in case of write) lines on the bus. When Phi2 is low
the CPU changes the address lines. Read happens at the falling edge of
Phi2.</li>
<li>/SEL_unclocked: This select signal is determined by decoding the
CPU address lines. It goes low when the CPU puts the correct address
for access of the device on the address lines.
This line is mostly used for read accesses when the CPU expects the
data at the falling edge of Phi2, and the device does not need any specific
timing. This line can still be used when RDY is asserted.
</li>
<li>/SEL_clocked: This line is the /SEL_unclocked line combined with the
Phi2 clock. It is used for devices that need the Phi2 timing on write
accesses. This line must be handled specially when RDY is asserted, as it
goes inactive during Phi1.
</li>
<li>XRDY: This line is the internal RDY signal. It is low when the device
is accessed and the RDY line should be asserted for this access.
</li>
<li>RDY: This is the CPU ready line.
</li>
<li>/NEWSEL: This is the final select signal as replacement for the
/SEL_clocked line. It can be used for a device that requires the Phi2
timing for the write access.
</li>
</ul>
    </div></div><div class="h2"><div class="h2h"><div class="h2t">&nbsp;</div><h2><a name="schematics">Schematics</a></h2></div><div class="h2c">
<p>The following diagram shows the schematics</p>
<img src="rdy/rdy-schematics.png">
<p>The main IC used for the generation is the shift register 74LS164.
It is clocked with the Phi2 clock signal, and shifts the /SEL_unclocked
signal through its output signals.
With a combination of the output signals the new XRDY signals is created.
The timing diagrams below show how it works.
</p>
<p>This type of schematics can be used to create many types of
signals, using different combinations of the shift register output values.
Creating XRDY with Q1 and Q2 is only one example. Using Q3 instead of Q2
for example would make the RDY pulse two clock cycles long, not one.
You could also use a higher shift register clock and shift the Phi2
signal through the shift register, and use combinations of the output
signals e.g. for RAM timing signals.
</p>
    </div></div><div class="h2"><div class="h2h"><div class="h2t">&nbsp;</div><h2><a name="timing">Timing diagrams</a></h2></div><div class="h2c">
<p>This diagram shows the principle timing, but without RDY being pulled
from XRDY.
</p>
<img src="rdy/rdy-timing1.png">
<p>Phi2 shows the central CPU timing signal. Ax,R/W shows where the address
lines and R/-W are stable. /SEL_unclocked is the select signal that is
derived from the CPU address lines. /SEL_clocked is this select signal
combined with Phi2.
</p>
<p>The Q1 and Q2 lines show how the /SEL_unclocked line is clocked through
the shift register output lines. The XRDY line is cmbined from Q1 being low
and Q2 being high.
</p>
<p>The following diagram shows the signals with the RDY line asserted from
XRDY.</p>
<img src="rdy/rdy-timing2.png">
<p>The /SEL_clocked line now shows two active periods, as it is combined
with Phi2 that is going inactive during Phi1. Therefore the /NEWSEL line is
generated using the /SEL_clocked and XRDY line.
</p><p>
Note: it is important, that the Phi2 going high signals arrives a the
AND-gate before the shift register and Q1/Q2 logic releases XRDY, so that
there is no inactive spike on the /NEWSEL line. This is accomplished
by the gate delay times.</p>
    </div></div><hr>
<p>Return to <a href="../index.html">Homepage</a></p>

  </div></div><div id="rightcol"><div class="top" id="twitter"><div class="tophead">follow</div><div>
		            Follow my 8-bit tweets on<br><a class="extlink" target="_blank" href="https://twitter.com/#!/search/realtime/afachat%20%238bit">Twitter</a><br> (In new window)
		</div></div><div class="top" id="forum"><div class="tophead">discuss</div><div><p>Discuss my site on <a class="extlink" target="_blank" href="http://forum.6502.org/viewtopic.php?t=956">this 6502.org forum thread</a></p><p>(Forum registration required to post)</p></div></div><div class="top" id="hot"><div class="tophead">Hot!</div><div>
<p>Dive into the retro feeling and build yourself a <a href="../cbmhw/ryofat40/index.html">Commodore PET replica</a></p>
<p>Need more speed? Speed up your 6502 computer with this <a href="../adv65/pet816/index.html">10&nbsp;MHz 6502 CPU replacement board</a></p>
<p>Interested in electronics design? Look at the <a href="../icaphw/design.html">design lesson</a> I got from Bil Herd, the hardware designer of the C128</p>
<p>Want 64bit? - pimp the 6502 with the <a href="../65k/index.html">65k processor design!</a></p>

		</div></div></div><div id="footer">&nbsp;</div></div><script type="text/javascript">myUp="../";</script><script type="text/javascript" src="../scripts2-all.js"></script></body></html> 
