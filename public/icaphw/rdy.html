<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="author" content="Andr&#xE9;  Fachat" />

<meta name="description" content="RDY-Generation for CMOS 65C02" />
<meta name="keywords" content="6502 RDY" />
<link rev="made" href="mailto:afachat@gmx.de" />
<link rel="stylesheet" title="Default" type="text/css" href="../style-min.css" /><link rel="alternate stylesheet" title="Advanced" type="text/css" href="../advanced.css" />
<title>RDY-Generation for CMOS 65C02</title></head>
<body><div id="mainbox"><div id="leftcol"><div id="menu" class="top"><div class="tophead">navigate</div><div id="filter"><form action="#"><table id="filterbox"><tr><td><input alt="menu filter" size="8" name="filter" value="filter" type="text" /></td><td><div id="cancel" class="i_cancel"> </div></td></tr></table><table id="expcol"><tr><td><div id="expand" class="i_expand"> </div></td><td><div id="collapse" class="i_collapse"> </div></td></tr></table></form></div>
<div id="mtree">
<a id="m_homepage" href="../index.html">Homepage</a>
<ul class="menu0" >
<li class="separator">Commodore</li>
<li class="dir" id="m_petindex"><div class="i_dir">&nbsp;</div><a href="../petindex/index.html">CBM PETindex</a>
</li>
<li class="dir" id="m_cbmhw"><div class="i_dir">&nbsp;</div><a href="../cbmhw/index.html">CBM hardware and mods</a>
</li>
<li class="separator">Hardware</li>
<li class="dir" id="m_csa"><div class="i_dir">&nbsp;</div><a href="../csa/index.html">CS/A65 Caspaer and Gecko computer</a>
</li>
<li class="dir" id="m_adv65"><div class="i_dir">&nbsp;</div><a href="../adv65/index.html">Advanced 6502</a>
</li>
<li class="dir" id="m_hwinfo"><div class="i_dir">&nbsp;</div><a href="../hwinfo/index.html">ICs and Standards Info</a>
</li>
<li class="dir" id="m_mischw"><div class="i_dir">&nbsp;</div><a href="../mischw/index.html">Other hardware (e.g. tools)</a>
</li>
<li class="separator">Software</li>
<li><div class="i_file">&nbsp;</div><a href="../osa/index.html">GeckOS operating system</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../lib6502/index.html">Lib6502 standard</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../o65/index.html">O65 file format</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../misc/index.html">Misc software</a>
</li>
<li class="separator">Knowledge Bits</li>
<li class="dir" id="m_icapos"><div class="i_dir">&nbsp;</div><a href="../icapos/index.html">Computer/OS Architecture</a>
</li>
<li class="dir" id="m_icaphw"><div class="i_dir">&nbsp;</div><a href="../icaphw/index.html">6502 Hardware Bits</a>
<ul class="menu1" >
<li><div class="i_file">&nbsp;</div><a href="design.html">Hardware design lesson</a></li>
<li><div class="i_file">&nbsp;</div><a href="oscope/index.html">Oscilloscope bits</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="xilinx.html">Xilinx CPLD tools</a></li>
<li><div class="i_file">&nbsp;</div><a href="c64ser.html">UART serial interface</a></li>
<li><div class="i_file">&nbsp;</div><a href="rdy.html" class="mcurrent">RDY generation</a></li>
<li><div class="i_file">&nbsp;</div><a href="remote.html">Infrared remote control</a></li>
</ul>
</li>
<li class="separator">Misc</li>
<li><div class="i_file">&nbsp;</div><a href="../contact.html">Contact</a></li>
<li><div class="i_file">&nbsp;</div><a href="../sneak.html">Sneak preview</a></li>
<li><div class="i_file">&nbsp;</div><a href="../design.html">Web design</a></li>
</ul>

</div>
		</div><div class="top" id="browser"><div class="tophead">browser</div><div>
			Site has been tested with a number of browsers and systems. Javascript required for advanced menu, but degrades gracefully without Javascript. IE6 not fully supported anymore!
			</div></div></div><div id="rightcol"><div class="top" id="google"><div class="tophead">search</div><div><form method="get" action="http://www.google.com/search" target="_blank"><input alt="search parameters" type="text" name="q" size="10" maxlength="255" value="" /><input class="advbutton" type="submit" value="Search my site" /><br />(Google, in new window)
	                        <input type="hidden" name="sitesearch" value="www.6502.org/users/andre" /></form></div></div><div class="top" id="twitter"><div class="tophead">follow</div><div>
		            Follow my 8-bit tweets on<br /><a target="_blank" href="http://search.twitter.com/search?q=&amp;ands=&amp;phrase=&amp;ors=&amp;nots=&amp;tag=8bit&amp;lang=all&amp;from=afachat&amp;to=&amp;ref=&amp;near=&amp;within=15&amp;units=mi&amp;since=&amp;until=&amp;rpp=15">Twitter</a><br /> (In new window)
		</div></div><div class="top" id="forum"><div class="tophead">discuss</div><div><p>Discuss my site on <a class="extlink" target="_blank" href="http://forum.6502.org/viewtopic.php?t=956">this 6502.org forum thread</a></p><p>(Forum registration required to post)</p></div></div><div class="top" id="hot"><div class="tophead">Hot!</div><div>
<p>Dive into the retro feeling and build yourself a <a href="../cbmhw/ryofat40/index.html">Commodore PET replica</a></p>
<p>Need more speed? Speed up your 6502 computer with this <a href="../adv65/pet816/index.html">10&nbsp;MHz 6502 CPU replacement board</a></p>
<p>Interested in electronics design? Look at the <a href="../icaphw/design.html">design lesson</a> I got from Bil Herd, the hardware designer of the C128</p>

		</div></div></div><div id="midcol"><div class="top" id="ie6warn">
You are using an old MS Internet Explorer as browser. This version is not supported anymore. Please use a 
more modern browser, like Internet Explorer 8 or later, 
<a target="_blank" class="extlink" href="http://www.firefox.com">Firefox</a>,
<a target="_blank" class="extlink" href="http://www.google.com/chrome">Google Chrome</a>, or
<a target="_blank" class="extlink" href="http://www.opera.com">Opera</a>.
</div><div class="top" id="content">
<div id="breadcrumbs">
<a href="../index.html">Homepage</a>
&gt;&gt;  <a href="index.html">6502 Hardware Bits
</a>&gt;&gt;  RDY generation</div>
<a name="topanchor" id="topanchor"></a><h1>RDY-Generation for CMOS 65C02</h1><p class="copyright">(C)
2006-2010 André  Fachat</p> 
<div class="overview"><p>This article describes a generic schematics for the generation of the RDY
line used by the 65C02 processor to hold bus accesses when the device is not
ready.
</p>
<p>You think this is not necessary nowadays, where everything is way
faster than the one or two MHz the 6502 runs at. Well, actually I recently
found a chip that was too slow for my 2 MHz 65C02 system, so I
developed this schematics.
</p><p>Please note that the schematics works for a CMOS 65C02 only - not an
NMOS 6502. This is due to two facts:
</p><ol>
<li>The NMOS version requires that the RDY signal is asserted during Phi1,
i.e. when Phi2 is low. In this phase the CPU sets up the address and control
lines for the access that is performed at Phi2. This schematics asserts
RDY at Phi2, which works with the CMOS version, that only requires the
RDY 200ns before the end of Phi2.
</li>
<li>The NMOS version does not stop on write cylces. Instead it simply
performs the current and all directly consecutive writes - up to three
in total in a 6502 - and only stops on the next read cylce.
This schematics does not handle the write problem with the NMOS chips,
it simply asserts RDY for all accesses.</li>
</ol>
<div class="sidenote">
2010-01-03: Note that this IC is clocked by the select line and has no
extra Phi2 line. So there is a need to deassert the select line when Phi2
goes low - otherwise the schematics could be much simpler!
</div><p>This schematics describes how I attached the Philips P8584 I2C controller
to a 65C02 system. I found that the chip worked well with the system running
on 1 MHz, but not on 2 MHz. It only started working when I used
RDY to halt the CPU for a cycle when accessing the chip.
</p>
<p>This schematics creates the RDY signal, but a similar schematics can
be used to create other clocked signals as well.
	</p>
  </div><div id="toc"><h2>Table of content</h2><div class="toplink"><a href="#top">Top</a></div><ul><li><a href="#signals">Signals</a></li><li><a href="#schematics">Schematics</a></li><li><a href="#timing">Timing diagrams</a></li></ul></div><h2><a name="signals" id="signals">Signals</a></h2><div class="toplink"><a href="#top">Top</a></div><p>This section describes the signals as used in the schematics.</p>
<ul>
<li>Phi2: The CPU clock signal. When it is high, the CPU has put valid
address and data (in case of write) lines on the bus. When Phi2 is low
the CPU changes the address lines. Read happens at the falling edge of
Phi2.</li>
<li>/SEL_unclocked: This select signal is determined by decoding the
CPU address lines. It goes low when the CPU puts the correct address
for access of the device on the address lines.
This line is mostly used for read accesses when the CPU expects the
data at the falling edge of Phi2, and the device does not need any specific
timing. This line can still be used when RDY is asserted.
</li>
<li>/SEL_clocked: This line is the /SEL_unclocked line combined with the
Phi2 clock. It is used for devices that need the Phi2 timing on write
accesses. This line must be handled specially when RDY is asserted, as it
goes inactive during Phi1.
</li>
<li>XRDY: This line is the internal RDY signal. It is low when the device
is accessed and the RDY line should be asserted for this access.
</li>
<li>RDY: This is the CPU ready line.
</li>
<li>/NEWSEL: This is the final select signal as replacement for the
/SEL_clocked line. It can be used for a device that requires the Phi2
timing for the write access.
</li>
</ul>
    <h2><a name="schematics" id="schematics">Schematics</a></h2><div class="toplink"><a href="#top">Top</a></div>
<p>The following diagram shows the schematics</p>
<img src="rdy/rdy-schematics.png" />
<p>The main IC used for the generation is the shift register 74LS164.
It is clocked with the Phi2 clock signal, and shifts the /SEL_unclocked
signal through its output signals.
With a combination of the output signals the new XRDY signals is created.
The timing diagrams below show how it works.
</p>
<p>This type of schematics can be used to create many types of
signals, using different combinations of the shift register output values.
Creating XRDY with Q1 and Q2 is only one example. Using Q3 instead of Q2
for example would make the RDY pulse two clock cycles long, not one.
You could also use a higher shift register clock and shift the Phi2
signal through the shift register, and use combinations of the output
signals e.g. for RAM timing signals.
</p>
    <h2><a name="timing" id="timing">Timing diagrams</a></h2><div class="toplink"><a href="#top">Top</a></div>
<p>This diagram shows the principle timing, but without RDY being pulled
from XRDY.
</p>
<img src="rdy/rdy-timing1.png" />
<p>Phi2 shows the central CPU timing signal. Ax,R/W shows where the address
lines and R/-W are stable. /SEL_unclocked is the select signal that is
derived from the CPU address lines. /SEL_clocked is this select signal
combined with Phi2.
</p>
<p>The Q1 and Q2 lines show how the /SEL_unclocked line is clocked through
the shift register output lines. The XRDY line is cmbined from Q1 being low
and Q2 being high.
</p>
<p>The following diagram shows the signals with the RDY line asserted from
XRDY.</p>
<img src="rdy/rdy-timing2.png" />
<p>The /SEL_clocked line now shows two active periods, as it is combined
with Phi2 that is going inactive during Phi1. Therefore the /NEWSEL line is
generated using the /SEL_clocked and XRDY line.
</p><p>
Note: it is important, that the Phi2 going high signals arrives a the
AND-gate before the shift register and Q1/Q2 logic releases XRDY, so that
there is no inactive spike on the /NEWSEL line. This is accomplished
by the gate delay times.</p>
    <hr />
<p>Return to <a href="../index.html">Homepage</a></p>

  </div></div><div id="footer"> </div></div><script type="text/javascript">myUp="../";</script><script type="text/javascript" src="../scripts-all.js"></script></body></html> 

