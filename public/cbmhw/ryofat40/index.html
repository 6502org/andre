<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="author" content="Andr&#xE9;  Fachat" />

<meta name="description" content="A new implementation of the Commodore PET 4032" />
<meta name="keywords" content="Commodore PET 4032" />
<link rev="made" href="mailto:afachat@gmx.de" />
<link rel="stylesheet" title="Default" type="text/css" href="../../style-min.css" /><link rel="alternate stylesheet" title="Advanced" type="text/css" href="../../advanced.css" />
<title>Roll your own PET4032 (Fat40)</title></head>
<body><div id="mainbox"><a name="top" id="top"></a><div id="leftcol"><div id="menu" class="top"><div class="tophead">navigate</div><div id="filter"><form action="#"><table id="filterbox"><tr><td><input alt="menu filter" size="8" name="filter" value="filter" type="text" /></td><td><div id="cancel" class="i_cancel"> </div></td></tr></table><table id="expcol"><tr><td><div id="expand" class="i_expand"> </div></td><td><div id="collapse" class="i_collapse"> </div></td></tr></table></form></div>
<div id="mtree">
<a id="m_homepage" href="../../index.html">Homepage</a>
<ul class="menu0" >
<li class="separator">Commodore</li>
<li class="dir" id="m_petindex"><div class="i_dir">&nbsp;</div><a href="../../petindex/index.html">CBM PETindex</a>
</li>
<li class="dir" id="m_cbmhw"><div class="i_dir">&nbsp;</div><a href="../../cbmhw/index.html">CBM hardware and mods</a>
<ul class="menu1" >
<li><div class="i_link">&nbsp;</div><a href="../../adv65/pet816/index.html">Speed up your PET!</a></li>
<li class="dir" id="m_cbmhw_ryofat40"><div class="i_dir">&nbsp;</div><a href="index.html" class="mcurrent">Build your own PET replica!</a>
<ul class="menu2" >
<li><div class="i_link">&nbsp;</div><a href="../../csa/petcpu/index.html">PETCPU</a></li>
<li><div class="i_link">&nbsp;</div><a href="../../csa/petio/index.html">PETIO</a></li>
<li><div class="i_link">&nbsp;</div><a href="../../csa/vdc/index.html">Video</a></li>
<li><div class="i_link">&nbsp;</div><a href="../../csa/cpu/index.html">CPU</a></li>
<li><div class="i_link">&nbsp;</div><a href="../../csa/bios/index.html">BIOS</a></li>
</ul>
</li>
<li class="dir" id="m_cbmhw_ryo1581"><div class="i_dir">&nbsp;</div><a href="../ryo1581/index.html">Build your own VC1581 replica!</a>
</li>
<li class="dir" id="m_cbmhw_petnet"><div class="i_dir">&nbsp;</div><a href="../petnet/index.html">Put your PET on the 'Net</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../c64csa/index.html">CS/A adapter for C64</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../petcsa/index.html">CS/A adapter for PETs</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../kernal/index.html">C64 kernal modifications</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../scsi/index.html">CBM SCSI interfaces</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../ieee488/index.html">IEEE488 interfaces</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../hwmods.html">My Hardware mods</a></li>
<li><div class="i_file">&nbsp;</div><a href="../8032sk/index.html">A modified 8032-SK</a>
</li>
<li><div class="i_link">&nbsp;</div><a href="../../icap/c64ser.html">UART serial interface</a></li>
</ul>
</li>
<li class="separator">Hardware</li>
<li class="dir" id="m_65k"><div class="i_dir">&nbsp;</div><a href="../../65k/index.html">The 65k Project</a>
</li>
<li class="dir" id="m_csa"><div class="i_dir">&nbsp;</div><a href="../../csa/index.html">CS/A65 Caspaer and Gecko computer</a>
</li>
<li class="dir" id="m_adv65"><div class="i_dir">&nbsp;</div><a href="../../adv65/index.html">Advanced 6502</a>
</li>
<li class="dir" id="m_hwinfo"><div class="i_dir">&nbsp;</div><a href="../../hwinfo/index.html">ICs and Standards Info</a>
</li>
<li class="dir" id="m_mischw"><div class="i_dir">&nbsp;</div><a href="../../mischw/index.html">Other hardware (e.g. tools)</a>
</li>
<li class="separator">Software</li>
<li><div class="i_file">&nbsp;</div><a href="../../osa/index.html">GeckOS operating system</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../../lib6502/index.html">Lib6502 standard</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../../o65/index.html">O65 file format</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../../misc/index.html">Misc software</a>
</li>
<li class="separator">Knowledge Bits</li>
<li class="dir" id="m_icapos"><div class="i_dir">&nbsp;</div><a href="../../icapos/index.html">Computer/OS Architecture</a>
</li>
<li class="dir" id="m_icaphw"><div class="i_dir">&nbsp;</div><a href="../../icaphw/index.html">6502 Hardware Bits</a>
</li>
<li class="separator">Misc</li>
<li><div class="i_file">&nbsp;</div><a href="../../contact.html">Contact</a></li>
<li><div class="i_file">&nbsp;</div><a href="../../sneak.html">Sneak preview</a></li>
<li><div class="i_file">&nbsp;</div><a href="../../design.html">Web design</a></li>
</ul>

</div>
		</div><div class="top" id="browser"><div class="tophead">browser</div><div>
			Site has been tested with a number of browsers and systems. Javascript required for advanced menu, but degrades gracefully without Javascript. IE6 not fully supported anymore!
			</div></div></div><div id="rightcol"><div class="top" id="google"><div class="tophead">search</div><div><form method="get" action="http://www.google.com/search" target="_blank"><input alt="search parameters" type="text" name="q" size="10" maxlength="255" value="" /><input class="advbutton" type="submit" value="Search my site" /><br />(Google, in new window)
	                        <input type="hidden" name="sitesearch" value="www.6502.org/users/andre" /></form></div></div><div class="top" id="twitter"><div class="tophead">follow</div><div>
		            Follow my 8-bit tweets on<br /><a class="extlink" target="_blank" href="http://search.twitter.com/search?q=&amp;ands=&amp;phrase=&amp;ors=&amp;nots=&amp;tag=8bit&amp;lang=all&amp;from=afachat&amp;to=&amp;ref=&amp;near=&amp;within=15&amp;units=mi&amp;since=&amp;until=&amp;rpp=15">Twitter</a><br /> (In new window)
		</div></div><div class="top" id="forum"><div class="tophead">discuss</div><div><p>Discuss my site on <a class="extlink" target="_blank" href="http://forum.6502.org/viewtopic.php?t=956">this 6502.org forum thread</a></p><p>(Forum registration required to post)</p></div></div><div class="top" id="hot"><div class="tophead">Hot!</div><div>
<p>Dive into the retro feeling and build yourself a <a href="../../cbmhw/ryofat40/index.html">Commodore PET replica</a></p>
<p>Need more speed? Speed up your 6502 computer with this <a href="../../adv65/pet816/index.html">10&nbsp;MHz 6502 CPU replacement board</a></p>
<p>Interested in electronics design? Look at the <a href="../../icaphw/design.html">design lesson</a> I got from Bil Herd, the hardware designer of the C128</p>
<p>Want 64bit? - pimp the 6502 with the <a href="../../65k/index.html">65k processor design!</a></p>

		</div></div></div><div id="midcol"><div class="top" id="ie6warn">
You are using an old MS Internet Explorer as browser. This version is not supported anymore. Please use a 
more modern browser, like Internet Explorer 8 or later, 
<a target="_blank" class="extlink" href="http://www.firefox.com">Firefox</a>,
<a target="_blank" class="extlink" href="http://www.google.com/chrome">Google Chrome</a>, or
<a target="_blank" class="extlink" href="http://www.opera.com">Opera</a>.
</div><div class="top" id="content"><div id="minmax"></div>
<div id="breadcrumbs">
<a href="../../index.html">Homepage</a>
&gt;&gt; <a href="../index.html">CBM hardware and mods</a>&gt;&gt;  Build your own PET replica!</div>
<h1>Roll your own PET4032 (Fat40)</h1><p class="copyright">(C)
2006-2006 André  Fachat</p> 
<div class="overview">
	<p>This page describes how you can build your own PET 4032 using
	the boards of the <a href="../../csa/index.html">CS/A65</a> computer.</p><p>
	Well, not actually the whole computer, but at least the mainboard,
	where "only" the case, screen, and power supply are missing. I have
	though managed to use a standard PAL screen with this PET by 
	redefining the timing values the PET ROM writes into the 
	CRTC registers.
	</p><p>
	Basically what you do is to combine the <a href="../../csa/petcpu/index.html">PETCPU</a>,
	<a href="../../csa/petio/index.html">PETIO</a> and <a href="../../csa/vdc/index.html">Video</a> boards 
	into one computer, put the PET ROM into a ROM for the PETCPU ROM socket
	and there you are. The following sections describe the special settings
	on the different boards.
	</p>
  </div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="news" id="news">News:</a></h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c"><ul class="news"><li><div> </div><small>2010-05-11</small>
	Added beta version of patched PET BASIC4 ROM to run on CS/A in 2MHz
    </li><li><div> </div><small>2006-12-22</small>
	Added the version using the CPU and BIOS boards instead of the PETCPU board ("Caspaer" setup).
    </li><li><div> </div><small>2006-11-12</small>
	Added the ROMs.
    </li></ul></div></div><div id="toc" class="h2"><div class="h2h"><div class="h2t"> </div><h2>Table of content</h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c"><ul><li><a href="#">Fat40 Setup</a></li><li style="list-style-type:none;"><ul><li><a href="#">Board Settings</a></li><li><a href="#">ROMs</a></li></ul></li><li><a href="#">Caspaer Setup</a></li><li style="list-style-type:none;"><ul><li><a href="#">Board Settings</a></li><li><a href="#">ROMs</a></li></ul></li></ul></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2>Fat40 Setup</h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c">
	<a href="fat40.jpg"><img class="rightimg" src="fat40-small.jpg" /></a>
	This section describes a setup using the three PETCPU, PETIO
	and VDC boards.
    <ul><li><strong>Board Settings</strong><p>
	This section describe the CS/A65 boards making up the PET 4032.
	Here is a <a href="fat40.jpg">picture</a> of the three boards on 
	a backplane. Note the separate cable between the VDC and the 
	PETIO boards, to handle the video retrace (VSYNC) interrupt generation
	from VDC to PETIO and the character ROM selection.
	from PETIO to VDC.</p>
    <ul><li class="subitem"><a href="../../csa/petcpu/index.html">PETCPU board</a> 
	The PETCPU board must be set to a maximum of 32k RAM on the board
	itself, and maximum of 28k of ROM, so that the memory area at
	$8*** is selected on the CS/A65 bus and can be handled by the
	video board. Actually all memory not handled by the PETCPU is
	covered by RAM from the video board (e.g. the $9*** area). 
	To achieve this, the PETCPU board must be set to use the 
	$01**** are on the bus. In addition it must exclusive-or
	the address lines 15 and 12 - as the PET CRTC is set to a 
	memory address of $9000 - but the video board resets the video
	to $0000 with the control register and the values set in the
	CRTC. Also the I/O area must be enabled for $E800 to $EFFF.
	<br />You can see the jumpers in this <a href="petcpu.jpg">picture</a>.
	Please note that this is jumpered for 2MHz, and the RAM is missing -
	as the RAM is setup to be used from the video board.
     </li><li class="subitem"><a href="../../csa/petio/index.html">PETIO board</a> 
	On the PETIO board only the "special features" must be
	switched off, especially the IEEE488 slave mode feature, as the
	ROM does not handle this, as well as the EOI must be located
	at its original place on the keyboard PIA.
     </li><li class="subitem"><a href="../../csa/vdc/index.html">Video board</a> 
	The video board must be set to the memory area $01****. Otherwise
	it should best be a 1.4 version, as the control port is reset
	with /RES and needs not be set by the ROM.
     </li></ul></li><li><strong>ROMs</strong><p>
	In this section you can find the ROMs for the PET. They basically
	are the original PET ROMs, only that I have modified the 
	CRTC timing parameters. Please note that the 2MHz (8032) version
	is experimental only, as the IEEE488 timing seems to be flakey
	now.</p>
    <ul><li class="subitem"><a href="roms/pet-fat40-1mhz-n.bin">Fat40 4032 graphics keyboard 1MHz</a> 
	This is the 1MHz ROM that produces roughly PAL compatible video output.
     </li><li class="subitem"><a href="roms/pet-8032-2mhz-b.bin">8032 business keyboard 2MHz</a> 
	This 2MHz version is experimental. As the VDC board can only do 80 columns with 2MHz bus frequency, no 8032 with 1MHz is possible.
     </li></ul></li></ul></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2>Caspaer Setup</h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c">This section contains a description of a setup
	using the main CPU (including MMU) and BIOS board instead of the
	PETCPU board as above.
	<ul><li><strong>Board Settings</strong><p>
	This section describe the CS/A65 boards making up the PET 4032
	in a setup with the CPU+BIOS board combination. 
	Please note that the separate cable between the VDC and the 
	PETIO boards, to handle the video retrace (VSYNC) interrupt generation
	is still required as above.
	</p>
    <ul><li class="subitem"><a href="../../csa/cpu/index.html">CSACPU board</a> 
	The CPU board must be set to 1MHz. The ROM patch below expects
	the MMU at $eff*, so the board must be set to an I/O area of
	2k from $E800-$EFFF and the MMU to $EFF*. By modifying the patch
	other values are possible.
     </li><li class="subitem"><a href="../../csa/bios/index.html">BIOS board</a> 
	The BIOS must be set that the ROM as described below
	is found at $08000-$0FFFF so that the CPU boots from it.
	The RAM should be on $00000-$07FFF.
     </li><li class="subitem"><strong>PETIO and VDC boards</strong>: 
	Please use the same settings as described above.
     </li></ul></li><li><strong>ROMs</strong><p>
	The ROMs are basically the same ROMs as above, i.e. including
	the modified CRTC timing parameters.
	In addition, the CPU must set the MMU and BIOS board to correct
	values on Reset. This is done by a small patch that is included
	in the ROM listed below.
	</p><p>
	Unfortunately the IEEE488 interface - despite its timing-resistance - does
	not - as it comes with the PET - work at higher speeds than 1MHz CPU clock.
	I have now also patched the ROM to work in the Caspaer setup with 2MHz.
	</p>
    <ul><li class="subitem"><a href="roms/pet-fat40-1mhz-n-mmu.bin">Fat40 4032 graphics keyboard 1MHz</a> 
	This is the 1MHz ROM that produces roughly PAL compatible video output in the MMU version.
     </li><li class="subitem"><a href="roms/pet-fat40-1mhz-n-mmu+mon.bin">Fat40 4032 graphics keyboard 1MHz @MON</a> 
	This is the same ROM as above, only that it includes a PET version
	of the <a href="../../misc/index.html">@MON</a> machine language
	monitor at $A000, to start with "SYS 40960".
     </li><li class="subitem"><a href="roms/csabiospet2mhz_n_ieee.bin">Fat40 8032 graphics keyboard 2MHz @MON</a> 
	This is the same ROM as above, with the patched IEEE488 and video timing to run at 2MHz.
     </li><li class="subitem"><a href="mmu.diff">ROM diff</a> This is the ROM diff as hex dump. The Reset vector is modified to point to the patch that sets up the correct values and jumps to the old reset routine.
     </li><li class="subitem"><a href="initcsa.a65">Patch source</a> This is the source for the ROM patch (excluding the modified reset vector.
     </li><li class="subitem"><strong>IEEE488 patch</strong>: This is the IEEE488 patch that makes the IEEE488 work at 2Mhz (beta).
	<pre>
	*=$f0d8
	jsr $fe20

        *=$fe20
        lda #4
l1      sec
        sbc #1
        bne l1
        lda $e840
        rts
	</pre>
     </li></ul></li></ul></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2>Disclaimer</h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c">
All Copyrights are acknowledged.
The information here is provided under the terms of the
GNU Public License version 2 unless noted otherwise.
</div></div><hr />
<p>Return to <a href="../../index.html">Homepage</a></p>

  </div></div><div id="footer"> </div></div><script type="text/javascript">myUp="../../";</script><script type="text/javascript" src="../../scripts-all.js"></script></body></html> 

