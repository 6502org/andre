<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="author" content="André  Fachat">

<meta name="description" content="A new implementation of the Commodore PET 4032">
<meta name="keywords" content="Commodore PET 4032">
<link rev="made" href="mailto:afachat@gmx.de">
<LINK REL="stylesheet" TITLE="Default" TYPE="text/css" HREF="../../style.css">
<LINK REL="alternate stylesheet" TITLE="Advanced" TYPE="text/css" HREF="../../advanced.css">
<script src="../../jquery-1.4.2.min.js"></script><script src="../../myscripts.js"></script><script>myUp="../../";</script>

<title>Roll your own PET4032 (Fat40)</title>
</head>
<body>
<div id="leftcol">
<DIV class="top" ID="menu">
<a class="m_homepage" href="../../index.html">Homepage</a>
<ul class="menu0" >
<li class="separator">Commodore</li>
<li class="dir" id="m_petindex"><img src="../../imgs/dir.png"/><a href="../../petindex/index.html">CBM PETindex</a>
</li>
<li class="dir" id="m_cbmhw"><img src="../../imgs/dir.png"/><a href="../../cbmhw/index.html">CBM hardware and mods</a>
<ul class="menu1" >
<li class="dir" id="m_cbmhw_pet816"><img src="../../imgs/dir.png"/><a href="../pet816/index.html">Speed up your PET!</a>
</li>
<li class="dir" id="m_cbmhw_ryofat40"><img src="../../imgs/dir.png"/><a href="../ryofat40/index.html">Build your own PET replica!</a>
<ul class="menu2" >
<li class="link"><img src="../../imgs/link.png"/><a href="../../csa/petcpu/index.html">PETCPU</a></li>
<li class="link"><img src="../../imgs/link.png"/><a href="../../csa/petio/index.html">PETIO</a></li>
<li class="link"><img src="../../imgs/link.png"/><a href="../../csa/vdc/index.html">Video</a></li>
<li class="link"><img src="../../imgs/link.png"/><a href="../../csa/cpu/index.html">CPU</a></li>
<li class="link"><img src="../../imgs/link.png"/><a href="../../csa/bios/index.html">BIOS</a></li>
</ul>
</li>
<li class="dir" id="m_cbmhw_ryo1581"><img src="../../imgs/dir.png"/><a href="../ryo1581/index.html">Build your own VC1581 replica!</a>
</li>
<li class="dir" id="m_cbmhw_c64csa"><img src="../../imgs/dir.png"/><a href="../c64csa/index.html">CS/A adapter for C64</a>
</li>
<li class="dir" id="m_cbmhw_petcsa"><img src="../../imgs/dir.png"/><a href="../petcsa/index.html">CS/A adapter for PETs</a>
</li>
<li class="dir" id="m_cbmhw_kernal"><img src="../../imgs/dir.png"/><a href="../kernal/index.html">C64 kernal modifications</a>
</li>
<li class="dir" id="m_cbmhw_scsi"><img src="../../imgs/dir.png"/><a href="../scsi/index.html">CBM SCSI interfaces</a>
</li>
<li class="dir" id="m_cbmhw_ieee488"><img src="../../imgs/dir.png"/><a href="../ieee488/index.html">IEEE488 interfaces</a>
</li>
<li class="file"><img src="../../imgs/file.png"/> <a href="../hwmods.html">My Hardware mods</a></li>
<li class="link"><img src="../../imgs/link.png"/><a href="../../icap/c64ser.html">UART serial interface</a></li>
</ul>
</li>
<li class="separator">Hardware</li>
<li class="dir" id="m_csa"><img src="../../imgs/dir.png"/><a href="../../csa/index.html">CS/A65 Caspaer and Gecko computer</a>
</li>
<li class="dir" id="m_hwinfo"><img src="../../imgs/dir.png"/><a href="../../hwinfo/index.html">ICs and Standards Info</a>
</li>
<li class="dir" id="m_mischw"><img src="../../imgs/dir.png"/><a href="../../mischw/index.html">Other hardware (e.g. tools)</a>
</li>
<li class="separator">Software</li>
<li class="dir" id="m_osa"><img src="../../imgs/dir.png"/><a href="../../osa/index.html">GeckOS operating system</a>
</li>
<li class="dir" id="m_lib6502"><img src="../../imgs/dir.png"/><a href="../../lib6502/index.html">Lib6502 standard</a>
</li>
<li class="dir" id="m_o65"><img src="../../imgs/dir.png"/><a href="../../o65/index.html">O65 file format</a>
</li>
<li class="dir" id="m_misc"><img src="../../imgs/dir.png"/><a href="../../misc/index.html">Misc software</a>
</li>
<li class="separator">Knowledge Bits</li>
<li class="dir" id="m_icapos"><img src="../../imgs/dir.png"/><a href="../../icapos/index.html">Computer/OS Architecture</a>
</li>
<li class="dir" id="m_icaphw"><img src="../../imgs/dir.png"/><a href="../../icaphw/index.html">6502 Hardware Bits</a>
</li>
<li class="separator">Misc</li>
<li class="file"><img src="../../imgs/file.png"/> <a href="../../contact.html">Contact</a></li>
<li class="file"><img src="../../imgs/file.png"/> <a href="../../sneak.html">Sneak preview</a></li>
</ul>

</DIV>
		<div class="top" id="browser">
			Site has been tested with Firefox 3.6, IE8 and Google Chrome 5 on Windows, as well as Firefox 3.5 and konqueror 4.3.5 on Linux
		</div>
</div>
<div id="rightcol">
<div class="top" id="google"><form method="get" action="http://www.google.com/search">
<input type="text" name="q" size="20" maxlength="255" value=""><input type="submit" value="Google Search my site"><input type="hidden" name="sitesearch" value="www.6502.org/users/andre">
</form></div>
<div class="top" id="twitter">
		            Follow my 8-bit tweets on
		            <a href="http://search.twitter.com/search?q=&amp;ands=&amp;phrase=&amp;ors=&amp;nots=&amp;tag=8bit&amp;lang=all&amp;from=afachat&amp;to=&amp;ref=&amp;near=&amp;within=15&amp;units=mi&amp;since=&amp;until=&amp;rpp=15"><img src="http://twitter-badges.s3.amazonaws.com/twitter-b.png" alt="twitter"></a>
</div>
<div class="top" id="forum"><p>Discuss my site on <a href="http://forum.6502.org/viewtopic.php?t=956">this 6502.org forum thread</a></p></div>
</div>
<div id="midcol"><DIV class="top" ID="content">
<DIV ID="breadcrumbs">
<a href="../../index.html">Homepage</a>
&gt;&gt; <a href="../index.html">CBM hardware and mods
</a>&gt;&gt; Build your own PET replica!
</DIV>
<h1>Roll your own PET4032 (Fat40)</h1>
<p class="copyright">(C)
2006-2006 André  Fachat</p> 
<div class="overview">
	<p>This page describes how you can build your own PET 4032 using
	the boards of the <a href="../../csa/index.html">CS/A65</a> computer.</p>
<p>
	Well, not actually the whole computer, but at least the mainboard,
	where "only" the case, screen, and power supply are missing. I have
	though managed to use a standard PAL screen with this PET by 
	redefining the timing values the PET ROM writes into the 
	CRTC registers.
	</p>
<p>
	Basically what you do is to combine the <a href="../../csa/petcpu/index.html">PETCPU</a>,
	<a href="../../csa/petio/index.html">PETIO</a> and <a href="../../csa/vdc/index.html">Video</a> boards 
	into one computer, put the PET ROM into a ROM for the PETCPU ROM socket
	and there you are. The following sections describe the special settings
	on the different boards.
	</p>
  </div>
<h3>News:</h3>
<ul class="news">
<li>
<small>2010-05-11</small>
	Added beta version of patched PET BASIC4 ROM to run on CS/A in 2MHz
    </li>
<li>
<small>2006-12-22</small>
	Added the version using the CPU and BIOS boards instead of the PETCPU board ("Caspaer" setup).
    </li>
<li>
<small>2006-11-12</small>
	Added the ROMs.
    </li>
</ul>
<DIV ID="toc">
<H2>Table of content</H2>
<dir>
<li><a href="#">Fat40 Setup</a></li>
<dir>
<li><a href="#">Board Settings</a></li>
<li><a href="#">ROMs</a></li>
</dir>
<li><a href="#">Caspaer Setup</a></li>
<dir>
<li><a href="#">Board Settings</a></li>
<li><a href="#">ROMs</a></li>
</dir>
</dir>
</DIV>
<h2>Fat40 Setup</h2>
<p>
	<a href="fat40.jpg"><img class="rightimg" src="fat40-small.jpg"></a>
	This section describes a setup using the three PETCPU, PETIO
	and VDC boards.
    </p>
<ul>
<li>
<strong>Board Settings</strong><br><br><p><p>
	This section describe the CS/A65 boards making up the PET 4032.
	Here is a <a href="fat40.jpg">picture</a> of the three boards on 
	a backplane. Note the separate cable between the VDC and the 
	PETIO boards, to handle the video retrace (VSYNC) interrupt generation
	from VDC to PETIO and the character ROM selection.
	from PETIO to VDC.</p>
    </p>
<ul>
<li class="subitem">
<a href="../../csa/petcpu/index.html">PETCPU board</a> 
	The PETCPU board must be set to a maximum of 32k RAM on the board
	itself, and maximum of 28k of ROM, so that the memory area at
	$8*** is selected on the CS/A65 bus and can be handled by the
	video board. Actually all memory not handled by the PETCPU is
	covered by RAM from the video board (e.g. the $9*** area). 
	To achieve this, the PETCPU board must be set to use the 
	$01**** are on the bus. In addition it must exclusive-or
	the address lines 15 and 12 - as the PET CRTC is set to a 
	memory address of $9000 - but the video board resets the video
	to $0000 with the control register and the values set in the
	CRTC. Also the I/O area must be enabled for $E800 to $EFFF.
	<br>You can see the jumpers in this <a href="petcpu.jpg">picture</a>.
	Please note that this is jumpered for 2MHz, and the RAM is missing -
	as the RAM is setup to be used from the video board.
     <br><br>
</li>
<li class="subitem">
<a href="../../csa/petio/index.html">PETIO board</a> 
	On the PETIO board only the "special features" must be
	switched off, especially the IEEE488 slave mode feature, as the
	ROM does not handle this, as well as the EOI must be located
	at its original place on the keyboard PIA.
     <br><br>
</li>
<li class="subitem">
<a href="../../csa/vdc/index.html">Video board</a> 
	The video board must be set to the memory area $01****. Otherwise
	it should best be a 1.4 version, as the control port is reset
	with /RES and needs not be set by the ROM.
     <br><br>
</li>
</ul>
</li>
<br><li>
<strong>ROMs</strong><br><br><p><p>
	In this section you can find the ROMs for the PET. They basically
	are the original PET ROMs, only that I have modified the 
	CRTC timing parameters. Please note that the 2MHz (8032) version
	is experimental only, as the IEEE488 timing seems to be flakey
	now.</p>
    </p>
<ul>
<li class="subitem">
<a href="roms/pet-fat40-1mhz-n.bin">Fat40 4032 graphics keyboard 1MHz</a> 
	This is the 1MHz ROM that produces roughly PAL compatible video output.
     <br><br>
</li>
<li class="subitem">
<a href="roms/pet-8032-2mhz-b.bin">8032 business keyboard 2MHz</a> 
	This 2MHz version is experimental. As the VDC board can only do 80 columns with 2MHz bus frequency, no 8032 with 1MHz is possible.
     <br><br>
</li>
</ul>
</li>
<br>
</ul>
<h2>Caspaer Setup</h2>
<p>This section contains a description of a setup
	using the main CPU (including MMU) and BIOS board instead of the
	PETCPU board as above.
	</p>
<ul>
<li>
<strong>Board Settings</strong><br><br><p><p>
	This section describe the CS/A65 boards making up the PET 4032
	in a setup with the CPU+BIOS board combination. 
	Please note that the separate cable between the VDC and the 
	PETIO boards, to handle the video retrace (VSYNC) interrupt generation
	is still required as above.
	</p>
    </p>
<ul>
<li class="subitem">
<a href="../../csa/cpu/index.html">CSACPU board</a> 
	The CPU board must be set to 1MHz. The ROM patch below expects
	the MMU at $eff*, so the board must be set to an I/O area of
	2k from $E800-$EFFF and the MMU to $EFF*. By modifying the patch
	other values are possible.
     <br><br>
</li>
<li class="subitem">
<a href="../../csa/bios/index.html">BIOS board</a> 
	The BIOS must be set that the ROM as described below
	is found at $08000-$0FFFF so that the CPU boots from it.
	The RAM should be on $00000-$07FFF.
     <br><br>
</li>
<li>
<strong>PETIO and VDC boards</strong>: 
	Please use the same settings as described above.
     <br><br>
</li>
</ul>
</li>
<br><li>
<strong>ROMs</strong><br><br><p><p>
	The ROMs are basically the same ROMs as above, i.e. including
	the modified CRTC timing parameters.
	In addition, the CPU must set the MMU and BIOS board to correct
	values on Reset. This is done by a small patch that is included
	in the ROM listed below.
	</p><p>
	Unfortunately the IEEE488 interface - despite its timing-resistance - does
	not - as it comes with the PET - work at higher speeds than 1MHz CPU clock.
	I have now also patched the ROM to work in the Caspaer setup with 2MHz.
	</p>
    </p>
<ul>
<li class="subitem">
<a href="roms/pet-fat40-1mhz-n-mmu.bin">Fat40 4032 graphics keyboard 1MHz</a> 
	This is the 1MHz ROM that produces roughly PAL compatible video output in the MMU version.
     <br><br>
</li>
<li class="subitem">
<a href="roms/pet-fat40-1mhz-n-mmu+mon.bin">Fat40 4032 graphics keyboard 1MHz @MON</a> 
	This is the same ROM as above, only that it includes a PET version
	of the <a href="../../misc/index.html">@MON</a> machine language
	monitor at $A000, to start with "SYS 40960".
     <br><br>
</li>
<li class="subitem">
<a href="roms/csabiospet2mhz_n_ieee.bin">Fat40 8032 graphics keyboard 2MHz @MON</a> 
	This is the same ROM as above, with the patched IEEE488 and video timing to run at 2MHz.
     <br><br>
</li>
<li class="subitem">
<a href="mmu.diff">ROM diff</a> This is the ROM diff as hex dump. The Reset vector is modified to point to the patch that sets up the correct values and jumps to the old reset routine.
     <br><br>
</li>
<li class="subitem">
<a href="initcsa.a65">Patch source</a> This is the source for the ROM patch (excluding the modified reset vector.
     <br><br>
</li>
<li>
<strong>IEEE488 patch</strong>: This is the IEEE488 patch that makes the IEEE488 work at 2Mhz (beta).
	<pre>
	*=$f0d8
	jsr $fe20

        *=$fe20
        lda #4
l1      sec
        sbc #1
        bne l1
        lda $e840
        rts
	</pre>
     <br><br>
</li>
</ul>
</li>
<br>
</ul>
<h2>Disclaimer</h2>
<p>
All Copyrights are acknowledged.
The information here is provided under the terms of the
GNU Public License version 2 unless noted otherwise.
</p>
<hr>
<p>Return to <a href="../../index.html">Homepage</a></p>

  </DIV></div>
</body>
</html> 

