<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="author" content="Andr&#xE9;  Fachat" />

<meta name="description" content="SCSI controllers for the C64" />
<meta name="keywords" content="C64, SCSI controller" />
<link rev="made" href="mailto:afachat@gmx.de" />
<link rel="stylesheet" title="Default" type="text/css" href="../../style-min.css" /><link rel="alternate stylesheet" title="Advanced" type="text/css" href="../../advanced.css" />
<title>SCSI-64: SCSI controller for the C64 and other 6502</title></head>
<body><div id="mainbox"><a name="top" id="top"></a><div id="leftcol"><div id="menu" class="top"><div class="tophead">navigate</div><div id="filter"><form action="#"><table id="filterbox"><tr><td><input alt="menu filter" size="8" name="filter" value="filter" type="text" /></td><td><div id="cancel" class="i_cancel"> </div></td></tr></table><table id="expcol"><tr><td><div id="expand" class="i_expand"> </div></td><td><div id="collapse" class="i_collapse"> </div></td></tr></table></form></div>
<div id="mtree">
<a id="m_homepage" href="../../index.html">Homepage</a>
<ul class="menu0" >
<li class="separator">Commodore</li>
<li class="dir" id="m_petindex"><div class="i_dir">&nbsp;</div><a href="../../petindex/index.html">CBM PETindex</a>
</li>
<li class="dir" id="m_cbmhw"><div class="i_dir">&nbsp;</div><a href="../../cbmhw/index.html">CBM hardware and mods</a>
<ul class="menu1" >
<li><div class="i_link">&nbsp;</div><a href="../../adv65/pet816/index.html">Speed up your PET!</a></li>
<li class="dir" id="m_cbmhw_ryofat40"><div class="i_dir">&nbsp;</div><a href="../ryofat40/index.html">Build your own PET replica!</a>
</li>
<li class="dir" id="m_cbmhw_ryo1581"><div class="i_dir">&nbsp;</div><a href="../ryo1581/index.html">Build your own VC1581 replica!</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../c64csa/index.html">CS/A adapter for C64</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../petcsa/index.html">CS/A adapter for PETs</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../kernal/index.html">C64 kernal modifications</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="index.html" class="mcurrent">CBM SCSI interfaces</a>
<ul class="menu2" >
<li><div class="i_link">&nbsp;</div><a href="../../csa/scsi/index.html">CS/A65 SCSI interface</a></li>
<li><div class="i_link">&nbsp;</div><a href="../../hwinfo/scsi.html">SCSI standard</a></li>
</ul>
</li>
<li><div class="i_file">&nbsp;</div><a href="../ieee488/index.html">IEEE488 interfaces</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../hwmods.html">My Hardware mods</a></li>
<li><div class="i_link">&nbsp;</div><a href="../../icap/c64ser.html">UART serial interface</a></li>
</ul>
</li>
<li class="separator">Hardware</li>
<li class="dir" id="m_65k"><div class="i_dir">&nbsp;</div><a href="../../65k/index.html">The 65k Project</a>
</li>
<li class="dir" id="m_csa"><div class="i_dir">&nbsp;</div><a href="../../csa/index.html">CS/A65 Caspaer and Gecko computer</a>
</li>
<li class="dir" id="m_adv65"><div class="i_dir">&nbsp;</div><a href="../../adv65/index.html">Advanced 6502</a>
</li>
<li class="dir" id="m_hwinfo"><div class="i_dir">&nbsp;</div><a href="../../hwinfo/index.html">ICs and Standards Info</a>
</li>
<li class="dir" id="m_mischw"><div class="i_dir">&nbsp;</div><a href="../../mischw/index.html">Other hardware (e.g. tools)</a>
</li>
<li class="separator">Software</li>
<li><div class="i_file">&nbsp;</div><a href="../../osa/index.html">GeckOS operating system</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../../lib6502/index.html">Lib6502 standard</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../../o65/index.html">O65 file format</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../../misc/index.html">Misc software</a>
</li>
<li class="separator">Knowledge Bits</li>
<li class="dir" id="m_icapos"><div class="i_dir">&nbsp;</div><a href="../../icapos/index.html">Computer/OS Architecture</a>
</li>
<li class="dir" id="m_icaphw"><div class="i_dir">&nbsp;</div><a href="../../icaphw/index.html">6502 Hardware Bits</a>
</li>
<li class="separator">Misc</li>
<li><div class="i_file">&nbsp;</div><a href="../../contact.html">Contact</a></li>
<li><div class="i_file">&nbsp;</div><a href="../../sneak.html">Sneak preview</a></li>
<li><div class="i_file">&nbsp;</div><a href="../../design.html">Web design</a></li>
</ul>

</div>
		</div><div class="top" id="browser"><div class="tophead">browser</div><div>
			Site has been tested with a number of browsers and systems. Javascript required for advanced menu, but degrades gracefully without Javascript. IE6 not fully supported anymore!
			</div></div></div><div id="rightcol"><div class="top" id="google"><div class="tophead">search</div><div><form method="get" action="http://www.google.com/search" target="_blank"><input alt="search parameters" type="text" name="q" size="10" maxlength="255" value="" /><input class="advbutton" type="submit" value="Search my site" /><br />(Google, in new window)
	                        <input type="hidden" name="sitesearch" value="www.6502.org/users/andre" /></form></div></div><div class="top" id="twitter"><div class="tophead">follow</div><div>
		            Follow my 8-bit tweets on<br /><a target="_blank" href="http://search.twitter.com/search?q=&amp;ands=&amp;phrase=&amp;ors=&amp;nots=&amp;tag=8bit&amp;lang=all&amp;from=afachat&amp;to=&amp;ref=&amp;near=&amp;within=15&amp;units=mi&amp;since=&amp;until=&amp;rpp=15">Twitter</a><br /> (In new window)
		</div></div><div class="top" id="forum"><div class="tophead">discuss</div><div><p>Discuss my site on <a class="extlink" target="_blank" href="http://forum.6502.org/viewtopic.php?t=956">this 6502.org forum thread</a></p><p>(Forum registration required to post)</p></div></div><div class="top" id="hot"><div class="tophead">Hot!</div><div>
<p>Dive into the retro feeling and build yourself a <a href="../../cbmhw/ryofat40/index.html">Commodore PET replica</a></p>
<p>Need more speed? Speed up your 6502 computer with this <a href="../../adv65/pet816/index.html">10&nbsp;MHz 6502 CPU replacement board</a></p>
<p>Interested in electronics design? Look at the <a href="../../icaphw/design.html">design lesson</a> I got from Bil Herd, the hardware designer of the C128</p>

		</div></div></div><div id="midcol"><div class="top" id="ie6warn">
You are using an old MS Internet Explorer as browser. This version is not supported anymore. Please use a 
more modern browser, like Internet Explorer 8 or later, 
<a target="_blank" class="extlink" href="http://www.firefox.com">Firefox</a>,
<a target="_blank" class="extlink" href="http://www.google.com/chrome">Google Chrome</a>, or
<a target="_blank" class="extlink" href="http://www.opera.com">Opera</a>.
</div><div class="top" id="content"><div id="minmax"></div>
<div id="breadcrumbs">
<a href="../../index.html">Homepage</a>
&gt;&gt; <a href="../index.html">CBM hardware and mods</a>&gt;&gt;  CBM SCSI interfaces</div>
<h1>SCSI-64: SCSI controller for the C64 and other 6502</h1><p class="copyright">(C)
- André  Fachat</p> 
<div class="overview"><p>This is the description of several SCSI controllers for the Commodore C64
computer. Some of them may be used with a VIC20 or C128 as well.
All of the controllers are based on one hardware interface that is built
into different setups.
	</p>
  </div><div id="toc" class="h2"><div class="h2h"><div class="h2t"> </div><h2>Table of content</h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c"><ul><li><a href="#desc">Description</a></li><li><a href="#disc">Disclaimer</a></li><li><a href="#dist">Distribution</a></li><li><a href="#std">Standard</a></li><li><a href="#genscsi">Generic 6502 SCSI Interface</a></li><li><a href="#swarch">Software Architecture</a></li><li><a href="#hwproj">Hardware Projects</a></li><li style="list-style-type:none;"><ul><li><a href="#c64scsi">C64 SCSI (harddisk) adapter</a></li><li><a href="#vcscsi10">VC-SCSI 1.0 drive</a></li><li><a href="#vcscsi1x">VC-SCSI 1.x drive</a></li><li><a href="#vcscsi20">VC-SCSI 2.0 drive</a></li></ul></li></ul></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="desc" id="desc">Description</a></h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c"> <p>After going a bit into the SCSI standard first I
present the generic interface.
(You can download a slightly older page and all schematics in one archive in
<a href="http://www.zimmers.net/anonftp/pub/cbm/documents/projects/scsi/scsi64-1.tar.gz">scsi64-1.tar.gz</a>. The link to the SCSI standard below is missing).
</p><p>
The driver code is made in a modular way. It consist of the hardware driver
and the partition handler. Both are separated by a well-formed programming
interface, as well as the partition handler presents a nice interface
to the filesystem code. This architecture is presented in the
second part.
</p><p>
The different hardware projects using the generic SCSI interface are described
in the third chapter. Those include a SCSI interface directly for the C64,
as well as disk-drive-like small computers that can be used via the
C64s serial IEC bus.
    </p></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="disc" id="disc">Disclaimer</a></h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c"> <p><em>Before you go on, you should know that all this stuff
comes with <strong>no warranty at all </strong>. Of course this hardware is <strong>not</strong>
to be used in any important or even life-critical systems.
The hardware schematics and software
are provided 'AS IS', WITHOUT WARRANTY of any kind. The entire risk as
to the quality and performance of the hard- and software is with you. Should
the hard- or software prove defective, you assume the cost of all necessary
servicing, repair or correction.
    </em></p></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="dist" id="dist">Distribution</a></h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c"> <p>This computer system is distributed under the GNU Public License V2.</p>
    </div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="std" id="std">Standard</a></h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c">
    <p>
SCSI means "Small Computer System Interface". It is an
interface that connectes computers with peripheral devices, like
disks, scanners, CD-ROMs etc. As such it is very flexible.
</p><p>
More on the SCSI standard can be found on its <a href="../../hwinfo/scsi.html">SCSI page</a> on this site.
    </p></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="genscsi" id="genscsi">Generic 6502 SCSI Interface</a></h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c"> <p>In my SCSI interfaces and devices for the Commodore computers I use a
generic 6502 SCSI interface I developed for the <a href="../../csa/index.html">CS/A65</a> computer. The SCSI interface has its own <a href="../../csa/scsi/index.html">place</a> there.
</p><p>
This interface has been designed for the
<a href="../../csa/bus-1.1.html">CS/A65 bus system</a>. However, this
bus system basically is the 6502 bus. In fact, besides the <code>/IOSEL</code>
line only 6502 CPU lines are used.<code>/IOSEL</code> selects the I/O area
and is generated from the address lines in the usual way.
This means that the interface can be used on a variety of systems,
and it is used on selfbuilt computers as well as the C64,
as will be seen below. The 6809 has the same bus interface as the 6502,
so it could even be used with this CPU (although no drivers exist for
the 6809).
    </p></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="swarch" id="swarch">Software Architecture</a></h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c"> <p>The software architecture is kept as flexible as possible.
Three levels work together, the hardware driver, the partition
level that transforms block numbers in a partition into
block numbers in the device, and the third level which is the
filesystem code.
</p><p>
An implementation of the drivers can be found in the <a href="../../osa/index.html">GeckOS</a> operating system. A description comes with the
description of the <a href="../../csa/scsi/index.html">CS/A65 SCSI interface</a>.
</p><p>
The most recent SCSI drivers can be found in the <a href="../../osa/index.html">GeckOS/A65 operating
system</a>. An example of a filesystem
implementation can be found in <code>oa-2.0.8/sysapps/fs/fsibm*</code>,
that implement a fileserver task for the GeckOS/A65 operating
system. It handles PC-style disks with the FAT12 or FAT16 filesystem
(no FAT32 and no long filenames). But be warned, it is an early
beta!!! Don't ever try it on a disk that contains anything valuable to you!!!
    </p></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="hwproj" id="hwproj">Hardware Projects</a></h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c"> <p>
Now I will describe the different approaches to use the generic
SCSI interface in a Commodore system, more specifically with a
C64 or C128.
    </p><h3><a name="c64scsi" id="c64scsi">C64 SCSI (harddisk) adapter</a></h3><p><ul><li><strong>Idea</strong>
              :
              This interface should directly connect a harddisk to the C64.
The C64 would then have to do all the filesystem handling itself,
but it is fast (no serial IEC bus) and cheap.</li><li><strong>Description</strong>
              :
              <p>This is a simple example of how to use the C64-CS/A adapter
with a CS/A65 I/O card.
The <a href="../c64csa/index.html">C64-CS/A adapter</a>
is plugged into the expansion port using one I/O area (at $de** or $df**).
It uses a VIA 6522 to expand the address range so that you can
use the full CS/A bus system with all cards.
</p><p>
The results of the combination with the CS/A-SCSI card
is a simple C64 expansion port card without CS/A bus
interface, in this case in the <font color="#ff0000">C64 SCSI controller</font>.
</p><p>
A picture says more than a thousand words, so here is the C64 SCSI
interface schematics as
<a href="c64scsi/c64scsi.png">c64scsi.png</a> or
<a href="c64scsi/c64scsi.ps.gz">c64scsi.ps.gz</a>.
This is a combination of the CS/A SCSI controller and the
C64 CS/A adapter. However, as only the SCSI controller will be used,
some parts of the combined schematics can be left out (shaded grey),
and only one additional connection has to be made (indicated).
</p>
<p>Matthias Kirchner provided me with an
<a href="http://www.cadsoft.de/">Eagle</a> schematics and board layout
for the C64-SCSI board. However, There is absolutely no warranty with
this schematics and layout, as I could not fully check it.
You can find it in <a href="c64scsi/c64scsi.zip">c64scsi.zip</a>.</p></li><li><strong>Status</strong>
              :
              The interface consisting of the C64-CS/A adapter and the CS/A-SCSI
card has been tested on a C64 and works. The "imploded" version
with the left out parts has not been tested.</li>
</ul>
	</p>
	<h3><a name="vcscsi10" id="vcscsi10">VC-SCSI 1.0 drive</a></h3><p><ul><li><strong>Idea</strong>
              :
              Provide a separate computer like the VC1541 and interface it with
the C64 via the serial IEC bus. This would keep a lot of work off the
C64, and provide easier access.</li><li><strong>Description</strong>
              :
              <p>
This is a combination of the Gecko computer and the SCSI board.
</p><p>
The Gecko (see the <a href="../../csa/gecko/index.html">gecko</a> directory) is
a small single-board 6502 computer. The base system provides
32k RAM, 32k ROM and access to the <a href="../../csa/bus.html">CS/A I/O bus</a>
(which is the CS/A bus itself, but only using the lower 12 address bits
with <code>/IOSEL</code>). The full Gecko includes an RS232 interface,
as well as a VIA6522 with serial IEC and keyboard interface.
</p><p>
Combining the Gecko with the SCSI interface is simple, just attach it.
If you remove the backplane by putting both cards on the same board
you can also leave out some parts of the Gecko that are of no use.
Those parts are shaded grey in the schematics.
This board can be used with the C64, C128 and VIC20.
</p><p>
The schematics are available as
<a href="vcscsi1/vcscsi-1.0.png">vcscsi-1.0.png</a> or
<a href="vcscsi1/vcscsi-1.0.ps.gz">vcscsi-1.0.ps.gz</a>.
</p></li><li><strong>Status</strong>
              :
              The Gecko board and the SCSI interface have been tested separately
and both work. Also the Gecko board works with several other
CS/A cards (my Gecko prototype board developed a bad soldering
so I cannot test it with the SCSI board at this time.).
The SCSI interface has been tested with the orignal CS/A65 computer
and with the C64 using the adapter from above.
This will work with &gt;99.5%.</li></ul>
	</p>
	<h3><a name="vcscsi1x" id="vcscsi1x">VC-SCSI 1.x drive</a></h3><p><ul><li><strong>Idea</strong>
              :
              Modify the Gecko board such that the VIA appears at the same place as
the IEC VIA in the VC1541, and also use the very same IEC schematics
as in the VC1541. This would allow building a VC1541 emulation mode
for all speeders that use the standard FDC routines to acces
a floppy - these routines would then be replaced to access a large file
on the harddrive (a .d64 image basically)</li><li><strong>Description</strong>
              :
              <p>
This is basically still the Gecko board. Only the address selection of
the I/O area around IC2 would have to be changed, as well as the
address value at IC9. The VIA would get the very same IEC electronics
as the VC1541 has, removing anything else. The UART (RS232) would be
removed as well.
<p></p>
The 32k ROM would be divided into an upper 16k part and a lower 16k part.
The upper part would be filled with a modified VC1541 ROM, and the lower
part with the SCSI filesystem code.
<p></p>
To make the emulation mode reasonably secure part of the RAM - that would
then contain the mapping of VC1541 blocks -&gt; blocks on the disk drive -
should be made write-protectable. This way any floppy speeder going haywire
could with high probability not overwrite other parts of the HD.
</p>
</li><li><strong>Status</strong>
              :
              Idea</li></ul>
	</p>
	<h3><a name="vcscsi20" id="vcscsi20">VC-SCSI 2.0 drive</a></h3><p><ul><li><strong>Idea</strong>
              :
              When the 6522 is replaced with a 6526 the burst mode of the VC1571 can
be used.</li><li><strong>Description</strong>
              :
              <p>
In this schematics I have molded the Gecko and the SCSI
boards more together, without
a bus in between. Also I replaced the 6522 with a 6526. This allows
to use the fast serial IEC bus as used with the C128 (or with a modified
C64). A place for a Speeder Cable is also provided.
</p><p>
Thanks to Nicolas Welte I have improved the parallel speeder cable
support, and provided a way to set the IEC ID.
</p><p>
One word of warning, though: The schematics are preliminary, untested, and
a mess! Again, they are provided AS IS, without warranty!
</p><p>
The schematics are available as
<a href="vcscsi2/vcscsi-2.1C.png">vcscsi-2.1C.png</a> or
<a href="vcscsi2/vcscsi-2.1C.ps.gz">vcscsi-2.1C.ps.gz</a>.
And there is the
<a href="vcscsi2/vcscsi-2.1C-parts.txt">vcscsi-2.1C-parts.txt</a>
parts list.
</p><p>
The memory map has RAM at $0000-$7FFF, ROM at $8000-$DFFF and $E800-$FFFF.
I/O is at $E000-$E7FF, with $E000-$E3FF mirrored at $E400.
$E0** is the 6526, $E1** is the SCSI interface and $E2** is the IEEE488 ID
and speeder flag port.
$E3** is not (yet) used, so there is place for a disk controller or whatever.
</p>
</li><li><strong>Status</strong>
              :
              Schematics exist, but they are preliminary, untested, and
a mess! Again, they are provided AS IS, without warranty!</li></ul>
	</p>
	</div></div><hr />
<p>Return to <a href="../../index.html">Homepage</a></p>

  </div></div><div id="footer"> </div></div><script type="text/javascript">myUp="../../";</script><script type="text/javascript" src="../../scripts-all.js"></script></body></html> 

