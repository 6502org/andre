<!DOCTYPE html SYSTEM "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" />
<meta name="author" content="" />

<meta name="description" content="" />
<meta name="keywords" content="Commodore hardware usb" />
<link rev="made" href="mailto:" />
<link rel="stylesheet" title="Default" type="text/css" href="../../style2-min.css" />
<title>Commodore Userport USB interface</title></head>
<body><div id="mainbox"><a name="top" id="top"></a><div id="topsearch"><form method="get" action="http://www.google.com/search" target="_blank" autocomplete="off"><input id="searchinput" alt="search" name="q" size="10" maxlength="255" type="text" value="" /><input class="advbutton" value="Search site" type="submit" /><div id="srchprov">(by Google)</div><input name="sitesearch" value="www.6502.org/users/andre" type="hidden" /></form><div id="topfind"><div id="topprogress"></div></div></div><div id="menubox">


<div id="menu1" class="mclose">
<div id="twist1" class="twisty"></div>
<div class="hdrtxt"><a href="../../index.html">Home&nbsp;&gt;</a></div>
<ul class="nav1">
<li>
<ul class="nav2">
<li class="navhdr"><a href="../../index.html">Home</a></li>
<li><a href="../../contact.html">Contact</a></li>
<li><a href="../../design.html">Web design</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Hardware</span></li>
<li><ul class="nav2" >
<li><a href="../../ultipet/index.html">The Ultimate PET</a>
</li>
<li><a href="../../upet/index.html">The Micro-PET</a>
</li>
<li><a href="../../65k/index.html">The 65k Project</a>
</li>
<li><a href="../../pet816/index.html">PET816 Accelerator</a>
</li>
<li><a href="../../csa/index.html">CS/A65</a>
</li>
<li><a href="../../cbmhw/index.html">CBM mods</a>
</li>
<li><a href="../../spi65b/index.html">SPI65B</a>
</li>
<li><a href="../../xs1541/index.html">XS1541</a>
</li>
<li><a href="../../mischw/index.html">Other hardware</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Software</span></li>
<li><ul class="nav2" >
<li><a href="../../osa/index.html">GeckOS</a>
</li>
<li><a href="../../lib6502/index.html">lib6502 </a>
</li>
<li><a href="../../o65/index.html">o65</a>
</li>
<li><a href="../../usb65/index.html">usb65</a>
</li>
<li><a href="../../xd2031/index.html">XD2031</a>
</li>
<li><a href="../../misc/index.html">Misc</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Library</span></li>
<li><ul class="nav2" >
<li><a href="../../petindex/index.html">PETindex</a>
</li>
<li><a href="../../petindex/drives/index.html">PET drives</a>
</li>
<li><a href="../../adv65/index.html">Advanced 6502</a>
</li>
<li><a href="../../hwinfo/index.html">ICs and Standards</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Knowledge Bits</span></li>
<li><ul class="nav2" >
<li><a href="../../icapos/index.html">Computer/OS Architecture</a>
</li>
<li><a href="../../icaphw/index.html">6502 Hardware Bits</a>
</li>
<li><a href="../../emulation/index.html">Emulation</a>
</li>
</ul>
<div class="nend2"></div>
</li>
<div class="nend1"></div>
</ul>
</div>
<div id="menu2" class="%open%">
<div id="twist2" class="twisty"></div>
<div class="hdrtxt"><a href="../index.html">CBM Modifications&nbsp;&gt;</a></div>
<ul class="nav1">
<li>
<ul class="nav2">
<li class="navhdr"><a href="../index.html">CBM Modifications</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Accelerator</span></li>
<li><ul class="nav2" >
<li><a href="../../adv65/pet816/index.html">&gt;Speed up your PET!</a></li>
<div class="nend2"></div>
</ul>
</li>
<li><span>Replicas</span></li>
<li><ul class="nav2" >
<li><a href="../ryofat40/index.html">Build your own PET replica!</a>
</li>
<li><a href="../ryo1581/index.html">Build your own VC1581 replica!</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>CS/A adapters</span></li>
<li><ul class="nav2" >
<li><a href="../c64csa/index.html">CS/A adapter for C64</a>
</li>
<li><a href="../petcsa/index.html">CS/A adapter for PETs</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<li><span>Interfaces</span></li>
<li><ul class="nav2" >
<li><a href="../cbmusb/index.html">Userport USB interface</a>
</li>
<li><a href="../petnet/index.html">Put your PET on the 'Net</a>
</li>
<li><a href="../scsi/index.html">CBM SCSI interfaces</a>
</li>
<li><a href="../ieee488/index.html">IEEE488 interfaces</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Misc</span></li>
<li><ul class="nav2" >
<li><a href="../kernal/index.html">C64 kernal modifications</a>
</li>
<li><a href="../hwmods.html">My Hardware mods</a></li>
<li><a href="../8032sk/index.html">A modified 8032-SK</a>
</li>
<li><a href="../../icap/c64ser.html">&gt;UART serial interface</a></li>
</ul>
<div class="nend2"></div>
</li>
<div class="nend1"></div>
</ul>
</div>
	</div><div id="midcol"><div class="top" id="content"><div id="minmax"></div>

<h1>Commodore Userport USB interface</h1>

<div class="overview">
	<p>
	The userport USB interface provides USB connectivity to the 
	Commodore line of computers - it's designed to work with the
	PET, VIC20, and C64 (and in extension with the C128).
	</p><p>
	The USB interface provides the host as well as client USB interface.
	So you can use USB devices on the PET - see the video below for example -
	or you can use the PET as device on a PC's USB bus (although not at the
	same time)!
	</p>
<iframe width="420" height="315" src="http://www.youtube-nocookie.com/embed/Oof1uryV-bo" frameborder="0" allowfullscreen="1"></iframe>
	<p>
	The userport interface actually not only uses the userport, but also
	the tape port - as there is no supply voltage on the userport (at least on the
	PET - on the C64 you could conjure up something from the 9VAC). But also
	the device needs more control lines than available on the userport, so it
	takes them from the tape port.
	</p><p>
	The chip used is a MAX3421 USB interface chip, and the interface board includes
	some glue logic to connect it to the CBM. The 3421 uses an SPI interface in mode  3
	(or, alternatively, 0). Fortunately the VIA uses SPI mode 3 when shifting through
	its serial shift register. There is only one shift register, though, so shifting
	out is taken care of by the VIA shift register, the data shifted in (at the same time
	as data is shifted out) is de-serialized by a simple external 74LS164 shift register
	and presented as 8  bit parallel data on the userport's I/O port.
	</p>
  
</div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="news" id="news">News:</a></h2></div><div class="h2c"><ul class="news"><li><div> </div><small>2013-10-13</small>
	Started this page
    </li></ul></div></div><div id="toc" class="h2"><div class="h2h"><div class="h2t"> </div><h2>Table of content</h2></div><div class="h2c"><ul><li><a href="#driver">Driver</a></li><li style="list-style-type:none;"><ul><li><a href="#driver1">USB65</a></li></ul></li><li><a href="#boards">Board Revisions</a></li><li style="list-style-type:none;"><ul><li><a href="#board1">1.1A</a> (untested)</li><li><a href="#board2">1.0A</a> (ok)</li></ul></li></ul></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="driver" id="driver">Driver</a></h2></div><div class="h2c"><div class="driver"><h3><a name="driver1" id="driver1">USB65</a></h3><div class="driverdesc">
		<p>
		This driver is a collection of drivers for this and some
		other platforms. You can find it on
		<a href="http://www.github.com/fachat/usb65" target="_blank">github</a>
		</p>
		<p>
		Please note that since board version 1.1, if you want to use the switchable
		USB supply voltage, some care has to be taken with the interrupt routine.
		The PET ROM for example handles the tape MOTOR output - which controls the 
		power supply - in the interrupt routine. If you don't work around this, the
		power will stay off...
		</p>
	</div><div class="driverfiles"><table class="files"></table></div><div class="driverend"></div></div></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="boards" id="boards">Board revisions</a></h2></div><div class="h2c"><div class="rev"><h3><a name="board1" id="board1">Version: 1.1A</a></h3>
<div class="revdesc"><p>Status: untested</p>
</div><div class="revnotes"><h4>Notes</h4><table class="notes"><tr><td class="noteicon"><div class="i_msg"> </div></td>
<td>
		This version adds a separate - jumperable - way to produce the 
		5V required by the USB host bus. It uses the tape output of
		unregulated 9V DC and uses a power requlator separate from the
		5V used for the actual USB interface.
		This way you can switch USB power, and don't have any bad effects
		of USB power consumption on the actual interface or the main
		computer itself. 
	</td></tr>
<tr><td class="noteicon"><div class="i_msg"> </div></td>
<td>
		This version also moves the mini-USB interface to the side,
		as the assumption goes this will be less used than the USB micro.
		Some parts options have been removed due to space optimization.
	</td></tr>
<tr><td class="noteicon"><div class="i_warn"> </div></td>
<td>
		This schematics and board is only derived from some experiments
		with board version 1.0, and thus untested as a real board.
	</td></tr>
</table></div><div class="revfiles"><h4>Files</h4><table class="files">
<tr class="R1"><td><div class="i_schem"> </div></td>
<td><a href="cbm-usb-v1.1a-1-sch.png">cbm-usb-v1.1a-1-sch.png</a></td>
</tr>
<tr class="R0"><td><div class="i_schem"> </div></td>
<td><a href="cbm-usb-v1.1a-2-sch.png">cbm-usb-v1.1a-2-sch.png</a></td>
</tr>
<tr class="R1"><td><div class="i_schem"> </div></td>
<td><a href="cbm-usb-v1.1a-3-sch.png">cbm-usb-v1.1a-3-sch.png</a></td>
</tr>
<tr class="R0"><td><div class="i_schem"> </div></td>
<td><a href="cbm_usb_v1.1a.sch">cbm_usb_v1.1a.sch</a></td>
</tr>
<tr class="R1"><td><div class="i_layout"> </div></td>
<td><a href="cbm-usb-v1.1a-brd.png">cbm-usb-v1.1a-brd.png</a></td>
</tr>
<tr class="R0"><td><div class="i_layout"> </div></td>
<td><a href="cbm_usb_v1.1a.brd">cbm_usb_v1.1a.brd</a></td>
</tr></table>
</div><div class="revend"></div></div><div class="rev"><h3><a name="board2" id="board2">Version: 1.0A</a></h3>
<div class="revdesc"><p>Status: ok</p>
</div><div class="revnotes"><h4>Notes</h4><table class="notes"><tr><td class="noteicon"><div class="i_msg"> </div></td>
<td>
		This is the initial version of the board. And it worked right without further changes! :-)
	</td></tr>
<tr><td class="noteicon"><div class="i_warn"> </div></td>
<td>
		Although this board has soldering jumpers to work with different types of machines
		from PET over VIC20 to C64, it has so far only been tested with the PET.
	</td></tr>
</table></div><div class="revfiles"><h4>Files</h4><table class="files">
<tr class="R1"><td><div class="i_schem"> </div></td>
<td><a href="cbm-usb-v1.0a-1-sch.png">cbm-usb-v1.0a-1-sch.png</a></td>
</tr>
<tr class="R0"><td><div class="i_schem"> </div></td>
<td><a href="cbm-usb-v1.0a-2-sch.png">cbm-usb-v1.0a-2-sch.png</a></td>
</tr>
<tr class="R1"><td><div class="i_schem"> </div></td>
<td><a href="cbm-usb-v1.0a-3-sch.png">cbm-usb-v1.0a-3-sch.png</a></td>
</tr>
<tr class="R0"><td><div class="i_schem"> </div></td>
<td><a href="cbm_usb_v1.0a.sch">cbm_usb_v1.0a.sch</a></td>
</tr>
<tr class="R1"><td><div class="i_layout"> </div></td>
<td><a href="cbm-usb-v1.0a-brd.png">cbm-usb-v1.0a-brd.png</a></td>
</tr>
<tr class="R0"><td><div class="i_layout"> </div></td>
<td><a href="cbm_usb_v1.0a.brd">cbm_usb_v1.0a.brd</a></td>
</tr></table>
</div><div class="revend"></div></div></div></div><div id="contentfooter"><p>Last modified: 2013-10-13.</p>
<p>Return to <a href="../../index.html">Homepage</a></p>

</div></div></div><div id="rightcol"><div class="top" id="twitter"><div class="tophead">follow</div><div><p>Follow my 8-bit tweets on
		            <a class="extlink" target="_blank" href="https://mastodon.online/@afachat">Mastodon</a> (In new window)
				or <a class="extlink" target="_blank" href="https://bsky.app/profile/afachat.bsky.social">Bluesky</a></p></div></div><div class="top" id="forum"><div class="tophead">discuss</div><div><p>Discuss my site on <a class="extlink" target="_blank" href="http://forum.6502.org/viewtopic.php?t=956">this 6502.org forum thread</a></p><p>(Forum registration required to post)</p></div></div><div class="top" id="hot"><div class="tophead">hot!</div><div>
<p>Dive into the retro feeling and build yourself a <a href="../../upet/index.html">Micro-PET</a> or a Multi-board <a href="../../cbmhw/ryofat40/index.html">Commodore 4032</a> replica</p>
<p>Need more speed? Speed up your 6502 computer with this <a href="../../pet816/index.html">10&nbsp;MHz 6502 CPU accelerator board</a></p>
<p>Interested in electronics design? Look at the <a href="../../icaphw/design.html">design lesson</a> I got from Bil Herd, the hardware designer of the C128</p>
<p>Want 64bit? - pimp the 6502 with the <a href="../../65k/index.html">65k processor design!</a></p>

		</div></div></div><div id="footer"> </div></div><script type="text/javascript">myUp="../../";</script><script type="text/javascript" src="../../scripts2-all.js"></script></body></html>
