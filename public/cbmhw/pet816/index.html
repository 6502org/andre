<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="author" content="">

<meta name="description" content="">
<meta name="keywords" content="Commodore PET 6502 65816 CPU">
<link rev="made" href="mailto:">
<LINK REL="stylesheet" TITLE="Default" TYPE="text/css" HREF="../../style.css">
<LINK REL="alternate stylesheet" TITLE="Advanced" TYPE="text/css" HREF="../../advanced.css">
<script src="../../jquery-1.4.2.min.js"></script><script src="../../myscripts.js"></script><script>myUp="../../";</script>

<title>Commodore PET 65816 CPU card</title>
</head>
<body><div id="mainbox">
<a name="top"></a><div id="leftcol">
<div id="menu" class="top">
<div class="tophead">navigate</div>
<div id="filter"><form action="#">
<img id="expand" src="../../imgs/expand.png"><img id="collapse" src="../../imgs/collapse.png"><input size="8" name="filter" value="filter" type="text"><img id="cancel" src="../../imgs/cancel.png">
</form></div>
<div id="mtree">
<a class="m_homepage" href="../../index.html">Homepage</a>
<ul class="menu0" >
<li class="separator">Commodore</li>
<li class="dir" id="m_petindex"><img src="../../imgs/dir.png"/><a href="../../petindex/index.html">CBM PETindex</a>
</li>
<li class="dir" id="m_cbmhw"><img src="../../imgs/dir.png"/><a href="../../cbmhw/index.html">CBM hardware and mods</a>
<ul class="menu1" >
<li class="file"><img src="../../imgs/file.png"/><a href="index.html" class="mcurrent">Speed up your PET!</a>

</li>
<li class="dir" id="m_cbmhw_ryofat40"><img src="../../imgs/dir.png"/><a href="../ryofat40/index.html">Build your own PET replica!</a>
</li>
<li class="dir" id="m_cbmhw_ryo1581"><img src="../../imgs/dir.png"/><a href="../ryo1581/index.html">Build your own VC1581 replica!</a>
</li>
<li class="file"><img src="../../imgs/file.png"/><a href="../c64csa/index.html">CS/A adapter for C64</a>
</li>
<li class="file"><img src="../../imgs/file.png"/><a href="../petcsa/index.html">CS/A adapter for PETs</a>
</li>
<li class="file"><img src="../../imgs/file.png"/><a href="../kernal/index.html">C64 kernal modifications</a>
</li>
<li class="file"><img src="../../imgs/file.png"/><a href="../scsi/index.html">CBM SCSI interfaces</a>
</li>
<li class="file"><img src="../../imgs/file.png"/><a href="../ieee488/index.html">IEEE488 interfaces</a>
</li>
<li class="file"><img src="../../imgs/file.png"/><a href="../hwmods.html">My Hardware mods</a></li>
<li class="link"><img src="../../imgs/link.png"/><a href="../../icap/c64ser.html">UART serial interface</a></li>
</ul>
</li>
<li class="separator">Hardware</li>
<li class="dir" id="m_csa"><img src="../../imgs/dir.png"/><a href="../../csa/index.html">CS/A65 Caspaer and Gecko computer</a>
</li>
<li class="dir" id="m_hwinfo"><img src="../../imgs/dir.png"/><a href="../../hwinfo/index.html">ICs and Standards Info</a>
</li>
<li class="dir" id="m_mischw"><img src="../../imgs/dir.png"/><a href="../../mischw/index.html">Other hardware (e.g. tools)</a>
</li>
<li class="separator">Software</li>
<li class="file"><img src="../../imgs/file.png"/><a href="../../osa/index.html">GeckOS operating system</a>
</li>
<li class="file"><img src="../../imgs/file.png"/><a href="../../lib6502/index.html">Lib6502 standard</a>
</li>
<li class="file"><img src="../../imgs/file.png"/><a href="../../o65/index.html">O65 file format</a>
</li>
<li class="file"><img src="../../imgs/file.png"/><a href="../../misc/index.html">Misc software</a>
</li>
<li class="separator">Knowledge Bits</li>
<li class="dir" id="m_icapos"><img src="../../imgs/dir.png"/><a href="../../icapos/index.html">Computer/OS Architecture</a>
</li>
<li class="dir" id="m_icaphw"><img src="../../imgs/dir.png"/><a href="../../icaphw/index.html">6502 Hardware Bits</a>
</li>
<li class="separator">Misc</li>
<li class="file"><img src="../../imgs/file.png"/><a href="../../contact.html">Contact</a></li>
<li class="file"><img src="../../imgs/file.png"/><a href="../../sneak.html">Sneak preview</a></li>
<li class="file"><img src="../../imgs/file.png"/><a href="../../design.html">Web design</a></li>
</ul>

</div>
		</div>
<div class="top" id="browser">
<div class="tophead">browser</div>
<div>
			Site has been tested with a number of browsers and systems. Javascript required for advanced menu, but degrades gracefully without Javascript.
			</div>
</div>
</div>
<div id="rightcol">
<div class="top" id="google">
<div class="tophead">search</div>
<div><form method="get" action="http://www.google.com/search" target="_blank">
<input type="text" name="q" size="10" maxlength="255" value=""><input class="advbutton" type="submit" value="Search my site"><br>(Google, in new window)
	                        <input type="hidden" name="sitesearch" value="www.6502.org/users/andre">
</form></div>
</div>
<div class="top" id="twitter">
<div class="tophead">follow</div>
<div>
		            Follow my 8-bit tweets on<br><a target="_blank" href="http://search.twitter.com/search?q=&amp;ands=&amp;phrase=&amp;ors=&amp;nots=&amp;tag=8bit&amp;lang=all&amp;from=afachat&amp;to=&amp;ref=&amp;near=&amp;within=15&amp;units=mi&amp;since=&amp;until=&amp;rpp=15"><img src="http://twitter-badges.s3.amazonaws.com/twitter-b.png" alt="twitter"></a><br> (In new window)
		</div>
</div>
<div class="top" id="forum">
<div class="tophead">discuss</div>
<div>
<p>Discuss my site on <a class="extlink" target="_blank" href="http://forum.6502.org/viewtopic.php?t=956">this 6502.org forum thread</a></p>
<p>Discuss this page's content on <a class="extlink" target="_blank" href="http://forum.6502.org/viewtopic.php?t=1573"> this 6502.org forum thread</a></p>
<p>(Forum registration required to post)</p>
</div>
</div>
</div>
<div id="midcol">
<DIV class="top" ID="breadcrumbs">
<a href="../../index.html">Homepage</a>
&gt;&gt; <a href="../index.html">CBM hardware and mods</a>&gt;&gt;  Speed up your PET!</DIV>
<div class="top" ID="content">
<H1>Commodore PET 65816 CPU card</H1>

<div class="overview">
<p><p>
			This a PET 65816 CPU card! It speeds up your PET to up to 8MHz.
			In fact it's a 6502 replacement card and could be used in other 6502-based
			computers as well.
			The board uses a 65816 CPU that runs at up to 8MHz, plus a Xilinx CPLD as logic glue. It includes
			up to 1MByte fast RAM (run at CPU speed) plus 512k parallel Flash ROM, that can be used as boot ROM.
	</p>
	<div class="rightimg">
<a href="pet816_8296a.png"><img width="200" src="pet816_8296a_small.png"></a><br>The board installed in a Commodore 8296 
		                </div>	<p>
The interface itself is, in fact, pretty simple. It is a board that is plugged 
in the 6502 CPU socket of the PET. On the board there is the CPU, the CPLD logic, the new clock generator (50MHz), some few support 
parts, as well as two 512k static RAM and one 512k Flash RAM chip. The board is all-through-hole - i.e. no SMD parts! I call that 
a feature in these days.
	</p><p>
		The prototype has been tested with my <a href="../../csa/index.html">CS/A65</a> computer, in the MMU board - which is 
		easier to handle when you have to change things often. But it also now runs in the CBM8296. 
	</p><p>
		The board has been tested with some simple tests. Copying data from slow to fast RAM and back, copying the 
		PET ROM to the fast RAM "under" the ROM and switch to fast mode. Run code in fast RAM.
		One of the test works only in the CS/A board, but still fails in the
		8296 - copying the ROM to the RAM "under" the ROM seems to produce strange results. 
		This is actually due to the fact, that you should not overwrite the 8296's own
		memory configuration register at $fff0...
		Tests with older PETs will follow.
	</p>
	<div class="rightimg">
<a href="pet816_proto.png"><img width="200" src="pet816_proto_small.png"></a><br>The PET816 board 
		</div>	<p>
		As you can see there is still some manual soldering on the 65816 board. In the beginning I had used some 
		wrong driver ICs that only allowed to tri-state the address bus - once I replaced them with 74LS273 registers
		with reset, I didn't have any more problems. I haven't done an updated layout yet, but will do one 
		when I have improved the board more. I'm planning to pull the 74ALS573 high address byte latch into the CPLD, 
		as well as the other support chips.</p>
	</p>
</div>
<h3>News:</h3>
<ul class="news">
<li>
<small>2010-08-14</small>
			New version of the board, now with board layout, and updated VHDL code.
			Explanations still to come though.
		</li>
<li>
<small>2010-04-20</small>
			Published the board.
		</li>
</ul>
<DIV ID="toc">
<h2>Table of content</h2>
<div class="toplink"><a href="#top">Top</a></div>
<dir>
<li><a href="#driver">Driver</a></li>
<dir>
<li><a href="#driver1">Prototype tests</a></li>
<li><a href="#driver2">VHDL code</a></li>
</dir>
<li><a href="#boards">Board Revisions</a></li>
<dir>
<li>
<a href="#board1">1.2b</a> (prototype)</li>
<li>
<a href="#board2">1.2a</a> (prototype)</li>
<li>
<a href="#board3">1.0b</a> (prototype)</li>
</dir>
</dir>
</DIV>
<h2><a name="driver">Driver</a></h2>
<div class="toplink"><a href="#top">Top</a></div>
<H3><A NAME="driver1">Prototype tests</A></H3>
<p><p>Here are some small tests that are compiled with the <code>xa</code> cross assembler, using the <code>-w</code>
				switch to enable 65816 code.</p>
			<div class="rightimg">
<a href="pet816_test2.png"><img width="200" src="pet816_test2_small.png"></a><br>Screen shot of a timing measurement with test2. Note that the slow memory runs the code in <code>$ffff-$fcfb</code> cycles, while the code in fast RAM runs in 
				<code>$ffff-$ff99</code> cycles. The control port is mapped at 60351 in this instance. 
				More measurements and explanations to follow.
		</div>	                </p>
<TABLE class="files">
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_driver.gif" ALT="driver"></TD>
<TD>
<A HREF="test1.a65">test1.a65</A>(Copy system ROM to fast RAM)</TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_driver.gif" ALT="driver"></TD>
<TD>
<A HREF="test2.a65">test2.a65</A>(Execute and time a loop in fast and slow memory)</TD>
</TR>
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_driver.gif" ALT="driver"></TD>
<TD>
<A HREF="test3.a65">test3.a65</A>(Copy 4k memory to fast RAM and back)</TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_driver.gif" ALT="driver"></TD>
<TD>
<A HREF="test4.a65">test4.a65</A>(XOR mirrored system memory with bank 0)</TD>
</TR>
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_logic.gif" ALT="logic"></TD>
<TD>
<A HREF="gtkwave.png">gtkwave.png</A>(Sample screenshot of the timing simulation in the testbench)</TD>
</TR>
</TABLE>
<H3><A NAME="driver2">VHDL code</A></H3>
<p><p>
			This is the VHDL code for the board. It is packaged as the XILINX ISE Webpack (v11.1) directory. Included in this directory is a "testbench" directory with some simulation test runs. Requires Linux with ghdl and GTKWave installed, then look into the Makefile.
		</p></p>
<TABLE class="files">
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_logic.gif" ALT="logic"></TD>
<TD>
<A HREF="PET816_1.7.tar.bz2">PET816_1.7.tar.bz2</A>(Archive of the XILINX ISE Webpack CPLD logic - includes VHDL source, JED binary file, as well as a testbench. )</TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_logic.gif" ALT="logic"></TD>
<TD>
<A HREF="PET816_1.5.tar.bz2">PET816_1.5.tar.bz2</A>(Archive of the XILINX ISE Webpack CPLD logic - includes VHDL source, JED binary file, as well as a testbench. )</TD>
</TR>
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_logic.gif" ALT="logic"></TD>
<TD>
<A HREF="PET816_1.0.tar.bz2">PET816_1.0.tar.bz2</A>(Archive of the XILINX ISE Webpack CPLD logic - includes VHDL source, JED binary file, as well as a testbench. )</TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_logic.gif" ALT="logic"></TD>
<TD>
<A HREF="gtkwave.png">gtkwave.png</A>(Sample screenshot of the timing simulation in the testbench)</TD>
</TR>
</TABLE>
<h2><a name="boards">Board revisions</a></h2>
<div class="toplink"><a href="#top">Top</a></div>
<H3><A NAME="board1">Version: 1.2b</A></H3>
<P>Status: prototype</P>
<H4>Notes</H4>
<TABLE class="notes">
<TR>
<TD class="noteicon"><IMG SRC="../../imgs/note_warn.gif" ALT="warn"></TD>
<TD>
			This board is an update on the 1.2A, and only contains a few small changes:
			Two delay loops that can be used in the VHDL code have been added. Also
			an "official" diagnostics pin has been added too, to get easy access to a 
			signal "exported" from the CPLD.
		</TD>
</TR>
</TABLE>
<H4>Files</H4>
<TABLE class="files">
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_schem.gif" ALT="schem"></TD>
<TD><A HREF="pet_cpu816-v1.2b.sch">pet_cpu816-v1.2b.sch</A></TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_schem.gif" ALT="schem"></TD>
<TD><A HREF="pet_cpu816-v1.2b.brd">pet_cpu816-v1.2b.brd</A></TD>
</TR>
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_layout.gif" ALT="layout"></TD>
<TD><A HREF="pet_cpu816-v1.2b-sch.png">pet_cpu816-v1.2b-sch.png</A></TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_layout.gif" ALT="layout"></TD>
<TD><A HREF="pet_cpu816-v1.2b-brd.png">pet_cpu816-v1.2b-brd.png</A></TD>
</TR>
</TABLE>
<H3><A NAME="board2">Version: 1.2a</A></H3>
<P>Status: prototype</P>
<H4>Notes</H4>
<TABLE class="notes">
<TR>
<TD class="noteicon"><IMG SRC="../../imgs/note_warn.gif" ALT="warn"></TD>
<TD>
			This board has been only barely tested
		</TD>
</TR>
</TABLE>
<H4>Files</H4>
<TABLE class="files">
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_schem.gif" ALT="schem"></TD>
<TD><A HREF="pet_cpu816-v1.2a.sch">pet_cpu816-v1.2a.sch</A></TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_schem.gif" ALT="schem"></TD>
<TD><A HREF="pet_cpu816-v1.2a.brd">pet_cpu816-v1.2a.brd</A></TD>
</TR>
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_layout.gif" ALT="layout"></TD>
<TD><A HREF="pet_cpu816-v1.2a-sch.png">pet_cpu816-v1.2a-sch.png</A></TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_layout.gif" ALT="layout"></TD>
<TD><A HREF="pet_cpu816-v1.2a-brd.png">pet_cpu816-v1.2a-brd.png</A></TD>
</TR>
</TABLE>
<H3><A NAME="board3">Version: 1.0b</A></H3>
<P>Status: prototype</P>
<H4>Notes</H4>
<TABLE class="notes">
<TR>
<TD class="noteicon"><IMG SRC="../../imgs/note_warn.gif" ALT="warn"></TD>
<TD>
			This board has been only barely tested
		</TD>
</TR>
</TABLE>
<H4>Files</H4>
<TABLE class="files">
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_schem.gif" ALT="schem"></TD>
<TD><A HREF="pet_cpu816-v1.0b.sch">pet_cpu816-v1.0b.sch</A></TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_schem.gif" ALT="schem"></TD>
<TD><A HREF="pet_cpu816-v1.0b-sch.png">pet_cpu816-v1.0b-sch.png</A></TD>
</TR>
</TABLE>
<h2>Disclaimer</h2>
<div class="toplink"><a href="#top">Top</a></div>
All Copyrights are acknowledged.
The information here is provided under the terms of the
GNU Public License version 2 unless noted otherwise.
<div ID="footer">
<P>Last modified: 2010-08-14.</P>
<p>Return to <a href="../../index.html">Homepage</a></p>

</div>
</div>
</div>
</div></body>
</html>
