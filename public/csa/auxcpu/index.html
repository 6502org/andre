<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<META NAME="keywords" CONTENT="CSA65 6502 CPU">
<TITLE>CS/A65 Auxiliary CPU</TITLE>
<LINK REL="stylesheet" TITLE="Default" TYPE="text/css" HREF="../../style.css">
<LINK REL="alternate stylesheet" TITLE="Advanced" TYPE="text/css" HREF="../../advanced.css">
</HEAD>
<BODY>
<DIV ID="menu">
<ul><li class=homepage><a href=../../index.html>Homepage</a></li>
<ul class="menu0" >
<li class="separator">Commodore</li>
<li class="dir"><a href="../../petindex/index.html">CBM PETindex</a></li>
<li class="dir"><a href="../../cbmhw/index.html">CBM hardware and mods</a></li>
<li class="separator">Hardware</li>
<li class="dir"><a href="../../csa/index.html">CS/A65 Caspaer and Gecko computer</a></li>
<ul class="menu1" >
<li class="file"><a href="../memmap.html">Memory Map</a></li>
<li class="separator">Specifications</li>
<li class="file"><a href="../bus.html">Bus V1.0</a></li>
<li class="file"><a href="../bus-1.1.html">Bus V1.1</a></li>
<li class="separator">Main boards</li>
<li class="dir"><a href="../cpu/index.html">CS/A65 CPU</a></li>
<li class="dir"><a href="../bios/index.html">CS/A65 BIOS </a></li>
<li class="dir"><a href="../cpu816/index.html">65816 CPU V1</a></li>
<li class="file"><a href="../cpu816/indexv2.html">65816 CPU V2</a></li>
<li class="dir"><a href="../petcpu/index.html">64k PET CPU</a></li>
<li class="dir"><a href="../gecko/index.html">Gecko</a></li>
<li class="dir"><a href="../auxcpu/index.html">Auxiliary CPU</a></li>

<li class="dir"><a href="../pwr/index.html">Power Supply</a></li>
<li class="separator">I/O boards</li>
<li class="dir"><a href="../vdc/index.html">Video board</a></li>
<li class="dir"><a href="../petio/index.html">CBM PET I/O</a></li>
<li class="dir"><a href="../shug/index.html">PC floppy</a></li>
<li class="dir"><a href="../drvio/index.html">DRVIO floppy and IEC</a></li>
<li class="dir"><a href="../duart/index.html">Double UART (RS232)</a></li>
<li class="dir"><a href="../scsi/index.html">SCSI/I2C board</a></li>
<li class="dir"><a href="../spi/index.html">MMC/SD-Card</a></li>
<li class="separator">Special purpose</li>
<li class="dir"><a href="../ramdisk/index.html">SIMM RAMDisk</a></li>
<li class="dir"><a href="../copro/index.html">Coprocessor board</a></li>
<li class="dir"><a href="../cpuemu/index.html">Emulate a 6502</a></li>
<li class="dir"><a href="../keyemu/index.html">Emulate a keyboard</a></li>
<li class="dir"><a href="../viaproto/index.html">VIA prototyping</a></li>
<li class="separator">Deprecated boards</li>
<li class="dir"><a href="../cpu65b/index.html">64k CPU</a></li>
<li class="dir"><a href="../key/index.html">Keyboard and RS232</a></li>
<li class="dir"><a href="../iec/index.html">IEEE488 and CBM IEC</a></li>
<li class="separator">Other links</li>
<li class="dir"><a href="../gallery/index.html">Gallery</a></li>
<li class="dir"><a href="../emu/index.html">VICE emu of CS/A65</a></li>
<li class="link"><a href="../../cbmhw/c64csa/index.html">C64 CS/A adapter</a></li>
</ul>
<li class="dir"><a href="../../hwinfo/index.html">ICs and Standards Info</a></li>
<li class="dir"><a href="../../mischw/index.html">Other hardware (e.g. tools)</a></li>
<li class="separator">Software</li>
<li class="dir"><a href="../../osa/index.html">GeckOS operating system</a></li>
<li class="dir"><a href="../../lib6502/index.html">Lib6502 standard</a></li>
<li class="dir"><a href="../../o65/index.html">O65 file format</a></li>
<li class="dir"><a href="../../misc/index.html">Misc software</a></li>
<li class="separator">Knowledge Bits</li>
<li class="dir"><a href="../../icapos/index.html">Computer/OS Architecture</a></li>
<li class="dir"><a href="../../icaphw/index.html">6502 Hardware Bits</a></li>
<li class="separator">Misc</li>
<li class="file"><a href="../../contact.html">Contact</a></li>
</ul>
</ul>
</DIV>
<DIV ID="content">
<H1>CS/A65 Auxiliary CPU</H1>

<p><p>This board implements an auxiliary processor for the
		CS/A65 bus system. The auxiliary CPU watches the bus 
		error conditions signaled via the NOEXEC (no execution allowed,
		which is checked with the CPU's SYNC line), WPROT (write protection)
		and NOTMAPD (page not mapped) lines, and in such a case takes over the bus
		to resolve the problem.
		</p><p>
		The auxiliary CPU does not have a full MMU, and
		it does not have own memory either. It uses
		32k on the bus for the top and bottom
		16k of its address space. Two areas of 4k can be mapped 
		similar to the
		MMU, and two areas of 4k are set for the bus I/O and the 
		secondary bus I/O.
		</p><p>
		The auxiliary board has a separate bus socket where
		another CS/A65 I/O board can be plugged in that the 
		processor can handle independently from the bus I/O.
		</p>
	</p>
<h3>News:</h3>
<ul class="news"><li>
<small>2006-12-27</small>
                        Published the board.
                </li></ul>
<DIV ID="toc">
<H2>Table of content</H2>
<dir>
<li><a href="#driver">Driver</a></li>
<dir><li><a href="#driver1">AUXCPU test suite</a></li></dir>
<li><a href="#boards">Board Revisions</a></li>
<dir>
<li>
<a href="#board1">1.0C</a> (ok)</li>
<li>
<a href="#board2">1.0B</a> (prototype with bugs)</li>
</dir>
</dir>
</DIV>
<H2><A NAME="driver">Driver</A></H2>
<H3><A NAME="driver1">AUXCPU test suite</A></H3>
<p><p>This test suite contains nine tests that for the
			auxcpu board:
			</p><p>
			The tests run in a <a href="../index.html#caspaer">Caspaer</a> setup, but with Commodore PET ROMs, as described in <a href="../../cbmhw/ryofat40/index.html">Roll-Your-Own-Fat40</a>.
			This way the operating system does not fiddle around
			with the MMU registers necessary for the test.
                        </p>
			<ul>
			<li>auxcpu1: Tests basic functionality. Loads a program
				for the auxcpu, and starts it with the "external trigger"
				functionality. Auxcpu flashes the BIOS board LED
				and the DRVIO LEDs if the DRVIO board is plugged into
				the secondary bus of the auxcpu. Does not give control
				back to the maincpu.</li>
			<li>auxcpu2: Same as auxcpu1, only instead of static RAM from
				the BIOS board, uses dRAM from the VDC board, to
				see if the timing is ok there too.</li>
			<li>auxcpu3: blinks the LEDs as well, but after each flash the
				control is given back to the maincpu that does the 
				actual wait loop until triggering the next flash in 
				the auxcpu.</li>
			<li>auxcpu4: Tests the write protect (WPROT) handling. Maps a page
				as write protected, and writes to it. The auxcpu prints
				the fault address on the screen.</li>
			<li>auxcpu4a: Same as auxcpu4, only that the screen memory 
				is mapped using not the MAPRAM, but MAP0 register.</li>
			<li>auxcpu5: Tests the NOEXEC handling. Maps a page
				as NOEXEC, and jumps to it. The auxcpu prints
				the fault address on the screen and lets the maincpu return.</li>
			<li>auxcpu6: Tests the "not mapped" handling. Maps a page
				as not mapped, and reads it. The auxcpu prints
				the fault address on the screen.</li>
			<li>auxcpu7: Combines NOEXEC, WPROT, and NOTMAPD handling Maps a page
				as not mapped, no execute, and write protected, and accesses it. 
				The auxcpu prints the fault address on the screen.</li>
			<li>auxcpu8: Tests the trace feature. Enables trace and prints the next
				five opcode addresses and opcodes on the screen.
				</li>
			<li>auxcpu9: Same as auxcpu7, only that the auxcpu also triggers
				an intterupt for the maincpu.</li>
			</ul>
                </p>
<TABLE class="files">
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_driver.gif" ALT="driver"></TD>
<TD><A HREF="auxcpu.tar.gz">auxcpu.tar.gz</A></TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_photo.gif" ALT="photo"></TD>
<TD>
<A HREF="trace.jpg">trace.jpg</A>(Sample trace output (The first poke is specific for my setup - I'm still using an old charrom - you can ignore it))</TD>
</TR>
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_memmap.gif" ALT="memmap"></TD>
<TD>
<A HREF="memsetup.gif">memsetup.gif</A>(This shows the memory mapping used in the test cases.)</TD>
</TR>
</TABLE>
<H2><A NAME="boards">Board revisions</A></H2>
<H3><A NAME="board1">Version: 1.0C</A></H3>
<P>Status: ok</P>
<H4>Notes</H4>
<TABLE class="notes">
<TR>
<TD class="noteicon"><IMG SRC="../../imgs/note_warn.gif" ALT="warn"></TD>
<TD>
			In this board the schematics has been tested, the layout has not been tested, though.
		</TD>
</TR>
<TR>
<TD class="noteicon"><IMG SRC="../../imgs/note_msg.gif" ALT="msg"></TD>
<TD>
			This board has been tested in a test 
			setup. The driver above contains the test
			programs.
		</TD>
</TR>
<TR>
<TD class="noteicon"><IMG SRC="../../imgs/note_msg.gif" ALT="msg"></TD>
<TD>
			The board itself consists of two boards, where
			the smaller one is piggy-backed on top of the
			main Euro-card-sized board. The smaller one
			is called the "addon" board.
		</TD>
</TR>
<TR>
<TD class="noteicon"><IMG SRC="../../imgs/note_msg.gif" ALT="msg"></TD>
<TD>
			The two timing diagrams show the timing of various signals on
			the schematics during the operation. They should help in understanding the
			boards.
		</TD>
</TR>
<TR>
<TD class="noteicon"><IMG SRC="../../imgs/note_msg.gif" ALT="msg"></TD>
<TD>Please note that it still uses the v1.0b version of the addon board.
		</TD>
</TR>
</TABLE>
<H4>Files</H4>
<TABLE class="files">
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_desc.gif" ALT="desc"></TD>
<TD><A HREF="csaauxcpudesc-v1.0c.txt">csaauxcpudesc-v1.0c.txt</A></TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_schem.gif" ALT="schem"></TD>
<TD><A HREF="csa_auxcpu-v1.0c-sch.png">csa_auxcpu-v1.0c-sch.png</A></TD>
</TR>
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_schem.gif" ALT="schem"></TD>
<TD><A HREF="csa_auxcpu-v1.0c.sch">csa_auxcpu-v1.0c.sch</A></TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_schem.gif" ALT="schem"></TD>
<TD>
<A HREF="csa_auxcpu_addon-v1.0b-sch.png">csa_auxcpu_addon-v1.0b-sch.png</A>(The addon board)</TD>
</TR>
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_schem.gif" ALT="schem"></TD>
<TD>
<A HREF="csa_auxcpu_addon-v1.0b.sch">csa_auxcpu_addon-v1.0b.sch</A>(The addon board)</TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_layout.gif" ALT="layout"></TD>
<TD><A HREF="csa_auxcpu-v1.0c-brd.png">csa_auxcpu-v1.0c-brd.png</A></TD>
</TR>
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_layout.gif" ALT="layout"></TD>
<TD><A HREF="csa_auxcpu-v1.0c.brd">csa_auxcpu-v1.0c.brd</A></TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_layout.gif" ALT="layout"></TD>
<TD>
<A HREF="csa_auxcpu_addon-v1.0b-brd.png">csa_auxcpu_addon-v1.0b-brd.png</A>(The addon board)</TD>
</TR>
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_layout.gif" ALT="layout"></TD>
<TD>
<A HREF="csa_auxcpu_addon-v1.0b.brd">csa_auxcpu_addon-v1.0b.brd</A>(The addon board)</TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_photo.gif" ALT="photo"></TD>
<TD>
<A HREF="auxcpubrds.jpg">auxcpubrds.jpg</A>(The complete auxcpu board.)</TD>
</TR>
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_photo.gif" ALT="photo"></TD>
<TD>
<A HREF="auxcpubrds-separate.jpg">auxcpubrds-separate.jpg</A>(The two auxcpucessor boards.)</TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_timing.gif" ALT="timing"></TD>
<TD>
<A HREF="timing1.jpg">timing1.jpg</A>(Timing sheet 1)</TD>
</TR>
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_timing.gif" ALT="timing"></TD>
<TD>
<A HREF="timing2.jpg">timing2.jpg</A>(Timing sheet 2)</TD>
</TR>
</TABLE>
<H3><A NAME="board2">Version: 1.0B</A></H3>
<P>Status: prototype with bugs</P>
<H4>Notes</H4>
<TABLE class="notes">
<TR>
<TD class="noteicon"><IMG SRC="../../imgs/note_warn.gif" ALT="warn"></TD>
<TD>
<p>
			The following bugs have been found:
			<ul>
			<li>The address selection goes to $e8d*/e8f* instead of $e85*/e87*</li>
			<li>The /MEMSEL and /IOSEL lines on IC1 are messed up.</li>
			<li>There is no interrupt generation feature.</li>
			</ul>
			It seems that over checking and fixing the timing generation I forgot to check
			the more trivial parts. The complicated parts all worked out of the box... :-)
			</p>
		</TD>
</TR>
<TR>
<TD class="noteicon"><IMG SRC="../../imgs/note_msg.gif" ALT="msg"></TD>
<TD>
			This board has been tested in a test 
			setup. The driver above contains the test
			programs.
		</TD>
</TR>
<TR>
<TD class="noteicon"><IMG SRC="../../imgs/note_msg.gif" ALT="msg"></TD>
<TD>
			The board itself consists of two boards, where
			the smaller one is piggy-backed on top of the
			main Euro-card-sized board. The smaller one
			is called the "addon" board.
		</TD>
</TR>
</TABLE>
<H4>Files</H4>
<TABLE class="files">
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_schem.gif" ALT="schem"></TD>
<TD><A HREF="csa_auxcpu-v1.0b-sch.png">csa_auxcpu-v1.0b-sch.png</A></TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_schem.gif" ALT="schem"></TD>
<TD><A HREF="csa_auxcpu-v1.0b.sch">csa_auxcpu-v1.0b.sch</A></TD>
</TR>
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_schem.gif" ALT="schem"></TD>
<TD>
<A HREF="csa_auxcpu_addon-v1.0b-sch.png">csa_auxcpu_addon-v1.0b-sch.png</A>(The addon board)</TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_schem.gif" ALT="schem"></TD>
<TD>
<A HREF="csa_auxcpu_addon-v1.0b.sch">csa_auxcpu_addon-v1.0b.sch</A>(The addon board)</TD>
</TR>
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_layout.gif" ALT="layout"></TD>
<TD><A HREF="csa_auxcpu-v1.0b-brd.png">csa_auxcpu-v1.0b-brd.png</A></TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_layout.gif" ALT="layout"></TD>
<TD><A HREF="csa_auxcpu-v1.0b.brd">csa_auxcpu-v1.0b.brd</A></TD>
</TR>
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_layout.gif" ALT="layout"></TD>
<TD>
<A HREF="csa_auxcpu_addon-v1.0b-brd.png">csa_auxcpu_addon-v1.0b-brd.png</A>(The addon board)</TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_layout.gif" ALT="layout"></TD>
<TD>
<A HREF="csa_auxcpu_addon-v1.0b.brd">csa_auxcpu_addon-v1.0b.brd</A>(The addon board)</TD>
</TR>
<TR CLASS="R1">
<TD><IMG SRC="../../imgs/file_photo.gif" ALT="photo"></TD>
<TD>
<A HREF="auxcpubrds.jpg">auxcpubrds.jpg</A>(The complete auxcpu board.)</TD>
</TR>
<TR CLASS="R0">
<TD><IMG SRC="../../imgs/file_photo.gif" ALT="photo"></TD>
<TD>
<A HREF="auxcpubrds-separate.jpg">auxcpubrds-separate.jpg</A>(The two auxcpucessor boards.)</TD>
</TR>
</TABLE>
<DIV ID="footer">
<P>Last modified: 2006-12-30.</P>
<p>Return to <a href="../../index.html">Homepage</a></p>

</DIV>
</DIV>
</BODY>
</HTML>
