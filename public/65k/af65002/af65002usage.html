<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
<meta name="author" content="">

<meta name="description" content="65002 application notes">
<meta name="keywords" content="8-bit,6502,65002">
<link rev="made" href="mailto:">
<link rel="stylesheet" title="Default" type="text/css" href="../../style2-min.css">
<title>6502 Software Application and Usage Notes</title></head>
<body><div id="mainbox"><a name="top"></a><div id="topsearch"><form method="get" action="http://www.google.com/search" target="_blank" autocomplete="off"><input alt="search" name="q" size="10" maxlength="255" type="text"><input class="advbutton" value="Search site" type="submit"><div id="srchprov">(by Google)</div><input name="sitesearch" value="www.6502.org/users/andre" type="hidden"></form><div id="topfind"><div id="topprogress"></div></div></div><div id="menubox">



<div id="menu1" class="mclose">
<div id="twist1" class="twisty"></div>
<div class="hdrtxt"><a href="../../index.html">Home&nbsp;&gt;</a></div>
<ul class="nav1">
<li>
<ul class="nav2">
<li class="navhdr"><a href="../../index.html">Home</a></li>
<li><a href="../../contact.html">Contact</a></li>
<li><a href="../../design.html">Web design</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Hardware</span></li>
<li><ul class="nav2" >
<li><a href="../../65k/index.html">The 65k Project</a>
</li>
<li><a href="../../pet816/index.html">PET816 Accelerator</a>
</li>
<li><a href="../../csa/index.html">CS/A65</a>
</li>
<li><a href="../../cbmhw/index.html">CBM mods</a>
</li>
<li><a href="../../spi65b/index.html">SPI65B</a>
</li>
<li><a href="../../mischw/index.html">Other hardware</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Software</span></li>
<li><ul class="nav2" >
<li><a href="../../osa/index.html">GeckOS</a>
</li>
<li><a href="../../lib6502/index.html">lib6502 </a>
</li>
<li><a href="../../o65/index.html">o65</a>
</li>
<li><a href="../../usb65/index.html">usb65</a>
</li>
<li><a href="../../xd2031/index.html">XD2031</a>
</li>
<li><a href="../../misc/index.html">Misc</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Library</span></li>
<li><ul class="nav2" >
<li><a href="../../petindex/index.html">PETindex</a>
</li>
<li><a href="../../petindex/drives/index.html">PET drives</a>
</li>
<li><a href="../../adv65/index.html">Advanced 6502</a>
</li>
<li><a href="../../hwinfo/index.html">ICs and Standards</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Knowledge Bits</span></li>
<li><ul class="nav2" >
<li><a href="../../icapos/index.html">Computer/OS Architecture</a>
</li>
<li><a href="../../icaphw/index.html">6502 Hardware Bits</a>
</li>
<li><a href="../../emulation/index.html">Emulation</a>
</li>
</ul>
<div class="nend2"></div>
</li>
<div class="nend1"></div>
</ul>
</div>
<div id="menu2" class="mclose">
<div id="twist2" class="twisty"></div>
<div class="hdrtxt"><a href="../index.html">The 65k Project&nbsp;&gt;</a></div>
<ul class="nav1">
<li>
<ul class="nav2">
<li class="navhdr"><a href="../index.html">The 65k Project</a></li>
<li><a href="../features.html">Feature Outline</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Specification</span></li>
<li><ul class="nav2" >
<li><a href="../specsprog.html">Programming Model</a></li>
<li><a href="../future.html">Future Extensions</a></li>
<li><a href="../af65002">&gt;65002</a></li>
<li><a href="../designnotes.html">Design Notes</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Tools</span></li>
<li><ul class="nav2" >
<li><a href="../crossass.html">Cross-Assembler</a></li>
<li><a href="../nativetools.html">Native Tools</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Implementation</span></li>
<li><ul class="nav2" >
<li><a href="../arch.html">General architecture</a></li>
<li><a href="../af65002/index.html">af65002 </a>
</li>
<li><a href="../tests.html">Test setup</a></li>
</ul>
<div class="nend2"></div>
</li>
<div class="nend1"></div>
</ul>
</div>
<div id="menu3" class="mopen">
<div id="twist3" class="twisty"></div>
<div class="hdrtxt"><a href="index.html">af65002&nbsp;&gt;</a></div>
<ul class="nav1">
<li>
<ul class="nav2">
<li class="navhdr"><a href="index.html">af65002</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Specification</span></li>
<li><ul class="nav2" >
<li><a href="af65002front.html">Overview</a></li>
<li><a href="af65002regs.html">Register Set</a></li>
<li><a href="af65002opstruct.html">Opcode Structure</a></li>
<li><a href="af65002admodes.html">Addressing Modes</a></li>
<li><a href="af65002prefixes.html">Prefixes</a></li>
<li><a href="af65002opcodes.html">Opcodes Overview</a></li>
<li><a href="af65002opdesc.html">Opcode Description</a></li>
<li><a href="af65002int.html">Reset, Traps and Interrupts</a></li>
<li><a href="af65002hyper.html">User- and Hypervisor Mode</a></li>
<li><a href="af65002mem.html">Memory Management</a></li>
<li><a href="af65002config.html">Configuration Registers</a></li>
<li><a href="af65002compat.html">Compatibility</a></li>
<li><a href="af65002usage.html">Usage notes</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Implementation</span></li>
<li><ul class="nav2" >
<li><a href="af65002arch.html">Architecture Overview</a></li>
</ul>
<div class="nend2"></div>
</li>
<div class="nend1"></div>
</ul>
</div>
	</div><div id="midcol"><div class="top" id="content"><div id="minmax"></div>

<h1>6502 Software Application and Usage Notes</h1><div class="overview">
	<p>
        Here are some notes on how to implement certain functionalities or use cases 
	with the new 65k features available.
	</p>
  </div><div class="h2"><div class="h2h"><div class="h2t">&nbsp;</div><h2><a name="news">News:</a></h2></div><div class="h2c"><ul class="news"><li><div>&nbsp;</div><small>2013-11-17</small>
	Started this page to show how to efficiently use the new features.
     </li></ul></div></div><div id="toc" class="h2"><div class="h2h"><div class="h2t">&nbsp;</div><h2>Table of content</h2></div><div class="h2c"><ul><li><a href="#localglobalstatic">Accessing local, static and global variables</a></li></ul></div></div><div class="h2"><div class="h2h"><div class="h2t">&nbsp;</div><h2><a name="localglobalstatic">Accessing local, static and global variables</a></h2></div><div class="h2c"><p>
		The idea of the B register, together with the stack-/PC- and B-relative addressing
		modes comes from this use case: how do I access local, static and global variables?
		(static in the Java sense - local to a class, i.e. all instances at the same time)
	</p><p>
		The idea behind is that:
	</p>
	<ul>
		<li>The stack contains local variables, i.e. variables available to this thread only.
		  The code would look about this:
<pre>
	.(		; start of subroutine
	SBS #20		; make place for local variables
	STA (S,0)	; use values on stack with stack-relative addressing
	...
	ADS #20		; clean up stack
	RTS
	.)
</pre>
		</li>
		<li>The B-register would point to a parameter block. This would be the parameters
		  for the method. Variables there would be accessed by
<pre>
	...
	LDA (B,12)	; load parameter
	...
</pre>
		</li>
		<li>The code itself is compiled to a specific address, and "static" variables
		  belonging to this code are compiled into a fixed offset (or one that is adjusted
		  ad load time). So variables accessible to all threads running this code could use:
<pre>
	...
	LDA (P,10)	; load shared variable
	...
</pre>
		</li>
		<li>Finally, global variables can be accessed via non-offset addresses as ususal:
<pre>
	...
	LDA $1234
	...
</pre>
		</li>
	</ul>
        </div></div><div class="h2"><div class="h2h"><div class="h2t">&nbsp;</div><h2>Disclaimer</h2></div><div class="h2c">
All Copyrights are acknowledged.
The information here is provided under the terms as described
in <a href="af65002front.html#lic">the license section</a>.
    </div></div><hr>
Last updated 2013-11-17.
  Last modified: 
2013-11-17
	</div></div><div id="rightcol"><div class="top" id="share"><div class="tophead">share</div><div><div id="socialshareprivacy"></div></div></div><div class="top" id="twitter"><div class="tophead">follow</div><div><p>Follow my 8-bit tweets on
		            <a class="extlink" target="_blank" href="https://twitter.com/#!/search/realtime/afachat%20%238bit">Twitter</a> (In new window)</p></div></div><div class="top" id="forum"><div class="tophead">discuss</div><div><p>Discuss my site on <a class="extlink" target="_blank" href="http://forum.6502.org/viewtopic.php?t=956">this 6502.org forum thread</a></p><p>(Forum registration required to post)</p></div></div><div class="top" id="hot"><div class="tophead">hot!</div><div>
<p>Dive into the retro feeling and build yourself a <a href="../../cbmhw/ryofat40/index.html">Commodore PET replica</a></p>
<p>Need more speed? Speed up your 6502 computer with this <a href="../../pet816/index.html">10&nbsp;MHz 6502 CPU accelerator board</a></p>
<p>Interested in electronics design? Look at the <a href="../../icaphw/design.html">design lesson</a> I got from Bil Herd, the hardware designer of the C128</p>
<p>Want 64bit? - pimp the 6502 with the <a href="../../65k/index.html">65k processor design!</a></p>

		</div></div></div><div id="footer">&nbsp;</div></div><script type="text/javascript">myUp="../../";</script><script type="text/javascript" src="../../scripts2-all.js"></script><script type="text/javascript" src="../../jquery.socialshareprivacy.min.js"></script></body></html> 
