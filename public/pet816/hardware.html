<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
<meta name="author" content="Andr&eacute;  Fachat">

<meta name="description" content="Commodore PET 65816 CPU replacement board explained">
<meta name="keywords" content="Commodore PET 6502 65816 cpu replacement board">
<link rev="made" href="mailto:afachat@gmx.de">
<link rel="stylesheet" title="Default" type="text/css" href="../../style2-min.css">
<title>65816 board hardware</title></head>
<body><div id="mainbox"><a name="top"></a><div id="topsearch"><form method="get" action="http://www.google.com/search" target="_blank" autocomplete="off"><input alt="search" name="q" size="10" maxlength="255" type="text"><input class="advbutton" value="Search site" type="submit"><div id="srchprov">(by Google)</div><input name="sitesearch" value="www.6502.org/users/andre" type="hidden"></form><div id="topfind"><div id="topprogress"></div></div></div><div id="menubox">



<div id="menu1" class="mclose">
<div id="twist1" class="twisty"></div>
<div class="hdrtxt"><a href="../../index.html">Home&nbsp;&gt;</a></div>
<ul class="nav1">
<li>
<ul class="nav2">
<li class="navhdr"><a href="../../index.html">Home</a></li>
<li><a href="../../contact.html">Contact</a></li>
<li><a href="../../design.html">Web design</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Hardware</span></li>
<li><ul class="nav2" >
<li><a href="../../65k/index.html">The 65k Project</a>
</li>
<li><a href="../../csa/index.html">CS/A65</a>
</li>
<li><a href="../../cbmhw/index.html">CBM mods</a>
</li>
<li><a href="../../spi65b/index.html">SPI65B</a>
</li>
<li><a href="../../mischw/index.html">Other hardware</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Software</span></li>
<li><ul class="nav2" >
<li><a href="../../osa/index.html">GeckOS</a>
</li>
<li><a href="../../lib6502/index.html">lib6502 </a>
</li>
<li><a href="../../o65/index.html">o65</a>
</li>
<li><a href="../../usb65/index.html">usb65</a>
</li>
<li><a href="../../xd2031/index.html">XD2031</a>
</li>
<li><a href="../../misc/index.html">Misc</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Library</span></li>
<li><ul class="nav2" >
<li><a href="../../petindex/index.html">PETindex</a>
</li>
<li><a href="../../adv65/index.html">Advanced 6502</a>
</li>
<li><a href="../../hwinfo/index.html">ICs and Standards</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Knowledge Bits</span></li>
<li><ul class="nav2" >
<li><a href="../../icapos/index.html">Computer/OS Architecture</a>
</li>
<li><a href="../../icaphw/index.html">6502 Hardware Bits</a>
</li>
<li><a href="../../emulation/index.html">Emulation</a>
</li>
</ul>
<div class="nend2"></div>
</li>
<div class="nend1"></div>
</ul>
</div>
<div id="menu2" class="mclose">
<div id="twist2" class="twisty"></div>
<div class="hdrtxt"><a href="../index.html">Advanced 6502&nbsp;&gt;</a></div>
<ul class="nav1">
<li>
<ul class="nav2">
<li class="navhdr"><a href="../index.html">Advanced 6502</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Mine</span></li>
<li><ul class="nav2" >
<li><a href="../../65k/index.html">&gt;The 65k Project</a></li>
<li><a href="../pet816/index.html">Speed up your 6502!</a>
</li>
<li><a href="../../csa/index.html">&gt;CS/A65</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Others</span></li>
<li><ul class="nav2" >
<li><a href="../65net.html">6502 networking</a></li>
</ul>
<div class="nend2"></div>
</li>
<div class="nend1"></div>
</ul>
</div>
<div id="menu3" class="mopen">
<div id="twist3" class="twisty"></div>
<div class="hdrtxt"><a href="index.html">PET816 Accelerator&nbsp;&gt;</a></div>
<ul class="nav1">
<li>
<ul class="nav2">
<li class="navhdr"><a href="index.html">PET816 Accelerator</a></li>
<li><a href="features.html">Board Features</a></li>
<li><a href="works.html">How it works</a></li>
<li><a href="gallery.html">PET816 Gallery</a></li>
<li><a href="hardware.html">Hardware</a></li>
</ul>
<div class="nend2"></div>
</li>
<div class="nend1"></div>
</ul>
</div>
	</div><div id="midcol"><div class="top" id="content"><div id="minmax"></div>

<h1>65816 board hardware</h1><p class="copyright">(C)
2010-2010 Andr&eacute;  Fachat</p> 
<div class="overview">
	<p>This page describes the hardware of the 65816 board.
	</p>
  </div><div id="toc" class="h2"><div class="h2h"><div class="h2t">&nbsp;</div><h2>Table of content</h2></div><div class="h2c"><ul><li><a href="#structure">Hardware Design</a></li><li style="list-style-type:none;"><ul><li><a href="#cpu">CPU domain</a></li><li><a href="#sys">System domain</a></li><li><a href="#buf">Buffers</a></li></ul></li><li><a href="#ics">ICs</a></li><li><a href="#jumpers">Jumpers and Connectors</a></li></ul></div></div><div class="h2"><div class="h2h"><div class="h2t">&nbsp;</div><h2><a name="structure">Hardware Design</a></h2></div><div class="h2c"><p>In this section I describe the hardware design.</p>
<div class="rightimg"><a href="imgs/diagram.gif"><img width="300px" src="imgs/diagram.gif"></a><br>The board design overview (click to enlarge) </div>
	<p>The board is actually quite simple. It has a CPU domain, with the CPU, RAM and ROM (incl. 
	the '573 bank byte latch). It has a system domain, with the connection that goes into the
	6502 socket on the system, and the '688 address decoder. And it has the address and data bus
	drivers that connect them, plus the CPLD glue logic.
	</p><h3><a name="cpu">CPU domain</a></h3><p>The CPU domain actually is an own computer in itself, only that it lacks I/O capabilities. It has a ROM to store the program, plus RAM to actually work in it.
	The '573 is the usual bank byte latch used for the 65816. You could actually 
	be moving this into the CPLD without board change, if the CPLD has enough space. The CPLD 
	already has the 8 data lines, and you have to redefine the three address lines
	<code>A16-A18</code> as output instead of input to the CPLD.
	</p><h3><a name="sys">System domain</a></h3><p>The system domain only has the 6502 connector and the '688 address decoder.
	The address decoder is actually used to decode the address of the CPLD's 
	clock and control register, and to reduce the number of input pins needed on the CPLD.</p><h3><a name="buf">Buffers</a></h3><p>
	The buffers are used to decouple the slow system bus from the fast CPU bus. When the CPU
	does not need the system bus, it sets the buffers to read from system bus address zero.
	In fact the CPLD makes the address and R/-W only change exactly once a slow cycle.
	Either the address is set to the CPU address when a (slow) system access is performed,
	or zero, when the slow bus is not needed (as the CPU is running on fast clock).
	</p></div></div><div class="h2"><div class="h2h"><div class="h2t">&nbsp;</div><h2><a name="ics">ICs</a></h2></div><div class="h2c"><p>Looking at the board <a href="pet_cpu816-v1.2b-brd.png">layout</a> you can see that
	of course it has the 65816 CPU, but also 2 RAM ICs with 512k each, and a socket for a
	ROM chip of between 32k and 512k. A 50MHz oscillator gives the clocks.
	Also the board has three driver ICs (2 '273, 1 '245), one latch (a '573), and a comparator (a '688).
	The main glue of the board is of course the Xilinx CPLD. The functionality of this IC is not 
	fixed, but can be programmed using VHDL for example, a hardware description logic. It
	can contain the equivalent of a whole eurocard of standard logic ICs (depending on the ICs...)
	</p>
	<p>In the <a href="imgs/diagram.gif">block diagram</a> you can see how these ICs fit together.</p>
	<p>The two RAM chips of course implement the 1MByte RAM. The ROM is in-place-programmable
	(when using the correct Flash-PROM that is - I am currently using an Atmel 29C010 128k PROM).
	</p><p>
	The '573 is the "usual" latch to capture the upper 8 address bits A16-A23 from the
	65816's data bus during phi1. It is controlled by the CPLD to be transparent during phi1, 
	then latch the value and hold it constant during phi2.
	</p><p>
	The '273s implement the address driver between the 65816 bus and the slow system bus (the
	6502 connector). This has to be a '273 as this is the only IC that has a reset line to 
	set all outputs to low. I use this to read from address 0 as long as the CPU works in the
	on-board RAM or ROM.
	</p><p>
	The '245 is the data bus driver. It decouples the 65816 and the system data bus. 
	</p><p>
	The '688 finally is an address selector for address lines A4-A11 on the system bus.
	It is used to select two addresses in the I/O range for the CPLD's control and clock
	registers.
	</p>
	</div></div><div class="h2"><div class="h2h"><div class="h2t">&nbsp;</div><h2><a name="jumpers">Jumpers and Connectors</a></h2></div><div class="h2c"><p>
	The board has a number of jumpers and connectors:</p>
	<ul>
	<li>JP1: BOOTROM - when set to on, the on-board ROM is mapped into the lowest 64k
		address space upon reset, so the board can take the system over</li>
	<li>JP2: NOROM - this jumper connects PIN&nbsp;5 of the system (6502) bus connector
		to the CPLD. The Commodore PET uses this pin to disable the built-in ROMs.
		Currently not used in the CPLD.</li>
	<li>JP4: CA18 - allows to use a smaller ROM by connecting VCC to ROM pin 1</li>
	<li>JP5: CA17 - allows to use a smaller ROM by connecting VCC to ROM pin 30</li>
	<li>JP6: CA15 - allows to use a smaller ROM by connecting VCC to ROM pin 3</li>
	<li>JP7: IO1 - switches between $ExFF and $ExBF I/O for the CPLD</li>
	<li>JP8: IO2 - switches between $E(F/C)xF and $E(B/8)xF I/O for the CPLD</li>
	<li>JP9: IO3 - switches between $E(F/B)xF and $E(C/8)xF I/O for the CPLD</li>
	<li>JP10: AUXCONF - config input into CPLD, currently unused</li>
	<li>JP11: DIAG - single pin, output from CPLD - used for diagnostics signals</li>
	</ul>
	<ul>
	<li>P1: 6502 system bus</li>
	<li>JP3: pwr - additional power supply</li>
	<li>SV1: JTAG - programming connector for the CPLD</li>
	</ul>
	</div></div><hr>
<p>Return to <a href="../../index.html">Homepage</a></p>

  Last modified: 
2010-08-29
	</div></div><div id="rightcol"><div class="top" id="share"><div class="tophead">share</div><div><div id="socialshareprivacy"></div></div></div><div class="top" id="twitter"><div class="tophead">follow</div><div><p>Follow my 8-bit tweets on
		            <a class="extlink" target="_blank" href="https://twitter.com/#!/search/realtime/afachat%20%238bit">Twitter</a> (In new window)</p></div></div><div class="top" id="forum"><div class="tophead">discuss</div><div><p>Discuss my site on <a class="extlink" target="_blank" href="http://forum.6502.org/viewtopic.php?t=956">this 6502.org forum thread</a></p><p>Discuss this page's content on <a class="extlink" target="_blank" href="http://forum.6502.org/viewtopic.php?t=1573"> this 6502.org forum thread</a></p><p>(Forum registration required to post)</p></div></div><div class="top" id="hot"><div class="tophead">hot!</div><div>
<p>Dive into the retro feeling and build yourself a <a href="../../cbmhw/ryofat40/index.html">Commodore PET replica</a></p>
<p>Need more speed? Speed up your 6502 computer with this <a href="../../adv65/pet816/index.html">10&nbsp;MHz 6502 CPU replacement board</a></p>
<p>Interested in electronics design? Look at the <a href="../../icaphw/design.html">design lesson</a> I got from Bil Herd, the hardware designer of the C128</p>
<p>Want 64bit? - pimp the 6502 with the <a href="../../65k/index.html">65k processor design!</a></p>

		</div></div></div><div id="footer">&nbsp;</div></div><script type="text/javascript">myUp="../../";</script><script type="text/javascript" src="../../scripts2-all.js"></script><script type="text/javascript" src="../../jquery.socialshareprivacy.min.js"></script></body></html> 
