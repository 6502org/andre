<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="author" content="Andr&#xE9;  Fachat" />

<meta name="description" content="6502 o65 standard fileformat" />
<meta name="keywords" content="6502,standard,fileformat" />
<link rev="made" href="mailto:afachat@gmx.de" />
<link rel="stylesheet" title="Default" type="text/css" href="../style-min.css" /><link rel="alternate stylesheet" title="Advanced" type="text/css" href="../advanced.css" />
<title>o65 6502 binary relocation format v1.3</title></head>
<body><div id="mainbox"><div id="leftcol"><div id="menu" class="top"><div class="tophead">navigate</div><div id="filter"><form action="#"><table id="filterbox"><tr><td><input size="8" name="filter" value="filter" type="text" /></td><td><div id="cancel" class="i_cancel"> </div></td></tr></table><table id="expcol"><tr><td><div id="expand" class="i_expand"> </div></td><td><div id="collapse" class="i_collapse"> </div></td></tr></table></form></div>
<div id="mtree">
<a id="m_homepage" href="../index.html">Homepage</a>
<ul class="menu0" >
<li class="separator">Commodore</li>
<li class="dir" id="m_petindex"><div class="i_dir">&nbsp;</div><a href="../petindex/index.html">CBM PETindex</a>
</li>
<li class="dir" id="m_cbmhw"><div class="i_dir">&nbsp;</div><a href="../cbmhw/index.html">CBM hardware and mods</a>
</li>
<li class="separator">Hardware</li>
<li class="dir" id="m_csa"><div class="i_dir">&nbsp;</div><a href="../csa/index.html">CS/A65 Caspaer and Gecko computer</a>
</li>
<li class="dir" id="m_adv65"><div class="i_dir">&nbsp;</div><a href="../adv65/index.html">Advanced 6502</a>
</li>
<li class="dir" id="m_hwinfo"><div class="i_dir">&nbsp;</div><a href="../hwinfo/index.html">ICs and Standards Info</a>
</li>
<li class="dir" id="m_mischw"><div class="i_dir">&nbsp;</div><a href="../mischw/index.html">Other hardware (e.g. tools)</a>
</li>
<li class="separator">Software</li>
<li><div class="i_file">&nbsp;</div><a href="../osa/index.html">GeckOS operating system</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../lib6502/index.html">Lib6502 standard</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="index.html" class="mcurrent">O65 file format</a>

</li>
<li><div class="i_file">&nbsp;</div><a href="../misc/index.html">Misc software</a>
</li>
<li class="separator">Knowledge Bits</li>
<li class="dir" id="m_icapos"><div class="i_dir">&nbsp;</div><a href="../icapos/index.html">Computer/OS Architecture</a>
</li>
<li class="dir" id="m_icaphw"><div class="i_dir">&nbsp;</div><a href="../icaphw/index.html">6502 Hardware Bits</a>
</li>
<li class="separator">Misc</li>
<li><div class="i_file">&nbsp;</div><a href="../contact.html">Contact</a></li>
<li><div class="i_file">&nbsp;</div><a href="../sneak.html">Sneak preview</a></li>
<li><div class="i_file">&nbsp;</div><a href="../design.html">Web design</a></li>
</ul>

</div>
		</div><div class="top" id="browser"><div class="tophead">browser</div><div>
			Site has been tested with a number of browsers and systems. Javascript required for advanced menu, but degrades gracefully without Javascript. IE6 not fully supported anymore!
			</div></div></div><div id="rightcol"><div class="top" id="google"><div class="tophead">search</div><div><form method="get" action="http://www.google.com/search" target="_blank"><input type="text" name="q" size="10" maxlength="255" value="" /><input class="advbutton" type="submit" value="Search my site" /><br />(Google, in new window)
	                        <input type="hidden" name="sitesearch" value="www.6502.org/users/andre" /></form></div></div><div class="top" id="twitter"><div class="tophead">follow</div><div>
		            Follow my 8-bit tweets on<br /><a target="_blank" href="http://search.twitter.com/search?q=&amp;ands=&amp;phrase=&amp;ors=&amp;nots=&amp;tag=8bit&amp;lang=all&amp;from=afachat&amp;to=&amp;ref=&amp;near=&amp;within=15&amp;units=mi&amp;since=&amp;until=&amp;rpp=15">Twitter</a><br /> (In new window)
		</div></div><div class="top" id="forum"><div class="tophead">discuss</div><div><p>Discuss my site on <a class="extlink" target="_blank" href="http://forum.6502.org/viewtopic.php?t=956">this 6502.org forum thread</a></p><p>(Forum registration required to post)</p></div></div><div class="top" id="hot"><div class="tophead">Hot!</div><div>
<p>Dive into the retro feeling and build yourself a <a href="../cbmhw/ryofat40/index.html">Commodore PET replica</a></p>
<p>Need more speed? Speed up your 6502 computer with this <a href="../adv65/pet816/index.html">10&nbsp;MHz 6502 CPU replacement board</a></p>
<p>Interested in electronics design? Look at the <a href="../icaphw/design.html">design lesson</a> I got from Bil Herd, the hardware designer of the C128</p>

		</div></div></div><div id="midcol"><div class="top" id="ie6warn">
You are using an old MS Internet Explorer as browser. This version is not supported anymore. Please use a 
more modern browser, like Internet Explorer 8 or later, 
<a target="_blank" class="extlink" href="http://www.firefox.com">Firefox</a>,
<a target="_blank" class="extlink" href="http://www.google.com/chrome">Google Chrome</a>, or
<a target="_blank" class="extlink" href="http://www.opera.com">Opera</a>.
</div><div class="top" id="content">
<div id="breadcrumbs">
<a href="../index.html">Homepage</a>
&gt;&gt;  O65 file format</div>
<a name="topanchor" id="topanchor"></a><h1>o65 6502 binary relocation format v1.3</h1><p class="copyright">(C)
1997-2010 André  Fachat</p> 
<div class="overview"><p>The <strong>o65</strong> fileformat provides portable way
for using relocatable 6502 binaries. It can hold object files
or executables, and features segments for uninitialized data,
initialized data and text, as well as (uninitialized) zeropage.
Block loading can be used and when there is no late-binding
(which is possible) no side-storage is needed.
	</p>
  </div><div id="toc"><h2>Table of content</h2><div class="toplink"><a href="#top">Top</a></div><ul><li><a href="#current">Current Version</a></li><li><a href="#example">Example Code</a></li><li><a href="#o65ng">o65 Next Generation</a></li><li><a href="#dist">Distribution</a></li><li><a href="#uses">Current uses</a></li><li><a href="#disc">Disclaimer</a></li></ul></div><h2><a name="current" id="current">Current Version</a></h2><div class="toplink"><a href="#top">Top</a></div><p>The current version is version 1.3 in
<a href="fileformat.html">fileformat.html</a>
</p><p>
The change from <a href="fileformat-1.2.html.gz">version 1.2</a>
are an upward compatible change in the mode bits, more os types,
and better explanations.
</p><p>
The change from the <a href="fileformat-1.1.html.gz">version 1.1</a>
is that the undefined reference relocation entry for high-byte
relocation has changed.
</p>
    <h2><a name="example" id="example">Example Code</a></h2><div class="toplink"><a href="#top">Top</a></div><p>
In the file <a href="libloader.a65">libloader.a65</a> is a sample loader
for the o65 file format in 6502 assembler. It is taken from the OS/A65 lib6502 code. It does not use the simple file format (as described by mode.11), but
computes the relocation differences for each segment separately. What it
does, however, is late binding of the <code>OSA2KERNEL</code> and
<code>lib6502</code> variables, as well as looking for the <code>main</code>
exported label to start the program.
</p><p>
A simpler version (without undefined references and without late binding) comes with the
<code>xa</code> assembler and you can find it in <a href="loader.a65">loader.a65</a>. It
also has a sample C64 binding.
</p><p>
The code is not cleared from debug statements and lacks comments. Wear your
hard hat.
</p>
    <h2><a name="o65ng" id="o65ng">o65 Next Generation</a></h2><div class="toplink"><a href="#top">Top</a></div><p>Due to some requests to support other CPUs and "larger" systems, I have made an attempt to
define a new, "v2" version of the o65 file format. It is far from complete, and open for discussion.
You can find the working draft in <a href="fileformatng.html">fileformatng.html</a>.
</p>
    <h2><a name="dist" id="dist">Distribution</a></h2><div class="toplink"><a href="#top">Top</a></div><p>
The file format extension <quote>o65</quote> for a 6502 relocatable file format
is copyrighted by me. It may be used by systems and applications without
restriction, as long
as the files named with this extension obey
the definitions stated in this document.
</p>
    <h2><a name="uses" id="uses">Current uses</a></h2><div class="toplink"><a href="#top">Top</a></div>
<p>
The <code>o65</code> file format is currently used in the following systems:
<ul>
<li><a href="http://www.6502.org/users/andre/osa/index.html">GeckOS/A65</a> operating system: o65 is the main file format for the GeckOS operating
system for executables.<br />It uses late binding to insert the kernel jumptable address as
well as the lib6502 jumptable address into the executable at load time. Also it searches
the (optional) "main" label to start the executable. Name lengths can be arbitrary as they
are not stored, name encoding is ASCII.
Currently the simple file format is not required, the loader can handle arbitrary segment
addresses.</li>
<li><a href="http://lng.sourceforge.net">Lunix operating system</a> uses the cc65 toolchain to produce o65 as executable file format.</li>
<li><a href="http://www.cc65.org">CC65</a>: o65 is used for two purposes in the 6502 C compiler:
<ul>
<li>Loadable modules (can be viewed either as "executables" or as "overlays").</li>
<li>ld65 can also generate executable programs in o65 format for use with
      other operating systems. Currently this is in experimental use in Lunix
      (as far as I know).</li>
</ul>
The format is currently used for 6502/C02. The cc65 module loader expects
the <code>simple</code> format. The linker is able to
 generate other formats as well.
cc65 itself (that is: the library) won't use exports and imports.
  o65 is not used as an object code format. Because of its simplicity (which,
  as said before, is also its advantage) it is missing features for this
  purpose.</li>
<li>opencbm floppy modules:
The <a href="http://www.trikaliotis.net/cbm4win">opencbm</a> API (cbm4win, cbm4linux) will (work in progress) use the o65 file format for
modules to load into floppy. The API itself loads o65 files to account
for the differences between the various floppy drives (1540/1541,
1570/1571, 1581), and to present the API user transfer protocols for its
use. The API user loads additional modules into the floppy drives which
then use late binding to connect to the various support routines of the
floppy ROM, or of the transfer protocols. Name encoding is ASCII.
Currently, the simple file format is not
required (but there is no definitive decision about this yet).
</li>
<li>The <a href="http://www.sics.se/~adam/contiki/index.html">Contiki Operating System</a> uses
o65 as format for its 6502 program executables.</li>
<li>A <a href="http://bisqwit.iki.fi/source/snescom.html">Free SNES assembler</a>
uses o65 as output file format for the 65816 files.</li>
<li>The <a href="http://sourceforge.net/projects/wingsos/">WiNGs</a> operating system use the o65 file format for its binaries.</li>
<li>Other projects use the o65 file format for own experimentation,
even for such CPUs as Z80 and 80286!</li>
</ul>
</p>
All Copyrights are acknowledged.
The information here is provided under the terms of the
GNU Public License version 2 unless noted otherwise.
    <hr />
<p>Return to <a href="../index.html">Homepage</a></p>

  </div></div></div><div id="footer"> </div><script type="text/javascript">myUp="../";</script><script type="text/javascript" src="../scripts-all.js"></script></body></html> 

