<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="author" content="" />

<meta name="description" content="" />
<meta name="keywords" content="Commodore PET 6502 65816 CPU" />
<link rev="made" href="mailto:" />
<link rel="stylesheet" title="Default" type="text/css" href="../../style-min.css" /><link rel="alternate stylesheet" title="Advanced" type="text/css" href="../../advanced.css" />
<title>Commodore PET 65816 CPU card</title></head>
<body><div id="mainbox"><a name="top" id="top"></a><div id="leftcol"><div id="menu" class="top"><div class="tophead">navigate</div><div id="filter"><form action="#"><table id="filterbox"><tr><td><input alt="menu filter" size="8" name="filter" value="filter" type="text" /></td><td><div id="cancel" class="i_cancel"> </div></td></tr></table><table id="expcol"><tr><td><div id="expand" class="i_expand"> </div></td><td><div id="collapse" class="i_collapse"> </div></td></tr></table></form></div>
<div id="mtree">
<a id="m_homepage" href="../../index.html">Homepage</a>
<ul class="menu0" >
<li class="separator">Commodore</li>
<li class="dir" id="m_petindex"><div class="i_dir">&nbsp;</div><a href="../../petindex/index.html">CBM PETindex</a>
</li>
<li class="dir" id="m_cbmhw"><div class="i_dir">&nbsp;</div><a href="../../cbmhw/index.html">CBM hardware and mods</a>
</li>
<li class="separator">Hardware</li>
<li class="dir" id="m_65k"><div class="i_dir">&nbsp;</div><a href="../../65k/index.html">The 65k Project</a>
</li>
<li class="dir" id="m_csa"><div class="i_dir">&nbsp;</div><a href="../../csa/index.html">CS/A65 Caspaer and Gecko computer</a>
</li>
<li class="dir" id="m_adv65"><div class="i_dir">&nbsp;</div><a href="../../adv65/index.html">Advanced 6502</a>
<ul class="menu1" >
<li><div class="i_link">&nbsp;</div><a href="../../65k">The 65k Project</a></li>
<li class="dir" id="m_adv65_pet816"><div class="i_dir">&nbsp;</div><a href="index.html" class="mcurrent">Speed up your 6502!</a>
<ul class="menu2" >
<li><div class="i_file">&nbsp;</div><a href="features.html">Board Features</a></li>
<li><div class="i_file">&nbsp;</div><a href="works.html">How it works</a></li>
<li><div class="i_file">&nbsp;</div><a href="gallery.html">Gallery</a></li>
<li><div class="i_file">&nbsp;</div><a href="hardware.html">Hardware</a></li>
</ul>
</li>
<li><div class="i_link">&nbsp;</div><a href="../../csa/index.html">CS/A65</a></li>
<li><div class="i_file">&nbsp;</div><a href="../65net.html">6502 networking</a></li>
</ul>
</li>
<li class="dir" id="m_hwinfo"><div class="i_dir">&nbsp;</div><a href="../../hwinfo/index.html">ICs and Standards Info</a>
</li>
<li class="dir" id="m_mischw"><div class="i_dir">&nbsp;</div><a href="../../mischw/index.html">Other hardware (e.g. tools)</a>
</li>
<li class="separator">Software</li>
<li><div class="i_file">&nbsp;</div><a href="../../osa/index.html">GeckOS operating system</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../../lib6502/index.html">Lib6502 standard</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../../o65/index.html">O65 file format</a>
</li>
<li><div class="i_file">&nbsp;</div><a href="../../misc/index.html">Misc software</a>
</li>
<li class="separator">Knowledge Bits</li>
<li class="dir" id="m_icapos"><div class="i_dir">&nbsp;</div><a href="../../icapos/index.html">Computer/OS Architecture</a>
</li>
<li class="dir" id="m_icaphw"><div class="i_dir">&nbsp;</div><a href="../../icaphw/index.html">6502 Hardware Bits</a>
</li>
<li class="separator">Misc</li>
<li><div class="i_file">&nbsp;</div><a href="../../contact.html">Contact</a></li>
<li><div class="i_file">&nbsp;</div><a href="../../sneak.html">Sneak preview</a></li>
<li><div class="i_file">&nbsp;</div><a href="../../design.html">Web design</a></li>
</ul>

</div>
		</div><div class="top" id="browser"><div class="tophead">browser</div><div>
			Site has been tested with a number of browsers and systems. Javascript required for advanced menu, but degrades gracefully without Javascript. IE6 not fully supported anymore!
			</div></div></div><div id="rightcol"><div class="top" id="google"><div class="tophead">search</div><div><form method="get" action="http://www.google.com/search" target="_blank"><input alt="search parameters" type="text" name="q" size="10" maxlength="255" value="" /><input class="advbutton" type="submit" value="Search my site" /><br />(Google, in new window)
	                        <input type="hidden" name="sitesearch" value="www.6502.org/users/andre" /></form></div></div><div class="top" id="twitter"><div class="tophead">follow</div><div>
		            Follow my 8-bit tweets on<br /><a class="extlink" target="_blank" href="http://search.twitter.com/search?q=&amp;ands=&amp;phrase=&amp;ors=&amp;nots=&amp;tag=8bit&amp;lang=all&amp;from=afachat&amp;to=&amp;ref=&amp;near=&amp;within=15&amp;units=mi&amp;since=&amp;until=&amp;rpp=15">Twitter</a><br /> (In new window)
		</div></div><div class="top" id="forum"><div class="tophead">discuss</div><div><p>Discuss my site on <a class="extlink" target="_blank" href="http://forum.6502.org/viewtopic.php?t=956">this 6502.org forum thread</a></p><p>Discuss this page's content on <a class="extlink" target="_blank" href="http://forum.6502.org/viewtopic.php?t=1573"> this 6502.org forum thread</a></p><p>(Forum registration required to post)</p></div></div><div class="top" id="hot"><div class="tophead">Hot!</div><div>
<p>Dive into the retro feeling and build yourself a <a href="../../cbmhw/ryofat40/index.html">Commodore PET replica</a></p>
<p>Need more speed? Speed up your 6502 computer with this <a href="../../adv65/pet816/index.html">10&nbsp;MHz 6502 CPU replacement board</a></p>
<p>Interested in electronics design? Look at the <a href="../../icaphw/design.html">design lesson</a> I got from Bil Herd, the hardware designer of the C128</p>
<p>Want 64bit? - pimp the 6502 with the <a href="../../65k/index.html">65k processor design!</a></p>

		</div></div></div><div id="midcol"><div class="top" id="ie6warn">
You are using an old MS Internet Explorer as browser. This version is not supported anymore. Please use a 
more modern browser, like Internet Explorer 8 or later, 
<a target="_blank" class="extlink" href="http://www.firefox.com">Firefox</a>,
<a target="_blank" class="extlink" href="http://www.google.com/chrome">Google Chrome</a>, or
<a target="_blank" class="extlink" href="http://www.opera.com">Opera</a>.
</div><div class="top" id="content"><div id="minmax"></div>
<div id="breadcrumbs">
<a href="../../index.html">Homepage</a>
&gt;&gt; <a href="../index.html">Advanced 6502</a>&gt;&gt;  Speed up your 6502!</div>
<h1>Commodore PET 65816 CPU card</h1>

<div class="overview"><p>
			This a PET 65816 CPU card! It speeds up your PET to up to 10MHz.
			In fact it's a 6502 replacement card and could be used in other 6502-based
			computers as well.
			The board uses a 65816 CPU that runs at up to 10MHz, plus a Xilinx CPLD as logic glue. It includes
			up to 1MByte fast RAM (run at CPU speed) plus up to 512k parallel Flash ROM (in-system programmable), that can be used as boot ROM.
	</p>
	<div class="rightimg"><a href="imgs/gal_speed.png"><img alt="8296 benchmark screen" src="imgs/gal_speed_small.png" /></a><br />The board prototype installed in a Commodore 8296 - running a benchmark at 10 MHz!
		                </div>	<p>
The interface itself is, in fact, pretty simple. It is a board that is plugged 
in the 6502 CPU socket of the PET. On the board there is the CPU, the CPLD logic, the new clock generator (50MHz), some few support 
parts, as well as two 512k static RAM and one 512k Flash RAM chip. The board is all-through-hole - i.e. no SMD parts! I call that 
a feature in these days.
	</p><p>
		The prototype has been tested with my <a href="../../csa/index.html">CS/A65</a> computer, in the MMU board - which is 
		easier to handle when you have to change things often. But it also now runs in the CBM8296. Tests with other PETs will follow.
	</p><p>
		Please also look at these pages:
		</p>
		<ul><li><a href="features.html">Features page</a></li>
		<li><a href="works.html">How it works</a> page.</li>
		<li><a href="hardware.html">Hardware</a> page</li>
		<li><a href="gallery.html">Gallery</a> page</li>
		</ul>
	
</div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="news" id="news">News:</a></h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c"><ul class="news"><li><div> </div><small>2010-09-05</small>
			Added info and pet debug code for PET 4032
		</li><li><div> </div><small>2010-08-28</small>
			New 1.2B version of the board, with board layout, and updated VHDL code.
			Also added <a href="features.html">features</a>, <a href="hardware.html">Hardware</a>, <a href="gallery.html">Gallery</a> and <a href="works.html">how it works</a> page.
		</li><li><div> </div><small>2010-08-14</small>
			New version of the board, now with board layout, and updated VHDL code.
			Explanations still to come though.
		</li><li><div> </div><small>2010-04-20</small>
			Published the board.
		</li></ul></div></div><div id="toc" class="h2"><div class="h2h"><div class="h2t"> </div><h2>Table of content</h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c"><ul><li><a href="#driver">Driver</a></li><li style="list-style-type:none;"><ul><li><a href="#driver1">PET 4032 test machine</a></li><li><a href="#driver2">Testsuite</a></li><li><a href="#driver3">VHDL code</a></li></ul></li><li><a href="#boards">Board Revisions</a></li><li style="list-style-type:none;"><ul><li><a href="#board1">1.2b</a> (ok)</li><li><a href="#board2">1.2a</a> (prototype)</li><li><a href="#board3">1.0b</a> (prototype)</li></ul></li></ul></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="driver" id="driver">Driver</a></h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c"><h3><a name="driver1" id="driver1">PET 4032 test machine</a></h3><p>I tried to repair a PET 4032 machine, that seems to have a memory problem.
			So I put in the 65816 board, with some boot code in the ROM, to run the PET
			in the 65816 board only. The result can be seen in the gallery, the PET
			runs at 10 MHz.
			</p> <p>
			The boot code consists of the original 4032 (non-CRTC) ROMs 
			plus some init code that copies the ROM contents from the board's ROM
			(i.e. not from the PET's original ROMs, that could be broken!)
			to fast RAM, and runs the system completely from the fast RAM.
			Only I/O is used and I was lucky that this works on my 4032, so I 
			can use - and debug - the machine even with programs from the disk drive.
			</p><p>
			The code in the file below builds a <code>PDEBUG</code> PET binary, that
			when run, programs the boot ROM of the 65816 board. It assumes a 128k
			Atmel Flash PROM for the write algorithm, as does the <code>progrom</code>
			programs below.
			</p>
		<table class="files">
<tr class="R1"><td><div class="i_driver"> </div></td>
<td><a href="petdebug.tar.gz">petdebug.tar.gz</a>(PET 4032 test ROM)</td>
</tr></table><h3><a name="driver2" id="driver2">Testsuite</a></h3><p>Here are some small tests that test the various features of the board.
		</p><p>Note that building them requires the <code>xa</code> cross assembler, using 
		the <code>-w</code> switch to enable 65816 code, as well as <code>petcat</code> 
		from the VICE emulator package to build the BASIC parts.
		</p><p>Here is a description of the different tests (by subdirectory):</p>
		<ul>
		<li>benchmark - builds the <code>BENCH</code> benchmark program used to check the
			speed of the various settings. Builds from the <code>BENCH.basic</code> BASIC
			source as 
			well as <code>benchcode.a65</code> and <code>eichcode.a65</code> assembler
			sources.</li>
		<li>eichtest - builds the burn-in test that, at its start, shows how fast the system
			actually works (uses screen interrupts to determine system speed, so works
			on my 2 MHz PET replica as well. Builds the <code>LOOP</code> Commodore
			PET BASIC executable from <code>LOOP5.basic</code> and 
			<code>eichcode.a65</code>.</li>
		<li>maptest - some mapping tests. <code>COPY</code> copies 4k data from the system memory
			mirror at $e0xxxx to  bank 0. <code>GOFAST</code> copies the system from
			slow memory over to the fast RAM mirror, and switches to it. <code>MAPTEST</code>
			compares the slow memory with the system memory mirror at $e0xxxx.</li>
		<li>modes - builds the <code>GOFAST</code> and <code>GOSLOW</code> programs that
			move execution to either fast RAM or back into slow memory. <code>GOFAST</code>
			is updated compared to the maptest version though.</li>
		<li>progrom - programs the ROM to run a "GOFAST" functionality directly on reset,
			as a boot rom. If you program your on-board ROM with this <code>PGOFAST</code>
			code, and set the bootrom jumper, the system will automatically boot into 
			fast mode.(Edit: the programming algorithm in <code>proglib.a65</code> has
			problems with larger blocks - better use the <code>proglib.a65</code> 
			code from <code>petdebug.tar.gz</code> above)</li>
		</ul>
		<table class="files">
<tr class="R1"><td><div class="i_driver"> </div></td>
<td><a href="x816tests-1.0.tgz">x816tests-1.0.tgz</a>(Feature test suite)</td>
</tr></table><h3><a name="driver3" id="driver3">VHDL code</a></h3><p>
			This is the VHDL code for the board. It is packaged as the XILINX ISE Webpack (v11.1) directory. Included in this directory is a "testbench" directory with some simulation test runs. Requires Linux with ghdl and GTKWave installed, then look into the Makefile.
		</p><p>
		Version 1.7.1 just has an updated testsuite.
		</p><table class="files">
<tr class="R1"><td><div class="i_logic"> </div></td>
<td><a href="PET816_1.7.1.tar.bz2">PET816_1.7.1.tar.bz2</a>(Archive of the XILINX ISE Webpack CPLD logic - includes VHDL source, JED binary file, as well as a testbench. )</td>
</tr>
<tr class="R0"><td><div class="i_logic"> </div></td>
<td><a href="PET816_1.7.tar.bz2">PET816_1.7.tar.bz2</a>(Archive of the XILINX ISE Webpack CPLD logic - includes VHDL source, JED binary file, as well as a testbench. )</td>
</tr>
<tr class="R1"><td><div class="i_logic"> </div></td>
<td><a href="PET816_1.5.tar.bz2">PET816_1.5.tar.bz2</a>(Archive of the XILINX ISE Webpack CPLD logic - includes VHDL source, JED binary file, as well as a testbench. )</td>
</tr>
<tr class="R0"><td><div class="i_logic"> </div></td>
<td><a href="PET816_1.0.tar.bz2">PET816_1.0.tar.bz2</a>(Archive of the XILINX ISE Webpack CPLD logic - includes VHDL source, JED binary file, as well as a testbench. )</td>
</tr>
<tr class="R1"><td><div class="i_logic"> </div></td>
<td><a href="imgs/gtkwave.png">imgs/gtkwave.png</a>(Sample screenshot of the timing simulation in the testbench)</td>
</tr></table></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="boards" id="boards">Board revisions</a></h2><div class="toplink"><a href="#top">Top</a></div></div><div class="h2c"><h3><a name="board1" id="board1">Version: 1.2b</a></h3>
<p>Status: ok</p>
<h4>Notes</h4><table class="notes"><tr><td class="noteicon"><div class="i_msg"> </div></td>
<td>
			This board is an update on the 1.2A, and only contains a few small changes:
			Two delay loops that can be used in the VHDL code have been added. Also
			an "official" diagnostics pin has been added too, to get easy access to a 
			signal "exported" from the CPLD.
		</td></tr>
</table><h4>Files</h4><table class="files">
<tr class="R1"><td><div class="i_schem"> </div></td>
<td><a href="pet_cpu816-v1.2b.sch">pet_cpu816-v1.2b.sch</a></td>
</tr>
<tr class="R0"><td><div class="i_layout"> </div></td>
<td><a href="pet_cpu816-v1.2b.brd">pet_cpu816-v1.2b.brd</a></td>
</tr>
<tr class="R1"><td><div class="i_schem"> </div></td>
<td><a href="pet_cpu816-v1.2b-sch.png">pet_cpu816-v1.2b-sch.png</a></td>
</tr>
<tr class="R0"><td><div class="i_layout"> </div></td>
<td><a href="pet_cpu816-v1.2b-brd.png">pet_cpu816-v1.2b-brd.png</a></td>
</tr></table>
<h3><a name="board2" id="board2">Version: 1.2a</a></h3>
<p>Status: prototype</p>
<h4>Notes</h4><table class="notes"><tr><td class="noteicon"><div class="i_warn"> </div></td>
<td>
			This board has been only barely tested
		</td></tr>
</table><h4>Files</h4><table class="files">
<tr class="R1"><td><div class="i_schem"> </div></td>
<td><a href="pet_cpu816-v1.2a.sch">pet_cpu816-v1.2a.sch</a></td>
</tr>
<tr class="R0"><td><div class="i_layout"> </div></td>
<td><a href="pet_cpu816-v1.2a.brd">pet_cpu816-v1.2a.brd</a></td>
</tr>
<tr class="R1"><td><div class="i_schem"> </div></td>
<td><a href="pet_cpu816-v1.2a-sch.png">pet_cpu816-v1.2a-sch.png</a></td>
</tr>
<tr class="R0"><td><div class="i_layout"> </div></td>
<td><a href="pet_cpu816-v1.2a-brd.png">pet_cpu816-v1.2a-brd.png</a></td>
</tr></table>
<h3><a name="board3" id="board3">Version: 1.0b</a></h3>
<p>Status: prototype</p>
<h4>Notes</h4><table class="notes"><tr><td class="noteicon"><div class="i_warn"> </div></td>
<td>
			This board has been only barely tested
		</td></tr>
</table><h4>Files</h4><table class="files">
<tr class="R1"><td><div class="i_schem"> </div></td>
<td><a href="pet_cpu816-v1.0b.sch">pet_cpu816-v1.0b.sch</a></td>
</tr>
<tr class="R0"><td><div class="i_schem"> </div></td>
<td><a href="pet_cpu816-v1.0b-sch.png">pet_cpu816-v1.0b-sch.png</a></td>
</tr></table>
All Copyrights are acknowledged.
The information here is provided under the terms of the
GNU Public License version 2 unless noted otherwise.
<p>Return to <a href="../../index.html">Homepage</a></p>

</div></div></div><div id="footer"> </div></div><script type="text/javascript">myUp="../../";</script><script type="text/javascript" src="../../scripts-all.js"></script></body></html>
