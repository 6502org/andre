<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="author" content="André  Fachat">

<meta name="description" content="PET index - DOS ROMs">
<meta name="keywords" content="Commodore PET CBM ROM disk drives">
<link rev="made" href="mailto:afachat@gmx.de">
<LINK REL="stylesheet" TITLE="Default" TYPE="text/css" HREF="../../../style.css">
<LINK REL="alternate stylesheet" TITLE="Advanced" TYPE="text/css" HREF="../../../advanced.css">
<script src="../../../jquery-1.4.2.min.js"></script><script src="../../../myscripts.js"></script><script>myUp="../../../";</script>

<title>PET index - DOS ROMs</title>
</head>
<body><div id="mainbox">
<div id="leftcol"><div id="menu" class="top">
<div class="tophead">navigate</div>
<div id="filter"><form action="#">
<img id="expand" src="../../../imgs/expand.png"><img id="collapse" src="../../../imgs/collapse.png"><input size="8" name="filter" value="filter" type="text"><img id="cancel" src="../../../imgs/cancel.png">
</form></div>
<div id="mtree">
<a class="m_homepage" href="../../../index.html">Homepage</a>
<ul class="menu0" >
<li class="separator">Commodore</li>
<li class="dir" id="m_petindex"><img src="../../../imgs/dir.png"/><a href="../../../petindex/index.html">CBM PETindex</a>
<ul class="menu1" >
<li class="separator">General Info</li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../gallery/index.html">PET gallery</a>
</li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../versions.html">PET versions</a></li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../boards.html">Board versions</a></li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../pinouts.html">Connectors</a></li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../keyboards.html">Keyboards</a></li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../extensions.html">Extensions</a></li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../open.html">Open questions</a></li>
<li class="separator">Specials</li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../superpet.html">SuperPET MMF9000</a></li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../8x96.html">The 8096 and 8296 models</a></li>
<li class="separator">Peripherals</li>
<li class="dir" id="m_petindex_drives"><img src="../../../imgs/dir.png"/><a href="../../drives/index.html">Disk drives</a>
<ul class="menu2" >
<li class="file"><img src="../../../imgs/file.png"/><a href="../arch/index.html">Drive architecture</a>
</li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../gallery/index.html">Drive gallery</a>
</li>
<li class="file"><img src="../../../imgs/file.png"/><a href="index.html" class="mcurrent">DOS ROMs</a>

</li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../progs/index.html">Drive utilities</a>
</li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../drives.html">Drives list</a></li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../harddisk.html">Harddisk info</a></li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../writegap.html">Write gap info</a></li>
</ul>
</li>
<li class="separator">Programming</li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../progmod.html">Hardware programming</a></li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../roms.html">ROM descriptions</a></li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../crtc.html">CRTC operation</a></li>
<li class="separator">Quirks</li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../poke.html">Killer poke</a></li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../repairs.html">Repairing the PET</a></li>
<li class="separator">Links</li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../hw.html">Hardware projects</a></li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../sw.html">Software projects</a></li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../emus.html">PET emulators</a></li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../transfer.html">File transfers</a></li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../links.html">Links</a></li>
</ul>
</li>
<li class="dir" id="m_cbmhw"><img src="../../../imgs/dir.png"/><a href="../../../cbmhw/index.html">CBM hardware and mods</a>
</li>
<li class="separator">Hardware</li>
<li class="dir" id="m_csa"><img src="../../../imgs/dir.png"/><a href="../../../csa/index.html">CS/A65 Caspaer and Gecko computer</a>
</li>
<li class="dir" id="m_hwinfo"><img src="../../../imgs/dir.png"/><a href="../../../hwinfo/index.html">ICs and Standards Info</a>
</li>
<li class="dir" id="m_mischw"><img src="../../../imgs/dir.png"/><a href="../../../mischw/index.html">Other hardware (e.g. tools)</a>
</li>
<li class="separator">Software</li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../../osa/index.html">GeckOS operating system</a>
</li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../../lib6502/index.html">Lib6502 standard</a>
</li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../../o65/index.html">O65 file format</a>
</li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../../misc/index.html">Misc software</a>
</li>
<li class="separator">Knowledge Bits</li>
<li class="dir" id="m_icapos"><img src="../../../imgs/dir.png"/><a href="../../../icapos/index.html">Computer/OS Architecture</a>
</li>
<li class="dir" id="m_icaphw"><img src="../../../imgs/dir.png"/><a href="../../../icaphw/index.html">6502 Hardware Bits</a>
</li>
<li class="separator">Misc</li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../../contact.html">Contact</a></li>
<li class="file"><img src="../../../imgs/file.png"/><a href="../../../sneak.html">Sneak preview</a></li>
</ul>

</div>
		</div></div>
<div id="rightcol">
<div class="top" id="google">
<div class="tophead">search</div>
<div><form method="get" action="http://www.google.com/search">
<input type="text" name="q" size="20" maxlength="255" value=""><input type="submit" value="Search my site"> (Google)
	                        <input type="hidden" name="sitesearch" value="www.6502.org/users/andre">
</form></div>
</div>
<div class="top" id="twitter">
<div class="tophead">follow</div>
<div>
		            Follow my 8-bit tweets on
		            <a href="http://search.twitter.com/search?q=&amp;ands=&amp;phrase=&amp;ors=&amp;nots=&amp;tag=8bit&amp;lang=all&amp;from=afachat&amp;to=&amp;ref=&amp;near=&amp;within=15&amp;units=mi&amp;since=&amp;until=&amp;rpp=15"><img src="http://twitter-badges.s3.amazonaws.com/twitter-b.png" alt="twitter"></a>
</div>
</div>
<div class="top" id="forum">
<div class="tophead">discuss</div>
<div>
<p>Discuss my site on <a href="http://forum.6502.org/viewtopic.php?t=956">this 6502.org forum thread</a></p>
<p>(Forum registration required to post)</p>
</div>
</div>
</div>
<div id="midcol">
<DIV class="top" ID="breadcrumbs">
<a href="../../../index.html">Homepage</a>
&gt;&gt; <a href="../../index.html">CBM PETindex</a>&gt;&gt; <a href="../index.html">Disk drives</a>&gt;&gt;  DOS ROMs</DIV>
<DIV class="top" ID="content">
<h1>PET index - DOS ROMs</h1>
<p class="copyright">(C)
1998-2010 André  Fachat</p> 
<div class="overview">
<p>Information about the DOS ROMs.</p>
  </div>
<DIV ID="toc">
<H2>Table of content</H2>
<dir>
<li><a href="#comp">Comparison</a></li>
<li><a href="#versions">DOS Versions</a></li>
<dir>
<li><a href="#dos1x">DOS 1.x</a></li>
<li><a href="#dos20">DOS 2.0/2.1</a></li>
<li><a href="#dos25">DOS 2.5</a></li>
<li><a href="#dos26">DOS 2.6</a></li>
<li><a href="#dos27">DOS 2.7</a></li>
</dir>
<li><a href="#8in">8280 8'' disk drive DOS</a></li>
<li><a href="#hd">Harddisk ROMs</a></li>
</dir>
</DIV>
<h2><a name="comp">Comparison</a></h2>
<p><P>Here is a comparison table for the different DOS versions (Based on information from this <A HREF="../local/drive_info.txt">drive_info.txt</A> that comes with the <A HREF="http://vice-emu.sourceforge.net/">VICE</A> emulator
</P>
<TABLE BORDER="1">
<TR>
<TH>Model</TH>
<TH>1541</TH>
<TH>2031/4031</TH>
<TH>2040/3040</TH>
<TH>4040</TH>
<TH>8050</TH>
<TH>8250/1001</TH>
</TR>
<TR>
<TD>DOS version(s)</TD>
<TD>2.6</TD>
<TD>2.6</TD>
<TD>1.0/1.2</TD>
<TD>2.1/2.7</TD>
<TD>2.5/2.7</TD>
<TD>2.7</TD>
</TR>
<TR>
<TD>Disk format(s)</TD>
<TD>'2A'</TD>
<TD>'2A'</TD>
<TD>'  '</TD>
<TD>'2A'</TD>
<TD>"2C"</TD>
<TD>"2C"</TD>
</TR>
<TR>
<TD>Drives</TD>
<TD>1</TD>
<TD>1</TD>
<TD>2</TD>
<TD>2</TD>
<TD>2</TD>
<TD>2</TD>
</TR>
<TR>
<TD>Heads per drive</TD>
<TD>1</TD>
<TD>1</TD>
<TD>1</TD>
<TD>1</TD>
<TD>1</TD>
<TD>2</TD>
</TR>
<TR>
<TD>Storage capacity</TD>
<TD>170k</TD>
<TD>170k</TD>
<TD>340k</TD>
<TD>340k</TD>
<TD>1.05M</TD>
<TD>2.12M</TD>
</TR>
<TR>
<TD>Sequential files</TD>
<TD>168k</TD>
<TD>168k</TD>
<TD>168k</TD>
<TD>168k</TD>
<TD>521k</TD>
<TD>1.05M</TD>
</TR>
<TR>
<TD>Relative files</TD>
<TD>167k</TD>
<TD>167k</TD>
<TD>n/a</TD>
<TD>167k</TD>
<TD>183k/518k</TD>
<TD>1.04M</TD>
</TR>
<TR>
<TD>Buffer storage (kB)</TD>
<TD>2</TD>
<TD>2</TD>
<TD>4</TD>
<TD>4</TD>
<TD>4</TD>
<TD>4</TD>
</TR>
<TR>
<TD>Tracks per drive</TD>
<TD>35</TD>
<TD>35</TD>
<TD>35</TD>
<TD>35</TD>
<TD>77</TD>
<TD>2*77</TD>
</TR>
<TR>
<TD>Sectors per track</TD>
<TD>17-21</TD>
<TD>17-21</TD>
<TD>17-21</TD>
<TD>17-21</TD>
<TD>23-29</TD>
<TD>23-29</TD>
</TR>
<TR>
<TD>Bytes per block</TD>
<TD>256</TD>
<TD>256</TD>
<TD>256</TD>
<TD>256</TD>
<TD>256</TD>
<TD>256</TD>
</TR>
<TR>
<TD>Free blocks (single drive/all drives)</TD>
<TD>664</TD>
<TD>664</TD>
<TD>670/1340</TD>
<TD>664/1328</TD>
<TD>2052/4104</TD>
<TD>4133/8266</TD>
</TR>
<TR>
<TD>Directory and BAM</TD>
<TD>18</TD>
<TD>18</TD>
<TD>18</TD>
<TD>18</TD>
<TD>38/39</TD>
<TD>38/39</TD>
</TR>
<TR>
<TD>Directory entries/disk</TD>
<TD>144</TD>
<TD>144</TD>
<TD>144</TD>
<TD>144</TD>
<TD>224</TD>
<TD>224</TD>
</TR>
<TR>
<TD>Transfer rate (internal, kB/s))</TD>
<TD>40</TD>
<TD>40</TD>
<TD>40</TD>
<TD>40</TD>
<TD>40</TD>
<TD>40</TD>
</TR>
<TR>
<TD>Transfer rate (IEC/IEEE488, kB/s))</TD>
<TD>0.4</TD>
<TD>1.8</TD>
<TD>1.8</TD>
<TD>1.8</TD>
<TD>1.8</TD>
<TD>1.8</TD>
</TR>
<TR>
<TD>Access time (ms) track to track</TD>
<TD>30</TD>
<TD>30</TD>
<TD>30</TD>
<TD>30</TD>
<TD>5</TD>
<TD>5</TD>
</TR>
<TR>
<TD>Access time (ms) average</TD>
<TD>360</TD>
<TD>360</TD>
<TD>360</TD>
<TD>360</TD>
<TD>125</TD>
<TD>125</TD>
</TR>
<TR>
<TD>Revolutions/minute</TD>
<TD>300</TD>
<TD>300</TD>
<TD>300</TD>
<TD>300</TD>
<TD>300</TD>
<TD>300</TD>
</TR>
</TABLE>
<P>The following table denotes the speed zones for the different formats:</P>
<TABLE BORDER="1">
<TR><TH COLSPAN="4">Number of sectors per track</TH></TR>
<TR>
<TD>2040/3040 DOS1.x</TD>
<TD>1540/1541/4040</TD>
<TD>8050</TD>
<TD>8250</TD>
</TR>
<TR>
<TD VALIGN="top">
  <TABLE>
        <TR>
<TH>Tracks</TH>
<TH>#Sectors</TH>
</TR>
        <TR>
<TD>1-17</TD>
<TD>21 (0-20)</TD>
</TR>
        <TR>
<TD>18-24</TD>
<TD>20 (0-19)</TD>
</TR>
        <TR>
<TD>25-30</TD>
<TD>18 (0-17)</TD>
</TR>
        <TR>
<TD>31-35</TD>
<TD>17 (0-16)</TD>
</TR>
  </TABLE>
</TD>
<TD VALIGN="top">
<TABLE>
        <TR>
<TH>Tracks</TH>
<TH>#Sectors</TH>
</TR>
        <TR>
<TD>1-17</TD>
<TD>21 (0-20)</TD>
</TR>
        <TR>
<TD>18-24</TD>
<TD>19 (0-18)</TD>
</TR>
        <TR>
<TD>25-30</TD>
<TD>18 (0-17)</TD>
</TR>
        <TR>
<TD>31-35</TD>
<TD>17 (0-16)</TD>
</TR>
  </TABLE>
</TD>
<TD VALIGN="top">
  <TABLE>
        <TR>
<TH>Tracks</TH>
<TH>#Sectors</TH>
</TR>
        <TR>
<TD>1-39</TD>
<TD>29 (0-28)</TD>
</TR>
        <TR>
<TD>40-53</TD>
<TD>27 (0-26)</TD>
</TR>
        <TR>
<TD>54-64</TD>
<TD>25 (0-24)</TD>
</TR>
        <TR>
<TD>65-77</TD>
<TD>23 (0-22)</TD>
</TR>
  </TABLE>
</TD>
<TD VALIGN="top">
  <TABLE>
        <TR>
<TH>Tracks</TH>
<TH>#Sectors</TH>
</TR>
        <TR>
<TD>1-39</TD>
<TD>29 (0-28)</TD>
</TR>
        <TR>
<TD>40-53</TD>
<TD>27 (0-26)</TD>
</TR>
        <TR>
<TD>54-64</TD>
<TD>25 (0-24)</TD>
</TR>
        <TR>
<TD>65-77</TD>
<TD>23 (0-22)</TD>
</TR>
        <TR>
<TD>78-116</TD>
<TD>29 (0-28)</TD>
</TR>
        <TR>
<TD>117-130</TD>
<TD>27 (0-26)</TD>
</TR>
        <TR>
<TD>131-141</TD>
<TD>25 (0-24)</TD>
</TR>
        <TR>
<TD>142-154</TD>
<TD>23 (0-22)</TD>
</TR>
  </TABLE>
</TD>
</TR>
</TABLE>
<P>Note: the DOS2.7 4040 drive was a prototype.</P>
     </p>
<h2><a name="versions">DOS Versions</a></h2>
<H3><a name="dos1x">DOS 1.x</a></H3>
<p><P>The first DOS versions (1.0) were rushed out to get disk support for the
PET machines. The first useable versions were the DOS 1.2 2040/3040
drives. These versions still lacked relative file support.
</P><P>
As the drives have two CPUs, one 6502 for the DOS and the IEEE488
and a 6504 for the disk controller (FDC), there are two ROM parts. The
DOS ROM is 8 kByte in size, the FDC ROM is only 1 kByte,
located in the 6530 RIOT chip. The size is so small that only
the most basic hardware-related code is stored there. To format
a disk, some code had to be copied to the shared RAM by the DOS
CPU and was executed by the FDC CPU. Therefore, there are three
ROM parts to discuss:
</P>
<UL>
<LI>
<A HREF="dos1.html">DOS1 ROM disassembly</A> (<A HREF="dos1.hdr">recomment header file</A>, comments transferred from the original CBM DOS2 source)
</LI>
<LI>
<A HREF="dos1fdc.html">DOS1 FDC ROM disassembly</A> (<A HREF="dos1fdc.hdr">recomment header file</A>, comments from the Commodore Inner Space Anthology)
</LI>
<LI>
<A HREF="dos1fmt.html">DOS1 format code disassembly</A> (<A HREF="dos1fmt.hdr">recomment header file</A>, comments from the Commodore Inner Space Anthology)
</LI>
</UL>
	</p>
<H3><a name="dos20">DOS 2.0/2.1</a></H3>
<p><P>The second DOS version added support for relative files, and changed
the disk format from 670 blocks free to 664 blocks free.
It was directly used in the 4040 drives, but many 2040/3040 drives have
been upgraded to these ROMs, as the hardware was otherwise the same.
</P>
<P> The original Commodore DOS source code can be found in the CBM archive
at <A HREF="http://www.zimmers.net/anonftp/pub/cbm/src/drives/">the CBM archive</A>.</P>
	</p>
<H3><a name="dos25">DOS 2.5</a></H3>
<p><P>The DOS 2.5 adds support for the large, quad density disk drives and is used in the 8050 disk drives.
</P>
	</p>
<H3><a name="dos26">DOS 2.6</a></H3>
<p><P>DOS 2.6 is a modification of the 2.x DOS where the FDC code is
also executed by the same DOS CPU. It is used in the VC1541 and 4031/2031
disk drives.
</P>
	</p>
<H3><a name="dos27">DOS 2.7</a></H3>
<p><P>DOS 2.7 descends from 2.5, not 2.6. I.e. it still uses two
CPUs, with dual drive support etc. It
adds support for double sided disks, as well as super side
sector for relative files. There are versions
for the 8050 and the 8250 as well as the 1001 disk drives. A prototype
version for the 4040 disk drive was never released.
In fact the DOS2.7 probes the FDC and adjusts itself automatically to
the 4040, 8050 or 8250 disk formats. Note that DOS 2.7 thus uses disk format '2A' on a 4040, and disk format '2C' on an 8x50 drive.
</P>
<P>A disassembly can be found in <A HREF="http://www.zimmers.net/anonftp/pub/cbm/firmware/drives/old/8050/d/index.html">the CBM archive</A>.</P>
        </p>
<h2><a name="8in">8280 8'' disk drive DOS</a></h2>
<p>
<P>The 8" disk drives use a ROM that, according to <A HREF="http://www.zimmers.net/anonftp/pub/cbm/firmware/drives/old/8280/index.html">the CBM archive</A>, are very similar to DOS 2.7.</P>
     </p>
<h2><a name="hd">Harddisk ROMs</a></h2>
<p><P>The hard disks have their own ROM. The source code can be found in
<A HREF="http://www.zimmers.net/anonftp/pub/cbm/src/drives/">the CBM archive</A>.
</P>
     </p>
<hr>
<p>Return to <a href="../../../index.html">Homepage</a></p>

  </DIV>
</div>
</div></body>
</html> 

