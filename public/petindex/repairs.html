<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="author" content="André  Fachat">

<meta name="description" content="Commodore hardware repair descriptions">
<meta name="keywords" content="Commodore hardware repair">
<link rev="made" href="mailto:afachat@gmx.de">
<LINK REL="stylesheet" TITLE="Default" TYPE="text/css" HREF="../style.css">
<LINK REL="alternate stylesheet" TITLE="Advanced" TYPE="text/css" HREF="../advanced.css">
<script src="../jquery-1.4.2.min.js"></script><script src="../myscripts.js"></script><script>myUp="../";</script>

<title>Commodore PET repair info</title>
</head>
<body>
<div id="leftcol">
<DIV class="top" ID="menu">
<a class="m_homepage" href="../index.html">Homepage</a>
<ul class="menu0" >
<li class="separator">Commodore</li>
<li class="dir" id="m_petindex"><img src="../imgs/dir.png"/><a href="../petindex/index.html">CBM PETindex</a>
<ul class="menu1" >
<li class="separator">General Info</li>
<li class="file"><img src="../imgs/file.png"/><a href="gallery/index.html">PET gallery</a>
</li>
<li class="file"><img src="../imgs/file.png"/><a href="versions.html">PET versions</a></li>
<li class="file"><img src="../imgs/file.png"/><a href="boards.html">Board versions</a></li>
<li class="file"><img src="../imgs/file.png"/><a href="pinouts.html">Connectors</a></li>
<li class="file"><img src="../imgs/file.png"/><a href="keyboards.html">Keyboards</a></li>
<li class="file"><img src="../imgs/file.png"/><a href="extensions.html">Extensions</a></li>
<li class="separator">Specials</li>
<li class="file"><img src="../imgs/file.png"/><a href="superpet.html">SuperPET MMF9000</a></li>
<li class="file"><img src="../imgs/file.png"/><a href="8x96.html">The 8096 and 8296 models</a></li>
<li class="separator">Peripherals</li>
<li class="dir" id="m_petindex_drives"><img src="../imgs/dir.png"/><a href="drives/index.html">Disk drives</a>
</li>
<li class="separator">Programming</li>
<li class="file"><img src="../imgs/file.png"/><a href="progmod.html">Hardware programming</a></li>
<li class="file"><img src="../imgs/file.png"/><a href="roms.html">ROM descriptions</a></li>
<li class="file"><img src="../imgs/file.png"/><a href="crtc.html">CRTC operation</a></li>
<li class="separator">Quirks</li>
<li class="file"><img src="../imgs/file.png"/><a href="poke.html">Killer poke</a></li>
<li class="file"><img src="../imgs/file.png"/><a href="repairs.html">Repairing the PET</a></li>
<li class="separator">Links</li>
<li class="file"><img src="../imgs/file.png"/><a href="hw.html">Hardware projects</a></li>
<li class="file"><img src="../imgs/file.png"/><a href="sw.html">Software projects</a></li>
<li class="file"><img src="../imgs/file.png"/><a href="emus.html">PET emulators</a></li>
<li class="file"><img src="../imgs/file.png"/><a href="transfer.html">File transfers</a></li>
<li class="file"><img src="../imgs/file.png"/><a href="links.html">Links</a></li>
</ul>
</li>
<li class="dir" id="m_cbmhw"><img src="../imgs/dir.png"/><a href="../cbmhw/index.html">CBM hardware and mods</a>
</li>
<li class="separator">Hardware</li>
<li class="dir" id="m_csa"><img src="../imgs/dir.png"/><a href="../csa/index.html">CS/A65 Caspaer and Gecko computer</a>
</li>
<li class="dir" id="m_hwinfo"><img src="../imgs/dir.png"/><a href="../hwinfo/index.html">ICs and Standards Info</a>
</li>
<li class="dir" id="m_mischw"><img src="../imgs/dir.png"/><a href="../mischw/index.html">Other hardware (e.g. tools)</a>
</li>
<li class="separator">Software</li>
<li class="file"><img src="../imgs/file.png"/><a href="../osa/index.html">GeckOS operating system</a>
</li>
<li class="file"><img src="../imgs/file.png"/><a href="../lib6502/index.html">Lib6502 standard</a>
</li>
<li class="file"><img src="../imgs/file.png"/><a href="../o65/index.html">O65 file format</a>
</li>
<li class="file"><img src="../imgs/file.png"/><a href="../misc/index.html">Misc software</a>
</li>
<li class="separator">Knowledge Bits</li>
<li class="dir" id="m_icapos"><img src="../imgs/dir.png"/><a href="../icapos/index.html">Computer/OS Architecture</a>
</li>
<li class="dir" id="m_icaphw"><img src="../imgs/dir.png"/><a href="../icaphw/index.html">6502 Hardware Bits</a>
</li>
<li class="separator">Misc</li>
<li class="file"><img src="../imgs/file.png"/><a href="../contact.html">Contact</a></li>
<li class="file"><img src="../imgs/file.png"/><a href="../sneak.html">Sneak preview</a></li>
</ul>

</DIV>
		<div class="top" id="browser">
			Site has been tested with Firefox 3.6, IE6, IE8, Opera 10 and Google Chrome 5 on Windows XP, as well as Firefox 3.5, Google Chrome 5 and konqueror 4.3.5 on (SuSE) Linux 11.2
		</div>
</div>
<div id="rightcol">
<div class="top" id="google"><form method="get" action="http://www.google.com/search">
<input type="text" name="q" size="20" maxlength="255" value=""><input type="submit" value="Search my site"> (Google)
	                        <input type="hidden" name="sitesearch" value="www.6502.org/users/andre">
</form></div>
<div class="top" id="twitter">
		            Follow my 8-bit tweets on
		            <a href="http://search.twitter.com/search?q=&amp;ands=&amp;phrase=&amp;ors=&amp;nots=&amp;tag=8bit&amp;lang=all&amp;from=afachat&amp;to=&amp;ref=&amp;near=&amp;within=15&amp;units=mi&amp;since=&amp;until=&amp;rpp=15"><img src="http://twitter-badges.s3.amazonaws.com/twitter-b.png" alt="twitter"></a>
</div>
<div class="top" id="forum">
<p>Discuss my site on <a href="http://forum.6502.org/viewtopic.php?t=956">this 6502.org forum thread</a></p>
<p>(Forum registration required to post)</p>
</div>
</div>
<div id="midcol">
<DIV class="top" ID="breadcrumbs">
<a href="../index.html">Homepage</a>
&gt;&gt; CBM PETindex
</DIV>
<DIV class="top" ID="content">
<h1>Commodore PET repair info</h1>
<p class="copyright">(C)
- André  Fachat</p> 
<div class="overview">
<p>
	This page contains an overview over hardware defects,
	how to detect them and how to fix them.
	</p>
<p>Note: this is a work in progress!</p>
  </div>
<h3>News:</h3>
<ul class="news">
<li>
<small>2010-04-12</small>
	Added the vertical lines screen problem with link to the solution.
    </li>
<li class="oldnews">
<small>2006-12-21</small>
	Started this page
    </li>
</ul>
<DIV ID="toc">
<H2>Table of content</H2>
<dir>
<li><a href="#generic">Generic Advice</a></li>
<dir><li><a href="#tools">Tools</a></li></dir>
<li><a href="#dead">PET's dead</a></li>
<li><a href="#funny">Funny characters on the screen</a></li>
<li><a href="#monitor">Monitor and other weird symptoms</a></li>
<li><a href="#links">Links</a></li>
</dir>
</DIV>
<h2><a name="generic">Generic Advice</a></h2>
<p>
	This section contains generic advice.
    </p>
<ul>
<li>
<strong><a name="tools">Tools</a></strong><br><br><p>
	In general you should have good tools if you endeavor to analyze
	and fix a hardware problem (not only(!)) with your PET ...
	</p>
<ul>
<li>
<strong>Generic Tools</strong>: 
	<div class="rightimg">
	<image src="imgs/osci.jpg"></image><br>
		<caption>My trusty old Oscilloscope I got in used condition
		in 1986 from a swap for then 160DM (about 80€) - all 
		tubes and still works :-)</caption>
	</div>
	My main tool is a 
	Voltmeter, and I regularly use an old oscilloscope. A logic
	probe is also very helpful if you don't have an oscilloscope. It
	should at least be able to detect hi, lo, open, and clocking.
	<p>Here a comment from William Levak: </p>
<p class="quote">
I used to repair PET's with an oscilloscope and voltmeter. The kind of
oscilloscope used on old analog TV's is perfect, because the video
circuits are similar. These oscilloscopes were available in kit form from
Heathkit, Knight, RCA, and a number of other sources. These oscilloscope
kits were sold in the millions, and can still be found on the used
electronics market. If you get a used one, the capacitors will probably
need to be replaced, as they were the old paper type capacitors. They
tend to go bad, especially if left sitting unused for years.
</p>	
	<p>Even without an oscilloscope or logic probe 
	you can use the Voltmeter to check
	lines like Phi2 or address lines. If the Voltmeter shows Phi2
	at constant 5V, it's dead. Same for 0V. Instead the Voltmeter should
	be somewhere around 2-3V, as it averages Phi2 high and low.
	</p>
      <br><br>
</li>
<li>
<strong>6502 and PET Specific Tools</strong>:  Here some
	more specific tools, that you can actually build yourself if needed:
	<p>
	I have a simple "CPU emulator": A small board to plug
	into the CPU socket, where I can set all address lines and the
	R/-W line with dip switches. I use this to check address line
	decoding.
	</p>
<p>
	A reset switch comes in handy as well.
	</p>
Quote from Olaf Seibert from the PETdoc document:
<p class="quote">
If you hold down the diagnostic
sense line (user port pin 5), you'll end up in the monitor instead
of doing the full reset thingie. A PET at our school's computer club
had a smart thing with a switch wired to reset, and diag through a
condensator. If you flicked it quicky it would reset; if you kept the
switch in the alternate position a few seconds it would decharge the
condensator, pull down diag, and when switched back you came back in
the monitor.</p>
Another comment from William:
<p class="quote">
Commodore made a diagnostic device for the PET. It consisted of a 40 pin
clip that attached to the CPU. This was connected by ribbon cable to a
small circuit board that contained a ROM and a reset switch. When
pressed, the address bus was forced to $9xxx, causing the computer to
initialize from the ROM on the diagnostic device. A diagnostic routine
was then loaded to low memory on the computer and the 40 pin clip removed.
</p>
<p class="quote">
This device is not very complicated. I have never traced out the circuit,
but it should not be difficult to do. I think the ROM images are in the
CBM archive. There are two of these devices, one for PET's with the CRTC,
and one for those without the CRTC. This device was not intended for the
original PET's (which have their own built in diagnostic routine), but
with a few changes to the system board, it will run on those too.
</p>
<p class="quote">
There are connectors with jumpers on them that need to be put on the
keyboard and user ports. These are simple enough to be made by almost
anyone.
</p>
<p>Note: the diagnostic devices and their use are described in the <a href="http://www.commodore.ca/manuals/Testing_The_PET/testing_the_pet_computer.htm">"Testing the PET Computer" manual</a>, unfortunately the manual assumes you already have them, so it lacks the details. 
I could find the diagnostic connectors on
<a href="http://www.zimmers.net/anonftp/pub/cbm/schematics/computers/pet/diagnostics.txt">the CBM archive</a>.
For the original PET, these are all
you need.  The original ROMs have a diagnostic routine in the ROM. You
install the connectors, and turn on the PET, and runs through a self
diagnostic.  When it finishes, the red LED on the system board lights up.
On later models the diagnostic routine has been replaced with the
machine language monitor.
</p>
<p>
So far I don't have the schematics for the CPU connector, nor the ROMs and test programs, sorry. So if you can provide this info, this would be very helpful!</p>
      <br><br>
</li>
</ul>
</li>
<br><li>
<strong>Be Careful</strong>: 
	If handled improperly the PET electronics can be damaged. So please
	minimize the risk of static electricity.
	<br>
	The monitor can be damaged by switching it on and off very often
	during testing. Consider using a separate monitor with the signal
      <br><br>
</li>
<li>
<strong>Prepare</strong>: 
	Prepare for your job. Read all about the symptoms you find on the
	net, so you don't start in the wrong place.
	<br>
	Print out the schematics. That helps.
      <br><br>
</li>
<li>
<strong>First Job</strong>: 
	When you get a PET to repair, first see if there is any apparent
	damage. This includes the inside. Check that all necessary ROMs are 
	present.
	<br>
	PETs are notoriously known for socketed chips moving out of their
	sockets. So one thing to do is to take the chips out and reseat
	them properly. Take care to put them back in in the correct place and
	orientation.
      <br><br>
</li>
</ul>
<h2><a name="dead">PET's dead</a></h2>
<p>
	This section describes situations where the PET seems to be "dead".
	<br>
	Apparently the new "CRTC" PET are more difficult than the older 
	ones, as the CRTC must be programmed to generate a valid video
	signal. Older PET would show at least garbage even if the CPU
	was dead.
    </p>
<ul>
<li>
<strong>Initial Check</strong>: 
	Before you check anything else, check that there is power on 
	the board e.g. by measuring 5V on the userport, then check
	Phi2. If both are ok, then check what the CPU interrupt lines 
	(IRQ, NMI, RES) do, and then the address lines. This should give
	you an idea if it is a very basic problem or maybe something with
	the ROMs for example.
      <br><br>
</li>
<li>
<strong>CRTC PET</strong>: 
	In the CRTC PET a "dead" PET may not be completely dead. The CPU
	must program the CRTC to actually generate a valid video signal.
	So if the CPU is running and the PET still does not work, check
	the ROM contents and the address decoding (either with the CPU
	emulator or by monitoring the ROM select lines, esp. after reset.
      <br><br>
</li>
<li>
<strong>8296(D)</strong>: 
	The 8296 and 8296-D (that use the same board, so I'll use 8296 only)
	are notoriously known for broken PLA chips. To check that measure
	the output pins of UE5 and UE6 with the scope. If they are constant
	around 1-3V, but not clean TTL signals (0V or 5V) they are broken.
	Build a replacement e.g. as described on 
	<a href="http://www.vic20.de/html/eprom_pla_8296_und_c64.html">this
	page</a> (in German, but should be easy to understand in english as well). 
	Or use the info on <a href="http://www.zimmers.net/anonftp/pub/cbm/firmware/computers/pet/8296/index.html">this page</a>, including a GAL replacement
	of the UE5 PLA.
      <br><br>
</li>
</ul>
<h2><a name="funny">Funny characters on the screen</a></h2>
<p>
	This section has descriptions of symptoms with "funny characters"
	on the screen and other video problems.
    </p>
<ul>
<li>
<strong>Non-CRTC-PET</strong>:  
	Here the screen displays the screen memory content even without 
	the CPU doing anything. Therefore a "working" screen with constant funny
	characters only says that the video circuitry seems to work.
	<br>
	It might be a video or general memory problem. This can for example
	be checked by swapping memory chips around. See also the first
	link below.
	<br>
	If that does not help, go to the "PET's dead" section.
      <br><br>
</li>
<li>
<strong>Flickering screen</strong>: 
	If the screen is flickering in the sense that characters are changing
	shape all the time, i.e. their pixel representation is not constant
	or does not correspond to any know CBM character, then there is
	a problem with the character generation. Try to reseat the 
	character ROM, check its content.
      <br><br>
</li>
<li>
<strong>Vertical lines on the screen</strong>: 
	<div class="rightimg">
	<a href="imgs/vertlines.png"><image src="imgs/vertlines_small.png"></image></a><br>
		<caption>Vertical lines from a broken character ROM</caption>
	</div>
	A more specific case is that of constant vertical lines all over the screen, 
	in the same position for each character row. An example can be seen 
	on <a class="extlink" href="http://www.fcet.staffs.ac.uk/atm2/pet/">this page</a>.
	The specific problem could have been the character ROM or the shift register
	receiving the data from the character ROM. In this case it was the character ROM.
	Note that the vertical lines only show where characters should be, not the borders
	and even not in between the characters. That would be a different error.
	Thanks to Alasdair Macdonald for reporting this and providing the picture!
      <br><br>
</li>
<li>
<strong>Video board</strong>: 
A comment by William Levak: <p class="quote">
When you get to the video board, there were 2 capacitors on the original
version of the video board for the original PET that went bad frequently.</p>
      <br><br>
</li>
</ul>
<h2><a name="monitor">Monitor and other weird symptoms</a></h2>
<p>
	This section has an assorted list of symptoms...
    </p>
<ul>
<li>
<strong>Monitor after reset</strong>:  
	When the PET comes up with the built-in monitor (TIM) instead of
	the BASIC prompt, check the value of the stack pointer. If it is
	very low (e.g. "01") then there is a stack overflow, probably 
	caused by too many interrupts. Check the "VDRIVE" signal on 
	the keyboard PIA or VIA IC. If it shows the vertical sync video
	signal, only that it is not between 0V and 5V, but between around 
	0V and 1V, then the VIA may be broken and pulling the signal low,
	so that the PIA has problems detecting the interrupt.
      <br><br>
</li>
<li>
<strong>No 'chirp' after reset</strong>:  
	The 12" models have a piezo beeper and since BASIC4 they "chirp"
	when reset. If such a model does not do this, check the 
	beeper signal. If it does not exist, there may be problems with the
	VIA. 
	<br>
	In my case I had the 8296 boot either with chirp into the 
	TIM monitor or without chirp into the BASIC prompt, and I found
	a broken VIA.
      <br><br>
</li>
<li>
<strong>SYNTAX ERROR on every command and screen scrolling problems</strong>: 
	I read of a case where on every command entered the system reacted
	with a "SYNTAX ERROR". Also when scrolling the screen, some
	characters change. This is a problem when the main CPU reads the	
	video screen. When a command is entered, it is read from screen,
	not from some buffer memory. Also when the screen is scrolled,
	the data is read from the screen and written back to it.
	So both problems came from the same source, the bus driver
	that separated the video RAM from the CPU bus. It had a broken
	driver in one of the lines. 
      <br><br>
</li>
</ul>
<h2><a name="links">Links</a></h2>
<p>
	This section has links to descriptions of how hardware
	issues with the PET have been resolved.
    </p>
<ul>
<li class="subitem">
<a href="http://www.commodore.ca/manuals/default.htm">Diagnostic Manuals</a> commodore.ca has a number of diagnostic manuals. 
      <br><br>
</li>
<li class="subitem">
<a href="http://www.commodore.ca/manuals/PET_RAM_test.htm">PET memory test program</a> commodore.ca has memory test program for an 8k PET, which could probably be adapted for larger memory sizes.
      <br><br>
</li>
<li>
<strong>PET restoration</strong>:  of an original PET 2001-8 by Dave Gostelow - 20100103 obviously gone, if you know its new home, let me know
      <br><br>
</li>
<li class="subitem">
<a href="http://www.portcommodore.com/dokuwiki/doku.php?id=larry:commodore:commodore_troubleshooting">Larry's portcommodore 8-bit troubleshooting list</a> 
      <br><br>
</li>
<li class="subitem">
<a href="http://www.cosam.org/computers/cbm/pet/index.html">Description of a PET repair</a> 
	<desc>Interesting description to solve several problems with a non-working PET</desc>
      <br><br>
</li>
</ul>
<h2>Disclaimer</h2>
<p>
All Copyrights are acknowledged.
The information here is provided under the terms of the
GNU Public License version 2 unless noted otherwise.
    </p>
<hr>
<p>Return to <a href="../index.html">Homepage</a></p>

  </DIV>
</div>
</body>
</html> 

