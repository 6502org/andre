<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" />
<meta name="author" content="Andr&#xE9;  Fachat" />

<meta name="description" content="Description of the Diagnostic Clip" />
<meta name="keywords" content="Commodore PET Diagnostic Clip" />
<link rev="made" href="mailto:afachat@gmx.de" />
<link rel="stylesheet" title="Default" type="text/css" href="../../style2-min.css" /><link href="../../shariff.complete.css" rel="stylesheet" />
<title>PET index - Diagnostic Clip</title></head>
<body><div id="mainbox"><a name="top" id="top"></a><div id="topsearch"><form method="get" action="http://www.google.com/search" target="_blank" autocomplete="off"><input id="searchinput" alt="search" name="q" size="10" maxlength="255" type="text" value="" /><input class="advbutton" value="Search site" type="submit" /><div id="srchprov">(by Google)</div><input name="sitesearch" value="www.6502.org/users/andre" type="hidden" /></form><div id="topfind"><div id="topprogress"></div></div></div><div id="menubox">


<div id="menu1" class="mclose">
<div id="twist1" class="twisty"></div>
<div class="hdrtxt"><a href="../../index.html">Home&nbsp;&gt;</a></div>
<ul class="nav1">
<li>
<ul class="nav2">
<li class="navhdr"><a href="../../index.html">Home</a></li>
<li><a href="../../contact.html">Contact</a></li>
<li><a href="../../design.html">Web design</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Hardware</span></li>
<li><ul class="nav2" >
<li><a href="../../65k/index.html">The 65k Project</a>
</li>
<li><a href="../../pet816/index.html">PET816 Accelerator</a>
</li>
<li><a href="../../csa/index.html">CS/A65</a>
</li>
<li><a href="../../cbmhw/index.html">CBM mods</a>
</li>
<li><a href="../../spi65b/index.html">SPI65B</a>
</li>
<li><a href="../../mischw/index.html">Other hardware</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Software</span></li>
<li><ul class="nav2" >
<li><a href="../../osa/index.html">GeckOS</a>
</li>
<li><a href="../../lib6502/index.html">lib6502 </a>
</li>
<li><a href="../../o65/index.html">o65</a>
</li>
<li><a href="../../usb65/index.html">usb65</a>
</li>
<li><a href="../../xd2031/index.html">XD2031</a>
</li>
<li><a href="../../misc/index.html">Misc</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Library</span></li>
<li><ul class="nav2" >
<li><a href="../../petindex/index.html">PETindex</a>
</li>
<li><a href="../../petindex/drives/index.html">PET drives</a>
</li>
<li><a href="../../adv65/index.html">Advanced 6502</a>
</li>
<li><a href="../../hwinfo/index.html">ICs and Standards</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Knowledge Bits</span></li>
<li><ul class="nav2" >
<li><a href="../../icapos/index.html">Computer/OS Architecture</a>
</li>
<li><a href="../../icaphw/index.html">6502 Hardware Bits</a>
</li>
<li><a href="../../emulation/index.html">Emulation</a>
</li>
</ul>
<div class="nend2"></div>
</li>
<div class="nend1"></div>
</ul>
</div>
<div id="menu2" class="%open%">
<div id="twist2" class="twisty"></div>
<div class="hdrtxt"><a href="../index.html">PETindex&nbsp;&gt;</a></div>
<ul class="nav1">
<li>
<ul class="nav2">
<li class="navhdr"><a href="../index.html">PETindex</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>General Info</span></li>
<li><ul class="nav2" >
<li><a href="../gallery/index.html">PET gallery</a>
</li>
<li><a href="../versions.html">PET versions</a></li>
<li><a href="../boards.html">Boards and schematics</a></li>
<li><a href="../pinouts.html">Connectors</a></li>
<li><a href="../keyboards.html">Keyboards</a></li>
<li><a href="../extensions.html">Hardware Extensions</a></li>
<li><a href="../lang.html">Programming Languages</a></li>
<li><a href="../open.html">Open questions</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Specials</span></li>
<li><ul class="nav2" >
<li><a href="../superpet.html">SuperPET MMF9000</a></li>
<li><a href="../8x96.html">The 8096 and 8296 models</a></li>
<li><a href="../8032sk.html">The 8032-SK</a></li>
<li><a href="../internat.html">Internationalization</a></li>
<div class="nend2"></div>
</ul>
</li>
<li><span>Peripherals</span></li>
<li><ul class="nav2" >
<li><a href="../drives/index.html">Disk drives</a>
</li>
<li><a href="../periph.html">Others</a></li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Programming</span></li>
<li><ul class="nav2" >
<li><a href="../progmod.html">Hardware programming</a></li>
<li><a href="../roms.html">ROM descriptions</a></li>
<li><a href="../crtc.html">CRTC operation</a></li>
<div class="nend2"></div>
</ul>
</li>
<li><span>Quirks</span></li>
<li><ul class="nav2" >
<li><a href="../poke/index.html">Killer poke</a>
</li>
<li><a href="../repairs.html">Repairing the PET</a></li>
<li><a href="../diag/index.html">Diagnostic Clip</a>
</li>
<div class="nend2"></div>
</ul>
</li>
<div class="nend1"></div>
</ul>
<ul class="nav1" >
<li><span>Links</span></li>
<li><ul class="nav2" >
<li><a href="../hw.html">Hardware projects</a></li>
<li><a href="../sw.html">Software projects</a></li>
<li><a href="../emus.html">PET emulators</a></li>
<li><a href="../transfer.html">File transfers</a></li>
<li><a href="../links.html">Links</a></li>
</ul>
<div class="nend2"></div>
</li>
<div class="nend1"></div>
</ul>
</div>
	</div><div id="midcol"><div class="top" id="content"><div id="minmax"></div>

<h1>PET index - Diagnostic Clip</h1><p class="copyright">(C)
2017-2017 André  Fachat</p> 
<div class="overview"><p>
	This page describes the PET diagnostic cartridge. </p><p>
	Many thanks esp. go to Manuel Amorim who helped work out the schematics of the board
	and Jett Raymond, who provided me with actually a second, different version
	of the board! Also many thanks go to Rob Clarke, who provided me with a
	disassembly of (one version of) the ROM.
   </p>
  </div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="news" id="news">News:</a></h2></div><div class="h2c"><ul class="news"><li><div> </div><small>2017-08-13</small>
	Added the 1st version ROM dump and a disassembly for it. 
    </li><li><div> </div><small>2017-07-16</small>
	Started this page
    </li></ul></div></div><div id="toc" class="h2"><div class="h2h"><div class="h2t"> </div><h2>Table of content</h2></div><div class="h2c"><ul><li><a href="#desc">Description</a></li><li><a href="#ma">Diagnostic Clip</a></li><li><a href="#clip1">Diagnostic Clip I</a></li><li><a href="#rc">Diagnostic Clip I</a></li><li><a href="#rom">ROM descriptions</a></li></ul></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="desc" id="desc">Description</a></h2></div><div class="h2c"> <p>
	The diagnostic clip is an add-on that contains a diagnostic ROM 
	to identify problems with the PET hardware. It consists of 
	userport and tape plugs with specific wiring, and a processor clip.
	This processor clip is clipped onto the 6502 before the PET is 
	powered on. It is connected to a small box that contains the ROMs
	with a 40pin flat ribbon cable. 
	</p><p>
	After powering on, the on-board ROM is disabled or evaded - depending
	on the version, for details see below.
	</p><p>
	A version of the manual is documented on commodore.ca.
	</p><p>
A comment from William Levak:
</p><p class="quote">
Commodore made a diagnostic device for the PET. It consisted of a 40 pin
clip that attached to the CPU. This was connected by ribbon cable to a
small circuit board that contained a ROM and a reset switch. When
pressed, the address bus was forced to $9xxx, causing the computer to
initialize from the ROM on the diagnostic device. A diagnostic routine
was then loaded to low memory on the computer and the 40 pin clip removed.
</p><p class="quote">
This device is not very complicated. I have never traced out the circuit,
but it should not be difficult to do. I think the ROM images are in the
CBM archive. There are two of these devices, one for PET's with the CRTC,
and one for those without the CRTC. This device was not intended for the
original PET's (which have their own built in diagnostic routine), but
with a few changes to the system board, it will run on those too.
</p><p class="quote">
There are connectors with jumpers on them that need to be put on the
keyboard and user ports. These are simple enough to be made by almost
anyone.
</p>
<p>Note: the diagnostic devices and their use are described in the <a href="http://www.commodore.ca/manuals/Testing_The_PET/testing_the_pet_computer.htm">"Testing the PET Computer" manual</a>, unfortunately the manual assumes you already have them, so it lacks the details.
I could find the diagnostic connectors on
<a href="http://www.zimmers.net/anonftp/pub/cbm/schematics/computers/pet/diagnostics.txt">the CBM archive</a>.
For the original PET, these are all
you need.  The original ROMs have a diagnostic routine in the ROM. You
install the connectors, and turn on the PET, and runs through a self
diagnostic.  When it finishes, the red LED on the system board lights up.
On later models the diagnostic routine has been replaced with the
machine language monitor.
</p><p>
	As it seems the two versions desribed below refer to the
	two versions mentioned by William. The one that uses the
	/NOROM pin to disable the ROMs on the main board are used for the
	CRTC versions of the machine, that actually used an unused pin
	at the CPU socket, to disable the ROMs
	</p><p>
	The other one, that forces the address bus to $9xxx, is used
	for the older PET, that did not have the /NOROM pin.

    </p><ul><li><a href="http://www.commodore.ca/manuals/Testing_The_PET/testing_the_pet_computer.htm" target="_blank" class="extlink">Diagnostic Clip manual</a> Scans of the manual</li><li><a href="http://www.zimmers.net/anonftp/pub/cbm/schematics/computers/pet/diagnostics.txt" target="_blank" class="extlink">Diagnostic Clip connectors diagrams</a> on the CBM archive</li></ul></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="ma" id="ma">Diagnostic Clip</a></h2></div><div class="h2c"> <p>
	Manuel Amorim sent me a number of pictures and also we were able to 
	work out the schematics of his diagnostic clip. This one seems to 
	indeed pull down the address bits A13 and A14 to force the address
	to a - hopefully unused - $9xxx area to avoid hardware conflicts.
	</p><p>Also see a link to Manuel's page below the images.
    </p><div class="gallery"><div class="galleryimg"><a href="IMG_20151209_141721.jpg"><img class="full" src="IMG_20151209_141721.jpg" alt="Outside view" /><img class="thumb" src="IMG_20151209_141721_small.jpg" alt="Outside view" /></a><div class="desc">Outside view</div></div><div class="galleryimg"><a href="IMG_20151209_204258.jpg"><img class="full" src="IMG_20151209_204258.jpg" alt="Inside view" /><img class="thumb" src="IMG_20151209_204258_small.jpg" alt="Inside view" /></a><div class="desc">Inside view</div></div><div class="galleryimg"><a href="IMG_20170716_204547.jpg"><img class="full" src="IMG_20170716_204547.jpg" alt="Manual page describing how it works" /><img class="thumb" src="IMG_20170716_204547_small.jpg" alt="Manual page describing how it works" /></a><div class="desc">Manual page describing how it works</div></div><div class="galleryimg"><a href="IMG_20170717_224244.jpg"><img class="full" src="IMG_20170717_224244.jpg" alt="View of the userport connector (twice)" /><img class="thumb" src="IMG_20170717_224244_small.jpg" alt="View of the userport connector (twice)" /></a><div class="desc">View of the userport connector (twice)</div></div><div class="galleryimg"><a href="SCHEM_AF.png"><img class="full" src="SCHEM_AF.png" alt="Reverse engineered schematics" /><img class="thumb" src="SCHEM_AF_small.png" alt="Reverse engineered schematics" /></a><div class="desc">Reverse engineered schematics (here is the <a target="_blank" href="SCHEM_AF.sch">Eagle source</a>)</div></div><div class="gallend"></div></div><ul><li><a href="http://thegarage.space/commodore-pet/" target="_blank" class="extlink">Diagnostic Clip page of Manuel Amorim</a> </li></ul></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="clip1" id="clip1">Diagnostic Clip I</a></h2></div><div class="h2c"> <p>
	I got a schematics from Jett Raymond that uses /NOROM pin on the 
	PET CPU socket, to actually disable the on-board ROM selection. This is a special
	feature of the PET, where an unused 6502 pin is re-used for that purpose.
	</p><p>
	Because this disables the original PET ROMs, there is no need to force the
	address to an unused area - the ROM code can actually run at $Fxxx.
    </p><div class="gallery"><div class="galleryimg"><a href="IMG_0920.JPG"><img class="full" src="IMG_0920.JPG" alt="Outside view" /><img class="thumb" src="IMG_0920_small.jpg" alt="Outside view" /></a><div class="desc">Outside view</div></div><div class="galleryimg"><a href="IMG_0921.JPG"><img class="full" src="IMG_0921.JPG" alt="Correction table" /><img class="thumb" src="IMG_0921_small.jpg" alt="Correction table" /></a><div class="desc">Correction table</div></div><div class="galleryimg"><a href="IMG_0922.JPG"><img class="full" src="IMG_0922.JPG" alt="Inside view" /><img class="thumb" src="IMG_0922_small.jpg" alt="Inside view" /></a><div class="desc">Inside view</div></div><div class="galleryimg"><a href="IMG_0923.JPG"><img class="full" src="IMG_0923.JPG" alt="Inside view with cable" /><img class="thumb" src="IMG_0923_small.jpg" alt="Inside view with cable" /></a><div class="desc">Inside view with cable</div></div><div class="galleryimg"><a href="IMG_0924.JPG"><img class="full" src="IMG_0924.JPG" alt="Inside view" /><img class="thumb" src="IMG_0924_small.jpg" alt="Inside view" /></a><div class="desc">Inside view</div></div><div class="galleryimg"><a href="IMG_0925.JPG"><img class="full" src="IMG_0925.JPG" alt="Back view" /><img class="thumb" src="IMG_0925_small.jpg" alt="Back view" /></a><div class="desc">Back view</div></div><div class="galleryimg"><a href="IMG_0926.JPG"><img class="full" src="IMG_0926.JPG" alt="Top view without ROMs" /><img class="thumb" src="IMG_0926_small.jpg" alt="Top view without ROMs" /></a><div class="desc">Top view without ROMs</div></div><div class="galleryimg"><a href="Diagnostic Clip I schematics.png"><img class="full" src="Diagnostic Clip I schematics.png" alt="Schematics" /><img class="thumb" src="Diagnostic Clip I schematics.png" alt="Schematics" /></a><div class="desc">Schematics</div></div><div class="gallend"></div></div></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="rc" id="rc">Diagnostic Clip I</a></h2></div><div class="h2c"> <p>
	Rob Clarke also sent me some pictures, and especially ROM images and 
	a disassembly (for those see below)!
    </p><div class="gallery"><div class="galleryimg"><a href="Diagnostic_Clip_external.jpg"><img class="full" src="Diagnostic_Clip_external.jpg" alt="Outside view" /><img class="thumb" src="Diagnostic_Clip_external_small.jpg" alt="Outside view" /></a><div class="desc">Outside view</div></div><div class="galleryimg"><a href="Diagnostic_Clip_internal.jpg"><img class="full" src="Diagnostic_Clip_internal.jpg" alt="Inside view" /><img class="thumb" src="Diagnostic_Clip_internal_small.jpg" alt="Inside view" /></a><div class="desc">Inside view</div></div><div class="galleryimg"><a href="ScreenShot.jpg"><img class="full" src="ScreenShot.jpg" alt="Screenshot of a successful test run" /><img class="thumb" src="ScreenShot_small.jpg" alt="Screenshot of a successful test run" /></a><div class="desc">Screenshot of a successful test run</div></div><div class="gallend"></div></div></div></div><div class="h2"><div class="h2h"><div class="h2t"> </div><h2><a name="rom" id="rom">ROM descriptions</a></h2></div><div class="h2c"> <p>
	As there are two versions of the diag clip, with different 
	features concerning the ROM addressing, there are (at least)
	two types of ROMs obviously. </p><p>
	However, it seems there is only the one available for the 
	$fxxx version. But even so, there are multiple versions, see
	the links below.
    </p><ul><li><a href="901447-30.BIN" target="_blank" class="extlink">2k ROM Dump by Manuel Amorim for the 1st version using the 9800 address range</a> </li><li><a href="901447-30.dis" target="_blank" class="extlink">Uncommented disassembly of the 1st version ROM dump</a> </li><li><a href="ROM_Images.zip" target="_blank" class="extlink">$fxxx ROM images from Raymond Jett</a> </li><li><a href="40_80_80_col_diag.bin" target="_blank" class="extlink">ROM image by Rob Clarke</a> </li><li><a href="Diag_Clip_Disassembly.txt" target="_blank" class="extlink">ROM disassembly by Rob Clarke</a> </li></ul></div></div><hr />
<p>Return to <a href="../../index.html">Homepage</a></p>

  Last modified: 
2017-08-13
	</div></div><div id="rightcol"><div class="top" id="share"><div class="tophead">share</div><div><div class="shariff" data-backend-url="/users/andre/shariff/index.php" data-theme="grey" data-orientation="vertical"></div></div></div><div class="top" id="twitter"><div class="tophead">follow</div><div><p>Follow my 8-bit tweets on
		            <a class="extlink" target="_blank" href="https://twitter.com/#!/search/realtime/afachat%20%238bit">Twitter</a> (In new window)</p></div></div><div class="top" id="forum"><div class="tophead">discuss</div><div><p>Discuss my site on <a class="extlink" target="_blank" href="http://forum.6502.org/viewtopic.php?t=956">this 6502.org forum thread</a></p><p>(Forum registration required to post)</p></div></div><div class="top" id="hot"><div class="tophead">hot!</div><div>
<p>Dive into the retro feeling and build yourself a <a href="../../cbmhw/ryofat40/index.html">Commodore PET replica</a></p>
<p>Need more speed? Speed up your 6502 computer with this <a href="../../pet816/index.html">10&nbsp;MHz 6502 CPU accelerator board</a></p>
<p>Interested in electronics design? Look at the <a href="../../icaphw/design.html">design lesson</a> I got from Bil Herd, the hardware designer of the C128</p>
<p>Want 64bit? - pimp the 6502 with the <a href="../../65k/index.html">65k processor design!</a></p>

		</div></div></div><div id="footer"> </div></div><script type="text/javascript">myUp="../../";</script><script type="text/javascript" src="../../scripts2-all.js"></script><script type="text/javascript" src="../../shariff.min.js"></script></body></html> 

